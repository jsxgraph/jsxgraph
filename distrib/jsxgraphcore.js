/*
    Copyright 2008,2009
        Matthias Ehmann,
        Michael Gerhaeuser,
        Carsten Miller,
        Bianca Valentin,
        Alfred Wassermann,
        Peter Wilfahrt

    This file is part of JSXGraph.

    JSXGraph is free software: you can redistribute it and/or modify
    it under the terms of the GNU Lesser General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    JSXGraph is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Lesser General Public License for more details.

    You should have received a copy of the GNU Lesser General Public License
    along with JSXGraph.  If not, see <http://www.gnu.org/licenses/>.
*/
    var JXG={};(function(){var a,b;JXG.countDrawings=0;JXG.countTime=0;JXG.require=function(d){};JXG.rendererFiles=[];JXG.rendererFiles.svg="SVGRenderer";JXG.rendererFiles.vml="VMLRenderer";JXG.baseFiles=null;JXG.requirePath="";for(a=0;a<document.getElementsByTagName("script").length;a++){b=document.getElementsByTagName("script")[a];if(b.src&&b.src.match(/loadjsxgraphInOneFile\.js(\?.*)?$/)){JXG.requirePath=b.src.replace(/loadjsxgraphInOneFile\.js(\?.*)?$/,"")}}JXG.serverBase=JXG.requirePath+"server/"})();JXG.Math=new Object();JXG.Math.eps=0.000001;JXG.Math.Vector=function(b){var a;this.length=0;if((typeof b!=undefined)&&(b!=null)){for(a=0;a<b.length;a++){this.push(b[a])}}};JXG.Math.Vector.prototype=new Array();JXG.Math.Vector.prototype.n=function(){return this.length};JXG.Math.Vector.prototype.exchange=function(d,b){var a=this[d];this[d]=this[b];this[b]=a};JXG.Math.Matrix=function(k){var g=0,h=false,e,d,a,b;this.length=0;if((typeof k!=undefined)&&(k!=null)){a=k.length;for(e=0;e<a;e++){b=k[e].length;this.push(new Array());if(h){if(g!=b){this.length=0;throw new JXG.DimensionMismatchException("Your array contains arrays with different lengths.")}}for(d=0;d<b;d++){this[e].push(k[e][d])}g=b;h=true}}};JXG.Math.Matrix.prototype=new Array();JXG.Math.Matrix.prototype.m=function(){return this.length};JXG.Math.Matrix.prototype.n=function(){if(this.length>0){return this[0].length}else{return 0}};JXG.Math.Matrix.prototype.exchangeRows=function(d,b){var a=this[d];this[d]=this[b];this[b]=a};JXG.DimensionMismatchException=function(a){if((typeof a!=undefined)&&(a!=null)){this.message=a}else{this.message=null}};JXG.DimensionMismatchException.prototype.what=function(){var a="Matrix has incorrect dimensions";if(this.message!=null){return a+": "+this.message+"."}else{return a+"."}};JXG.SingularMatrixException=function(a){if((typeof a!=undefined)&&(a!=null)){this.message=a}else{this.message=null}};JXG.SingularMatrixException.prototype.what=function(){var a="Matrix is singular";if(this.message!=null){return a+": "+this.message+"."}else{return a+"."}};JXG.Math.matVecMult=function(l,g){var a=l.length,q=g.length,e=[],d,h,b;for(d=0;d<a;d++){h=0;for(b=0;b<q;b++){h+=l[d][b]*g[b]}e[d]=h}return e};JXG.Math.matMatMult=function(b,a){var e=b.length,d=a[0].length,u=a.length,q=[],l,h,w,g;for(l=0;l<e;l++){q[l]=[]}for(l=0;l<e;l++){for(h=0;h<d;h++){w=0;for(g=0;g<u;g++){w+=b[l][g]*a[g][h]}q[l][h]=w}}return q};JXG.Math.Matrix.transpose=function(h){var d=[],e,b,a,g;a=h.length;g=(h.length>0)?h[0].length:0;for(e=0;e<g;e++){d.push([]);for(b=0;b<a;b++){d[e].push(h[b][e])}}return d};JXG.memoizer=function(b){var a,d;if(b.memo){return b.memo}a={};d=Array.prototype.join;return(b.memo=function(){var e=d.call(arguments);return(typeof a[e]!="undefined")?a[e]:a[e]=b.apply(this,arguments)})};JXG.Math.factorial=JXG.memoizer(function(a){if(a<0){return NaN}if(a==0||a==1){return 1}return a*arguments.callee(a-1)});JXG.Math.binomial=JXG.memoizer(function(g,d){var a,e;if(d>g||d<0){return 0}if(d==0||d==g){return 1}a=1;for(e=0;e<d;e++){a*=(g-e);a/=(e+1)}return a});JXG.Math.round=function(a,e){var d,b;d=a-Math.ceil(a);b=d.toString();if(d<0){b=b.substr(0,e+3)}else{b=b.substr(0,e+2)}d=parseFloat(b);t=parseInt(a.toString());return t+d};JXG.Math.Numerics={};JXG.Math.Numerics.INT_TRAPEZ=1;JXG.Math.Numerics.INT_SIMPSON=2;JXG.Math.Numerics.INT_MILNE=3;JXG.Math.Numerics.number_of_nodes=28;JXG.Math.Numerics.integration_type=JXG.INT_MILNE;JXG.Math.Numerics.backwardSolve=function(k,e){var d=e,a,l,h,g;if(k.m){a=k.m();l=k.n()}else{a=k.length;l=(k.length>0)?k[0].length:0}for(h=a-1;h>=0;h--){for(g=l-1;g>h;g--){d[h]-=k[h][g]*d[g]}d[h]/=k[h][h]}return d};JXG.Math.Numerics.Gauss=function(a,q){var u=JXG.Math.eps,d,h,g,e,l,s,m;if(a.n){d=a.n()}else{d=(a.length>0)?a[0].length:0}l=new JXG.Math.Vector();for(h=0;h<d;h++){l.push(h)}for(g=0;g<d;g++){for(h=d-1;h>g;h--){if(Math.abs(a[h][g])>JXG.Math.eps){if(Math.abs(a[g][g])<JXG.Math.eps){a.exchangeRows(h,g);q.exchange(h,g);l.exchange(h,g)}else{a[h][g]/=a[g][g];q[h]-=a[h][g]*q[g];for(e=g+1;e<d;e++){a[h][e]-=a[h][g]*a[g][e]}}}if(Math.abs(a[g][g])<JXG.Math.eps){throw new SingularMatrixException()}}}return JXG.Math.Numerics.backwardSolve(a,q)};JXG.Math.Numerics.QR=function(d,a){};JXG.Math.Numerics.NewtonCotes=function(e,h){var b=0,a=(e[1]-e[0])/this.number_of_nodes,k,g,d;switch(this.integration_type){case JXG.INT_TRAPEZ:b=(h(e[0])+h(e[1]))*0.5;k=e[0];for(g=0;g<this.number_of_nodes-1;g++){k+=a;b+=h(k)}b*=a;break;case JXG.INT_SIMPSON:if(this.number_of_nodes%2>0){throw new Error("JSXGraph:  INT_SIMPSON requires JXG.Math.Numerics.number_of_nodes dividable by 2.")}d=this.number_of_nodes/2;b=h(e[0])+h(e[1]);k=e[0];for(g=0;g<d-1;g++){k+=2*a;b+=2*h(k)}k=e[0]-a;for(g=0;g<d;g++){k+=2*a;b+=4*h(k)}b*=a/3;break;default:if(this.number_of_nodes%4>0){throw new Error("JSXGraph: Error in INT_MILNE: JXG.Math.Numerics.number_of_nodes must be a multiple of 4")}d=this.number_of_nodes*0.25;b=7*(h(e[0])+h(e[1]));k=e[0];for(g=0;g<d-1;g++){k+=4*a;b+=14*h(k)}k=e[0]-3*a;for(g=0;g<d;g++){k+=4*a;b+=32*(h(k)+h(k+2*a))}k=e[0]-2*a;for(g=0;g<d;g++){k+=4*a;b+=12*h(k)}b*=2*a/45}return b};JXG.Math.Numerics.splineDef=function(q,m){var a=q.length,d,g,h,k,b,e=new Array(),w=[],s=[],u;if(q.length!=m.length){throw new Error("JSXGraph: Error in JXG.Math.Numerics.splineDef: Input vector dimensions do not match.")}for(g=0;g<a;g++){d={X:q[g],Y:m[g]};e.push(d)}e.sort(function(z,l){return z.X-l.X});for(g=0;g<a;g++){q[g]=e[g].X;m[g]=e[g].Y}for(g=0;g<a-1;g++){w.push(q[g+1]-q[g])}for(g=0;g<a-2;g++){s.push(6*(m[g+2]-m[g+1])/(w[g+1])-6*(m[g+1]-m[g])/(w[g]))}h=new Array();k=new Array();h.push(2*(w[0]+w[1]));k.push(s[0]);for(g=0;g<a-3;g++){b=w[g+1]/h[g];h.push(2*(w[g+1]+w[g+2])-b*w[g+1]);k.push(s[g+1]-b*k[g])}u=new Array();u[a-3]=k[a-3]/h[a-3];for(g=a-4;g>=0;g--){u[g]=(k[g]-(w[g+1]*u[g+1]))/h[g]}for(g=a-3;g>=0;g--){u[g+1]=u[g]}u[0]=0;u[a-1]=0;return u};JXG.Math.Numerics.splineEval=function(g,C,A,E){var h=C.length,m=1,k=false,D,s,q,B,z,w,u,e;if(h!=A.length){throw new Error("JSXGraph: Error in JXG.Math.Numerics.splineEval: Defining vector dimensions do not match.")}if(JXG.isArray(g)){m=g.length;k=true}else{g=[g]}D=new Array();for(s=0;s<m;s++){if((g[s]<C[0])||(C[s]>C[h-1])){return"NaN"}q;for(q=1;q<h;q++){if(g[s]<=C[q]){break}}q--;B=A[q];z=(A[q+1]-A[q])/(C[q+1]-C[q])-(C[q+1]-C[q])/6*(E[q+1]+2*E[q]);w=E[q]/2;u=(E[q+1]-E[q])/(6*(C[q+1]-C[q]));e=g[s]-C[q];D.push(B+(z+(w+u*e)*e)*e)}if(k){return D}else{return D[0]}};JXG.Math.Numerics.generatePolynomialTerm=function(a,h,b,d){var g="",e;for(e=h;e>=0;e--){g+="("+a[e].toPrecision(d)+")";if(e>1){g+="*"+b+"<sup>"+e+"</sup> + "}else{if(e==1){g+="*"+b+" + "}}}return g};JXG.Math.Numerics.lagrangePolynomial=function(e){var a=[];var d="";var b=function(z,g){var l,h,u,w,A,m=0,q=0;u=e.length;if(!g){for(l=0;l<u;l++){a[l]=1;w=e[l].X();for(h=0;h<u;h++){if(h!=l){a[l]*=(w-e[h].X())}}a[l]=1/a[l]}M=[];for(j=0;j<u;j++){M.push([1])}}for(l=0;l<u;l++){w=e[l].X();if(z==w){return e[l].Y()}else{A=a[l]/(z-w);q+=A;m+=A*e[l].Y()}}return m/q};b.getTerm=function(){return d};return b};JXG.Math.Numerics.neville=function(e){var a=[];var d=function(z,g){var k,u,w,A,B=JXG.Math.binomial,q=e.length,h=q-1,l=0,m=0;if(!g){A=1;for(k=0;k<q;k++){a[k]=B(h,k)*A;A*=(-1)}}u=z;for(k=0;k<q;k++){if(u==0){return e[k].X()}else{A=a[k]/u;u--;l+=e[k].X()*A;m+=A}}return l/m};var b=function(z,g){var k,u,w,A,B=JXG.Math.binomial,q=e.length,h=q-1,l=0,m=0;if(!g){A=1;for(k=0;k<q;k++){a[k]=B(h,k)*A;A*=(-1)}}u=z;for(k=0;k<q;k++){if(u==0){return e[k].Y()}else{A=a[k]/u;u--;l+=e[k].Y()*A;m+=A}}return l/m};return[d,b,0,function(){return e.length-1}]};JXG.Math.Numerics.regressionPolynomial=function(g,q,m){var a=[],h=0,b,l,k,d,e="";if(JXG.isPoint(g)&&typeof g.Value=="function"){b=function(){return g.Value()}}else{if(JXG.isFunction(g)){b=g}else{if(JXG.isNumber(g)){b=function(){return g}}else{throw new Error("JSXGraph: Can't create regressionPolynomial from degree of type'"+(typeof g)+"'.")}}}if(arguments.length==3&&JXG.isArray(q)&&JXG.isArray(m)){d=0}else{if(arguments.length==2&&JXG.isArray(q)&&JXG.isPoint(q[0])){d=1}else{throw new Error("JSXGraph: Can't create regressionPolynomial. Wrong parameters.")}}var s=function(I,u){var A,z,F,D,H,w,G,J,E,C=q.length;E=Math.floor(b());if(!u){if(d==1){l=[];k=[];for(A=0;A<C;A++){l[A]=q[A].X();k[A]=q[A].Y()}}if(d==0){l=[];k=[];for(A=0;A<C;A++){if(JXG.isFunction(q[A])){l.push(q[A]())}else{l.push(q[A])}if(JXG.isFunction(m[A])){k.push(m[A]())}else{k.push(m[A])}}}F=[];for(z=0;z<C;z++){F.push([1])}for(A=1;A<=E;A++){for(z=0;z<C;z++){F[z][A]=F[z][A-1]*l[z]}}H=k;D=JXG.Math.Matrix.transpose(F);w=JXG.Math.matMatMult(D,F);G=JXG.Math.matVecMult(D,H);a=JXG.Math.Numerics.Gauss(w,G);e=JXG.Math.Numerics.generatePolynomialTerm(a,E,"x",3)}J=a[E];for(A=E-1;A>=0;A--){J=(J*I+a[A])}return J};s.getTerm=function(){return e};return s};JXG.Math.Numerics.bezier=function(b){var a=0;return[function(e,d){var k=Math.floor(e)*3,h=e%1,g=1-h;if(!d){a=Math.floor(b.length/3)}if(e<0){return b[0].X()}if(e>=a){return b[b.length-1].X()}if(isNaN(e)){return NaN}return g*g*(g*b[k].X()+3*h*b[k+1].X())+(3*g*b[k+2].X()+h*b[k+3].X())*h*h},function(e,d){var k=Math.floor(e)*3,h=e%1,g=1-h;if(!d){a=Math.floor(b.length/3)}if(e<0){return b[0].Y()}if(e>=a){return b[b.length-1].Y()}if(isNaN(e)){return NaN}return g*g*(g*b[k].Y()+3*h*b[k+1].Y())+(3*g*b[k+2].Y()+h*b[k+3].Y())*h*h},0,function(){return Math.floor(b.length/3)}]};JXG.Math.Numerics.D=function(d,e){var b=0.00001,a=1/(b*2);if(arguments.length==1||(arguments.length>1&&typeof arguments[1]=="undefined")){return function(g,h){return(d(g+b,h)-d(g-b,h))*a}}else{return function(g,h){return(d.apply(e,[g+b,h])-d.apply(e,[g-b,h]))*a}}};JXG.Math.Numerics.I=function(a,b){return JXG.Math.Numerics.NewtonCotes(a,b)};JXG.Math.Numerics.newton=function(g,a,k){var b=0,d=0.000001,e=g.apply(k,[a]),l;while(b<50&&Math.abs(e)>d){l=this.D(g,k)(a);if(Math.abs(l)>d){a-=e/l}else{a+=(Math.random()*0.2-1)}e=g.apply(k,[a]);b++}return a};JXG.Math.Numerics.root=function(b,a,d){return this.newton(b,a,d)};JXG.Math.Numerics.cosh=function(a){return(Math.exp(a)+Math.exp(-a))*0.5};JXG.Math.Numerics.sinh=function(a){return(Math.exp(a)-Math.exp(-a))*0.5};JXG.Math.Numerics.riemann=function(m,g,q,d,h){var e,A,l,z,k,w,s,b,a,u;e=[];A=[];k=0;w=d;g=Math.floor(g);e[k]=w;A[k]=0;if(g>0){z=(h-d)/g;a=z*0.01;for(l=0;l<g;l++){if(q=="right"){s=m(w+z)}else{if(q=="middle"){s=m(w+z*0.5)}else{if((q=="left")||(q=="trapezodial")){s=m(w)}else{if(q=="lower"){s=m(w);for(b=w+a;b<=w+z;b+=a){u=m(b);if(u<s){s=u}}}else{s=m(w);for(b=w+a;b<=w+z;b+=a){u=m(b);if(u>s){s=u}}}}}}k++;e[k]=w;A[k]=s;k++;w+=z;if(q=="trapezodial"){s=m(w)}e[k]=w;A[k]=s;k++;e[k]=w;A[k]=0}}return[e,A]};JXG.Math.Numerics.riemannsum=function(k,e,m,d,g){var l,h,w,u,q,b,a,s;l=0;u=d;e=Math.floor(e);if(e>0){w=(g-d)/e;a=w*0.01;for(h=0;h<e;h++){if(m=="right"){q=k(u+w)}else{if(m=="middle"){q=k(u+w*0.5)}else{if(m=="trapezodial"){q=0.5*(k(u+w)+k(u))}else{if(m=="left"){q=k(u)}else{if(m=="lower"){q=k(u);for(b=u+a;b<=u+w;b+=a){s=k(b);if(s<q){q=s}}}else{q=k(u);for(b=u+a;b<=u+w;b+=a){s=k(b);if(s>q){q=s}}}}}}}l+=w*q;u+=w}}return l};JXG.Math.Numerics.Butcher=function(){this.s=0;this.A=[];this.b=[];this.c=[]};JXG.Math.Numerics.predefinedButcher={};JXG.Math.Numerics.predefinedButcher.RK4={s:4,A:[[0,0,0,0],[0.5,0,0,0],[0,0.5,0,0],[0,0,1,0]],b:[1/6,1/3,1/3,1/6],c:[0,0.5,0.5,1]};JXG.Math.Numerics.predefinedButcher.Heun={s:2,A:[[0,0],[1,0]],b:[0.5,0.5],c:[0,1]};JXG.Math.Numerics.predefinedButcher.Euler={s:1,A:[[0]],b:[1],c:[0]};JXG.Math.Numerics.rungeKutta=function(d,K,q,g,J){var u=[],m=[],H=(q[1]-q[0])/g,z=q[0],L,G,F,D,C,E=K.length,A=d.s,b=1000,a=g/b,w=[],B=0;for(L=0;L<E;L++){u[L]=K[L]}for(G=0;G<g;G++){w[B]=[];for(L=0;L<E;L++){w[B][L]=u[L]}B++;D=[];for(F=0;F<A;F++){for(L=0;L<E;L++){m[L]=0}for(C=0;C<F;C++){for(L=0;L<E;L++){m[L]+=(d.A[F][C])*H*D[C][L]}}for(L=0;L<E;L++){m[L]+=u[L]}D.push(J(z+d.c[F]*H,m))}for(L=0;L<E;L++){m[L]=0}for(C=0;C<A;C++){for(L=0;L<E;L++){m[L]+=d.b[C]*D[C][L]}}for(L=0;L<E;L++){u[L]=u[L]+H*m[L]}z+=H}return w};JXG.MathStatistics=function(){};JXG.MathStatistics.prototype.sum=function(b){var e,a,d=0;for(e=0,a=b.length;e<a;e++){d+=b[e]}return d};JXG.MathStatistics.prototype.prod=function(b){var e,a,d=1;for(e=0,a=b.length;e<a;e++){d*=b[e]}return d};JXG.MathStatistics.prototype.mean=function(a){if(a.length>0){return this.sum(a)/a.length}else{return 0}};JXG.MathStatistics.prototype.median=function(b){var d,a;if(b.length>0){d=b.clone();d.sort(function(g,e){return g-e});a=d.length;if(a%2==1){return d[parseInt(a*0.5)]}else{return(d[a*0.5-1]+d[a*0.5])*0.5}}else{return 0}};JXG.MathStatistics.prototype.variance=function(d){var b,g,e,a;if(d.length>1){b=this.mean(d);g=0;for(e=0,a=d.length;e<a;e++){g+=(d[e]-b)*(d[e]-b)}return g/(d.length-1)}else{return 0}};JXG.MathStatistics.prototype.sd=function(a){return Math.sqrt(this.variance(a))};JXG.MathStatistics.prototype.weightedMean=function(a,b){if(a.length!=b.length){return}if(a.length>0){return this.mean(this.multiply(a,b))}else{return 0}};JXG.MathStatistics.prototype.max=function(b){var e,d,a;if(b.length==0){return NaN}e=b[0];for(d=1,a=b.length;d<a;d++){e=(b[d]>e)?(b[d]):e}return e};JXG.MathStatistics.prototype.min=function(b){var e,d,a;if(b.length==0){return NaN}e=b[0];for(d=1,a=b.length;d<a;d++){e=(b[d]<e)?(b[d]):e}return e};JXG.MathStatistics.prototype.range=function(a){return[this.min(a),this.max(a)]};JXG.MathStatistics.prototype.diff=function(a){return a};JXG.MathStatistics.prototype.min=function(b){var e,d,a;if(b.length==0){return NaN}e=b[0];for(d=1,a=b.length;d<a;d++){e=(b[d]<e)?(b[d]):e}return e};JXG.MathStatistics.prototype.abs=function(b){var e,a,d=[];if(typeof JXG.isArray(arr1)){for(e=0,a=b.length;e<a;e++){d[e]=Math.abs(b[e])}}else{if(typeof b=="number"){return Math.abs(b)}else{d=null}}return d};JXG.MathStatistics.prototype.add=function(d,b){var g,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]+b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d+b[g]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]+b[g]}}else{if(typeof d=="number"&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d+b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.divide=function(d,b){var g,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]/b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d/b[g]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]/b[g]}}else{if(typeof d=="number"&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d/b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.mod=function(d,b){var g,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]%b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d%b[g]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]%b[g]}}else{if(typeof d=="number"&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d%b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.multiply=function(d,b){var g,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]*b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d*b[g]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]*b[g]}}else{if(typeof d=="number"&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d*b}}else{e=null}}}}return e};JXG.MathStatistics.prototype.subtract=function(d,b){var g,a,e=[];if(typeof JXG.isArray(d)&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]-b}}else{if(typeof d=="number"&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d-b[g]}}else{if(typeof JXG.isArray(d)&&typeof JXG.isArray(b)){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d[g]-b[g]}}else{if(typeof d=="number"&&typeof b=="number"){for(g=0,a=Math.min(d.length,b.length);g<a;g++){e[g]=d-b}}else{e=null}}}}return e};JXG.Math.Symbolic={};JXG.Math.Symbolic.generateSymbolicCoordinatesPartial=function(q,g,e,b){function a(k){if(b=="underscore"){return""+e+"_{"+k+"}"}else{if(b=="brace"){return""+e+"["+k+"]"}else{return""+e+""+k}}}var l=g.ancestors;var h=0;var m;for(var s in l){m=0;if(JXG.isPoint(l[s])){for(var d in l[s].ancestors){m++}if(m==0){l[s].symbolic.x=l[s].coords.usrCoords[1];l[s].symbolic.y=l[s].coords.usrCoords[2]}else{h++;l[s].symbolic.x=a(h);h++;l[s].symbolic.y=a(h)}}}if(JXG.isPoint(g)){g.symbolic.x="x";g.symbolic.y="y"}return h};JXG.Math.Symbolic.clearSymbolicCoordinates=function(b){for(var a in b.objects){if(JXG.isPoint(b.objects[a])){b.objects[a].symbolic.x="";b.objects[a].symbolic.y=""}}};JXG.Math.Symbolic.generatePolynomials=function(l,d,e){if(e){this.generateSymbolicCoordinatesPartial(l,d,"u","brace")}var h=d.ancestors,m,g=[],s=[],q,a,b;h[d.id]=d;for(q in h){m=0;g=[];if(JXG.isPoint(h[q])){for(a in h[q].ancestors){m++}if(m>0){g=h[q].generatePolynomial();for(b=0;b<g.length;b++){s.push(g[b])}}}}if(e){this.clearSymbolicCoordinates(l)}return s};JXG.Math.Symbolic.geometricLocusByGroebnerBase=function(g,k,m){var h=this.generateSymbolicCoordinatesPartial(g,k,"u","brace"),a=this.generatePolynomials(g,k);var d=a.join(","),b=new JXG.Coords(JXG.COORDS_BY_USR,[0,0],g),e=new JXG.Coords(JXG.COORDS_BY_USR,[g.canvasWidth,g.canvasHeight],g),l;if(typeof JXG.Server.modules.geoloci=="undefined"){JXG.Server.loadModule("geoloci")}if(typeof JXG.Server.modules.geoloci=="undefined"){throw new Error("JSXGraph: Unable to load JXG.Server module 'geoloci.py'.")}this.cbp=function(q){m(q.datax,q.datay,q.polynomial)};this.cb=JXG.bind(this.cbp,this);JXG.Server.modules.geoloci.lociCoCoA(b.usrCoords[1],e.usrCoords[1],e.usrCoords[2],b.usrCoords[2],h,d,this.cb);this.clearSymbolicCoordinates(g)};JXG.Complex=function(a,b){this.isComplex=true;if(typeof a=="undefined"){a=0}if(typeof b=="undefined"){b=0}if(a.isComplex){b=a.imaginary;a=a.real}this.real=a;this.imaginary=b;this.absval=0;this.angle=0};JXG.Complex.prototype.toString=function(){return""+this.real+" + "+this.imaginary+"i"};JXG.Complex.prototype.add=function(a){if(typeof a=="number"){this.real+=a}else{this.real+=a.real;this.imaginary+=a.imaginary}};JXG.Complex.prototype.sub=function(a){if(typeof a=="number"){this.real-=a}else{this.real-=a.real;this.imaginary-=a.imaginary}};JXG.Complex.prototype.mult=function(a){if(typeof a=="number"){this.real*=a;this.imaginary*=a}else{this.real=this.real*a.real-this.imaginary*a.imaginary;this.imaginary=this.real*a.imaginary+this.imaginary*a.real}};JXG.Complex.prototype.div=function(b){var a;if(typeof b=="number"){if(Math.abs(b)<Math.eps){this.real=Infinity;this.imaginary=Infinity;return}this.real/=b;this.imaginary/=b}else{if((Math.abs(b.real)<Math.eps)&&(Math.abs(b.imaginary)<Math.eps)){this.real=Infinity;this.imaginary=Infinity;return}a=b.real*b.real+b.imaginary*b.imaginary;this.real=(this.real*b.real+this.imaginary*b.imaginary)/a;this.imaginary=(this.imaginary*b.real-this.real*b.imaginary)/a}};JXG.C={};JXG.C.add=function(b,a){var d=new JXG.Complex(b);d.add(a);return d};JXG.C.sub=function(b,a){var d=new JXG.Complex(b);d.sub(a);return d};JXG.C.mult=function(b,a){var d=new JXG.Complex(b);d.mult(a);return d};JXG.C.div=function(b,a){var d=new JXG.Complex(b);d.div(a);return d};JXG.AbstractRenderer=function(){this.vOffsetText=8;this.enhancedRendering=true};JXG.AbstractRenderer.prototype.drawPoint=function(a){var b,d=a.visProp.face;if(d=="cross"||d=="x"){b=this.createPrimitive("path",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"path")}else{if(d=="circle"||d=="o"){b=this.createPrimitive("circle",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"circle")}else{if(d=="square"||d=="[]"){b=this.createPrimitive("rect",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"rect")}else{if(d=="plus"||d=="+"){b=this.createPrimitive("path",a.id);this.appendChildPrimitive(b,"points");this.appendNodesToElement(a,"path")}}}}a.rendNode=b;this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.updatePoint(a)};JXG.AbstractRenderer.prototype.updatePoint=function(b){var a=b.visProp.size,d=b.visProp.face;if(isNaN(b.coords.scrCoords[2])||isNaN(b.coords.scrCoords[1])){return}if(this.enhancedRendering){if(!b.visProp.draft){this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity)}else{this.setDraft(b)}}if(d=="cross"||d=="x"){this.updatePathPrimitive(b.rendNode,this.updatePathStringPoint(b,a,"x"),b.board)}else{if(d=="circle"||d=="o"){this.updateCirclePrimitive(b.rendNode,b.coords.scrCoords[1],b.coords.scrCoords[2],a+1)}else{if(d=="square"||d=="[]"){this.updateRectPrimitive(b.rendNode,b.coords.scrCoords[1]-a,b.coords.scrCoords[2]-a,a*2,a*2)}else{if(d=="plus"||d=="+"){this.updatePathPrimitive(b.rendNode,this.updatePathStringPoint(b,a,"+"),b.board)}}}}this.setShadow(b)};JXG.AbstractRenderer.prototype.changePointStyle=function(a){var b=this.getElementById(a.id);if(b!=null){this.remove(b)}this.drawPoint(a);JXG.clearVisPropOld(a);if(!a.visProp.visible){this.hide(a)}if(a.visProp.draft){this.setDraft(a)}};JXG.AbstractRenderer.prototype.drawLine=function(a){var b=this.createPrimitive("line",a.id);this.appendChildPrimitive(b,"lines");this.appendNodesToElement(a,"lines");this.updateLine(a)};JXG.AbstractRenderer.prototype.updateLine=function(b){var u=new JXG.Coords(JXG.COORDS_BY_USER,b.point1.coords.usrCoords,b.board),s=new JXG.Coords(JXG.COORDS_BY_USER,b.point2.coords.usrCoords,b.board),a,w,h,g,q,e,l,k,d;this.calcStraight(b,u,s);this.updateLinePrimitive(b.rendNode,u.scrCoords[1],u.scrCoords[2],s.scrCoords[1],s.scrCoords[2],b.board);if(b.image!=null){a=u.scrCoords[1];w=u.scrCoords[2];h=s.scrCoords[1];g=s.scrCoords[2];e=(h-a>0)?1:-1;if(Math.abs(h-a)>1e-7){q=Math.atan((g-w)/(h-a))+((e<0)?Math.PI:0)}else{q=((g-w>0)?0.5:-0.5)*Math.PI}l=250;k=256;d=[[1,0,0],[l*(1-Math.cos(q))+k*Math.sin(q),Math.cos(q),-Math.sin(q)],[k*(1-Math.cos(q))-l*Math.sin(q),Math.sin(q),Math.cos(q)]];b.imageTransformMatrix=d}this.makeArrows(b);if(this.enhancedRendering){if(!b.visProp.draft){this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setDashStyle(b,b.visProp);this.setShadow(b)}else{this.setDraft(b)}}};JXG.AbstractRenderer.prototype.calcStraight=function(g,z,u){var d,a,m,k,A,e,w,q,D,l,h,C,B;w=g.board.algebra;A=g.visProp.straightFirst;e=g.visProp.straightLast;if(Math.abs(z.scrCoords[0])<w.eps){A=true}if(Math.abs(u.scrCoords[0])<w.eps){e=true}if(!A&&!e){return}q=[];q[0]=g.stdform[0]-g.stdform[1]*g.board.origin.scrCoords[1]/g.board.stretchX+g.stdform[2]*g.board.origin.scrCoords[2]/g.board.stretchY;q[1]=g.stdform[1]/g.board.stretchX;q[2]=g.stdform[2]/(-g.board.stretchY);if(isNaN(q[0]+q[1]+q[2])){return}D=[];D[0]=w.crossProduct(q,[0,0,1]);D[1]=w.crossProduct(q,[0,1,0]);D[2]=w.crossProduct(q,[-g.board.canvasHeight,0,1]);D[3]=w.crossProduct(q,[-g.board.canvasWidth,1,0]);for(l=0;l<4;l++){if(Math.abs(D[l][0])>w.eps){for(h=2;h>0;h--){D[l][h]/=D[l][0]}D[l][0]=1}}d=false;a=false;if(!A&&z.scrCoords[1]>=0&&z.scrCoords[1]<=g.board.canvasWidth&&z.scrCoords[2]>=0&&z.scrCoords[2]<=g.board.canvasHeight){d=true}if(!e&&u.scrCoords[1]>=0&&u.scrCoords[1]<=g.board.canvasWidth&&u.scrCoords[2]>=0&&u.scrCoords[2]<=g.board.canvasHeight){a=true}if(Math.abs(D[1][0])<w.eps){m=D[0];k=D[2]}else{if(Math.abs(D[0][0])<w.eps){m=D[1];k=D[3]}else{if(D[1][2]<0){m=D[0];if(D[3][2]>g.board.canvasHeight){k=D[2]}else{k=D[3]}}else{if(D[1][2]>g.board.canvasHeight){m=D[2];if(D[3][2]<0){k=D[0]}else{k=D[3]}}else{m=D[1];if(D[3][2]<0){k=D[0]}else{if(D[3][2]>g.board.canvasHeight){k=D[2]}else{k=D[3]}}}}}}m=new JXG.Coords(JXG.COORDS_BY_SCREEN,m.slice(1),g.board);k=new JXG.Coords(JXG.COORDS_BY_SCREEN,k.slice(1),g.board);if(!d){if(!a){if(this.isSameDirection(z,u,m)){if(!this.isSameDirection(z,u,k)){B=m;C=k}else{if(g.board.algebra.affineDistance(u.usrCoords,m.usrCoords)<g.board.algebra.affineDistance(u.usrCoords,k.usrCoords)){C=m;B=k}else{B=m;C=k}}}else{if(this.isSameDirection(z,u,k)){C=m;B=k}else{if(g.board.algebra.affineDistance(u.usrCoords,m.usrCoords)<g.board.algebra.affineDistance(u.usrCoords,k.usrCoords)){B=m;C=k}else{C=m;B=k}}}}else{if(this.isSameDirection(u,z,m)){C=m}else{C=k}}}else{if(!a){if(this.isSameDirection(z,u,m)){B=m}else{B=k}}}if(C){z.setCoordinates(JXG.COORDS_BY_USER,C.usrCoords.slice(1))}if(B){u.setCoordinates(JXG.COORDS_BY_USER,B.usrCoords.slice(1))}};JXG.AbstractRenderer.prototype.isSameDirection=function(k,e,d){var b,a,h,g;b=e.usrCoords[1]-k.usrCoords[1];a=e.usrCoords[2]-k.usrCoords[2];h=d.usrCoords[1]-k.usrCoords[1];g=d.usrCoords[2]-k.usrCoords[2];if(Math.abs(b)<JXG.Math.eps){b=0}if(Math.abs(a)<JXG.Math.eps){a=0}if(Math.abs(h)<JXG.Math.eps){h=0}if(Math.abs(g)<JXG.Math.eps){g=0}if(b>=0&&h>=0){if((a>=0&&g>=0)||(a<=0&&g<=0)){return true}}else{if(b<=0&&h<=0){if((a>=0&&g>=0)||(a<=0&&g<=0)){return true}}}return false};JXG.AbstractRenderer.prototype.updateTicks=function(b,e,a,g,d){};JXG.AbstractRenderer.prototype.removeTicks=function(a){var b=this.getElementById(a.id+"_ticks");this.remove(b)};JXG.AbstractRenderer.prototype.drawArrow=function(a){var b=this.createPrimitive("line",a.id);this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setDashStyle(a,a.visProp);this.makeArrow(b,a);this.appendChildPrimitive(b,"lines");this.appendNodesToElement(a,"lines");this.updateArrow(a)};JXG.AbstractRenderer.prototype.updateArrow=function(a){if(this.enhancedRendering){if(!a.visProp.draft){this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setShadow(a);this.setDashStyle(a,a.visProp)}else{this.setDraft(a)}}this.updateLinePrimitive(a.rendNode,a.point1.coords.scrCoords[1],a.point1.coords.scrCoords[2],a.point2.coords.scrCoords[1],a.point2.coords.scrCoords[2],a.board)};JXG.AbstractRenderer.prototype.drawCurve=function(a){var b=this.createPrimitive("path",a.id);this.appendChildPrimitive(b,"curves");this.appendNodesToElement(a,"path");this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setDashStyle(a,a.visProp);this.updateCurve(a)};JXG.AbstractRenderer.prototype.updateCurve=function(a){if(this.enhancedRendering){if(!a.visProp.draft){this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeOpacity);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setDashStyle(a,a.visProp);this.setShadow(a)}else{this.setDraft(a)}}this.updatePathPrimitive(a.rendNode,this.updatePathStringPrimitive(a),a.board)};JXG.AbstractRenderer.prototype.drawCircle=function(a){var b=this.createPrimitive("ellipse",a.id);this.appendChildPrimitive(b,"circles");this.appendNodesToElement(a,"ellipse");this.updateCircle(a)};JXG.AbstractRenderer.prototype.updateCircle=function(b){if(this.enhancedRendering){if(!b.visProp.draft){this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity);this.setDashStyle(b,b.visProp);this.setShadow(b)}else{this.setDraft(b)}}var a=b.getRadius();if(a>0&&!isNaN(b.midpoint.coords.scrCoords[1]+b.midpoint.coords.scrCoords[2])){this.updateEllipsePrimitive(b.rendNode,b.midpoint.coords.scrCoords[1],b.midpoint.coords.scrCoords[2],(a*b.board.stretchX),(a*b.board.stretchY))}};JXG.AbstractRenderer.prototype.drawPolygon=function(a){var b=this.createPrimitive("polygon",a.id);a.visProp.fillOpacity=0.3;this.appendChildPrimitive(b,"polygone");this.appendNodesToElement(a,"polygon");this.updatePolygon(a)};JXG.AbstractRenderer.prototype.updatePolygon=function(a){if(this.enhancedRendering){if(!a.visProp.draft){this.setObjectStrokeWidth(a,a.visProp.strokeWidth);this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillOpacity);this.setShadow(a)}else{this.setDraft(a)}}this.updatePolygonePrimitive(a.rendNode,a)};JXG.AbstractRenderer.prototype.drawArc=function(a){};JXG.AbstractRenderer.prototype.updateArc=function(a){};JXG.AbstractRenderer.prototype.drawText=function(a){var b;if(a.display=="html"){b=this.container.ownerDocument.createElement("div");b.style.position="absolute";b.style.fontSize=a.board.fontSize+"px";b.style.color=a.visProp.strokeColor;b.className="JXGtext";b.style.zIndex="10";this.container.appendChild(b);b.setAttribute("id",a.id)}else{b=this.drawInternalText(a)}a.rendNode=b;a.htmlStr="";this.updateText(a)};JXG.AbstractRenderer.prototype.drawInternalText=function(a){};JXG.AbstractRenderer.prototype.updateText=function(a){if(a.visProp.visible==false){return}if(isNaN(a.coords.scrCoords[1]+a.coords.scrCoords[2])){return}this.updateTextStyle(a);if(a.display=="html"){a.rendNode.style.left=(a.coords.scrCoords[1])+"px";a.rendNode.style.top=(a.coords.scrCoords[2]-this.vOffsetText)+"px";a.updateText();if(a.htmlStr!=a.plaintextStr){a.rendNode.innerHTML=a.plaintextStr;if(a.board.options.text.useASCIIMathML){AMprocessNode(a.rendNode,false)}a.htmlStr=a.plaintextStr}}else{this.updateInternalText(a)}};JXG.AbstractRenderer.prototype.updateInternalText=function(a){};JXG.AbstractRenderer.prototype.updateTextStyle=function(b){var a;if(b.visProp.fontSize){if(typeof b.visProp.fontSize=="function"){a=b.visProp.fontSize();b.rendNode.style.fontSize=(a>0?a:0)}else{b.rendNode.style.fontSize=(b.visProp.fontSize)}}};JXG.AbstractRenderer.prototype.drawAngle=function(a){};JXG.AbstractRenderer.prototype.updateAngle=function(a){};JXG.AbstractRenderer.prototype.drawImage=function(a){};JXG.AbstractRenderer.prototype.updateImage=function(a){this.updateRectPrimitive(a.rendNode,a.coords.scrCoords[1],a.coords.scrCoords[2]-a.size[1],a.size[0],a.size[1]);if(a.parent!=null){this.transformImageParent(a,a.parent.imageTransformMatrix)}else{this.transformImageParent(a)}this.transformImage(a,a.transformations)};JXG.AbstractRenderer.prototype.drawGrid=function(g){var E=g.gridX,C=g.gridY,A=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],g),h=new JXG.Coords(JXG.COORDS_BY_SCREEN,[g.canvasWidth,g.canvasHeight],g),F=Math.ceil(A.usrCoords[1]),B=0,D,a,w,z,s,q,u,m,b,d,e;g.hasGrid=true;for(D=0;D<=E+1;D++){if(F-D/E<A.usrCoords[1]){B=D-1;break}}F=Math.floor(h.usrCoords[1]);a=0;for(D=0;D<=E+1;D++){if(F+D/E>h.usrCoords[1]){a=D-1;break}}F=Math.ceil(h.usrCoords[2]);z=0;for(D=0;D<=C+1;D++){if(F-D/C<h.usrCoords[2]){z=D-1;break}}F=Math.floor(A.usrCoords[2]);w=0;for(D=0;D<=C+1;D++){if(F+D/C>A.usrCoords[2]){w=D-1;break}}s=Math.round((1/E)*g.stretchX);q=Math.round((1/C)*g.stretchY);u=new JXG.Coords(JXG.COORDS_BY_USER,[Math.ceil(A.usrCoords[1])-B/E,Math.floor(A.usrCoords[2])+w/C],g);m=new JXG.Coords(JXG.COORDS_BY_USER,[Math.floor(h.usrCoords[1])+a/E,Math.ceil(h.usrCoords[2])-z/C],g);b=this.drawVerticalGrid(u,m,s,g);this.appendChildPrimitive(b,"grid");if(!g.snapToGrid){d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridx";JXG.clearVisPropOld(d);this.setObjectStrokeColor(d,g.gridColor,g.gridOpacity)}else{d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridx";JXG.clearVisPropOld(d);this.setObjectStrokeColor(d,"#FF8080",0.5)}this.setPropertyPrimitive(b,"stroke-width","0.4px");if(g.gridDash){this.setGridDash("gridx")}b=this.drawHorizontalGrid(u,m,q,g);this.appendChildPrimitive(b,"grid");if(!g.snapToGrid){d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridy";JXG.clearVisPropOld(d);this.setObjectStrokeColor(d,g.gridColor,g.gridOpacity)}else{d=new Object();d.rendNode=b;d.elementClass=JXG.OBJECT_CLASS_LINE;d.id="gridy";JXG.clearVisPropOld(d);this.setObjectStrokeColor(d,"#FF8080",0.5)}this.setPropertyPrimitive(b,"stroke-width","0.4px");if(g.gridDash){this.setGridDash("gridy")}};JXG.AbstractRenderer.prototype.removeGrid=function(a){};JXG.AbstractRenderer.prototype.hide=function(a){};JXG.AbstractRenderer.prototype.show=function(a){};JXG.AbstractRenderer.prototype.setObjectStrokeWidth=function(b,a){};JXG.AbstractRenderer.prototype.setObjectStrokeColor=function(d,a,b){};JXG.AbstractRenderer.prototype.setObjectFillColor=function(d,a,b){};JXG.AbstractRenderer.prototype.setDraft=function(b){if(!b.visProp.draft){return}var a=b.board.options.elements.draft.color,d=b.board.options.elements.draft.opacity;if(b.type==JXG.OBJECTT_TYPE_POLYGON){this.setObjectFillColor(b,a,d)}else{if(b.elementClass==JXG.OBJECT_CLASS_POINT){this.setObjectFillColor(b,a,d)}else{this.setObjectFillColor(b,"none",0)}this.setObjectStrokeColor(b,a,d);this.setObjectStrokeWidth(b,b.board.options.elements.draft.strokeWidth)}};JXG.AbstractRenderer.prototype.removeDraft=function(a){if(a.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillColorOpacity)}else{if(a.type==JXG.OBJECT_CLASS_POINT){this.setObjectFillColor(a,a.visProp.fillColor,a.visProp.fillColorOpacity)}this.setObjectStrokeColor(a,a.visProp.strokeColor,a.visProp.strokeColorOpacity);this.setObjectStrokeWidth(a,a.visProp.strokeWidth)}};JXG.AbstractRenderer.prototype.highlight=function(b){var a;if(b.visProp.draft==false){if(b.type==JXG.OBJECT_CLASS_POINT){this.setObjectStrokeColor(b,b.visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity);this.setObjectFillColor(b,b.visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity)}else{if(b.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(b,b.visProp.highlightFillColor,b.visProp.highlightFillOpacity);for(a=0;a<b.borders.length;a++){this.setObjectStrokeColor(b.borders[a],b.borders[a].visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity)}}else{this.setObjectStrokeColor(b,b.visProp.highlightStrokeColor,b.visProp.highlightStrokeOpacity);this.setObjectFillColor(b,b.visProp.highlightFillColor,b.visProp.highlightFillOpacity)}}}};JXG.AbstractRenderer.prototype.noHighlight=function(b){var a;if(b.visProp.draft==false){if(b.type==JXG.OBJECT_CLASS_POINT){this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity)}else{if(b.type==JXG.OBJECT_TYPE_POLYGON){this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity);for(a=0;a<b.borders.length;a++){this.setObjectStrokeColor(b.borders[a],b.borders[a].visProp.strokeColor,b.visProp.strokeOpacity)}}else{this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity)}}}};JXG.AbstractRenderer.prototype.remove=function(a){};JXG.AbstractRenderer.prototype.suspendRedraw=function(){};JXG.AbstractRenderer.prototype.unsuspendRedraw=function(){};JXG.AbstractRenderer.prototype.drawZoomBar=function(k){var m,d,h,g,b,q,l,a,e;m=this.container.ownerDocument;d=m.createElement("div");d.className="JXGtext";d.style.color="#aaaaaa";d.style.backgroundColor="#f5f5f5";d.style.padding="2px";d.style.position="absolute";d.style.fontSize="10px";d.style.cursor="pointer";d.style.zIndex="100";this.container.appendChild(d);d.style.right="5px";d.style.bottom="5px";h=m.createElement("span");d.appendChild(h);h.innerHTML="&nbsp;&ndash;&nbsp;";JXG.addEvent(h,"click",k.zoomOut,k);g=m.createElement("span");d.appendChild(g);g.innerHTML="&nbsp;o&nbsp;";JXG.addEvent(g,"click",k.zoom100,k);b=m.createElement("span");d.appendChild(b);b.innerHTML="&nbsp;+&nbsp;";JXG.addEvent(b,"click",k.zoomIn,k);q=m.createElement("span");d.appendChild(q);q.innerHTML="&nbsp;&larr;&nbsp;";JXG.addEvent(q,"click",k.clickLeftArrow,k);l=m.createElement("span");d.appendChild(l);l.innerHTML="&nbsp;&uarr;&nbsp;";JXG.addEvent(l,"click",k.clickUpArrow,k);a=m.createElement("span");d.appendChild(a);a.innerHTML="&nbsp;&darr;&nbsp;";JXG.addEvent(a,"click",k.clickDownArrow,k);e=m.createElement("span");d.appendChild(e);e.innerHTML="&nbsp;&rarr;&nbsp;";JXG.addEvent(e,"click",k.clickRightArrow,k)};JXG.AbstractRenderer.prototype.getElementById=function(a){return document.getElementById(a)};JXG.AbstractRenderer.prototype.findSplit=function(C,l,h){var s=0,m=l,q,g,D,B,A,e,z,b,u,w,a;if(h-l<2){return[-1,0]}D=C[l].scrCoords;B=C[h].scrCoords;if(isNaN(D[1]+D[2]+B[1]+B[2])){return[NaN,h]}for(g=l+1;g<h;g++){A=C[g].scrCoords;e=A[1]-D[1];z=A[2]-D[2];b=B[1]-D[1];u=B[2]-D[2];w=b*b+u*u;if(w>=JXG.Math.eps){a=(e*b+z*u)/w;q=e*e+z*z-a*(e*b+z*u)}else{a=0;q=e*e+z*z}if(a<0){q=e*e+z*z}else{if(a>1){e=A[1]-B[1];z=A[2]-B[2];q=e*e+z*z}}if(q>s){s=q;m=g}}return[Math.sqrt(s),m]};JXG.AbstractRenderer.prototype.RDP=function(h,g,e,b,d){var a=this.findSplit(h,g,e);if(a[0]>b){this.RDP(h,g,a[1],b,d);this.RDP(h,a[1],e,b,d)}else{d.push(h[e])}};JXG.AbstractRenderer.prototype.RamenDouglasPeuker=function(h,b){var e=[],g,d,a;a=h.length;g=0;while(g<a&&isNaN(h[g].scrCoords[1]+h[g].scrCoords[2])){g++}d=a-1;while(d>g&&isNaN(h[d].scrCoords[1]+h[d].scrCoords[2])){d--}if(g>d||g==a){return[]}e[0]=h[g];this.RDP(h,g,d,b,e);return e};JXG.AbstractRenderer.prototype.setShadow=function(a){};JXG.AbstractRenderer.prototype.updatePathStringPoint=function(d,a,b){};JXG.AbstractRenderer.prototype.eval=function(a){if(typeof a=="function"){return a()}else{return a}};JXG.FileReader=new function(){this.parseFileContent=function(a,b,g){this.request=false;var d;try{this.request=new XMLHttpRequest();if(g.toLowerCase()=="raw"){this.request.overrideMimeType("text/plain; charset=iso-8859-1")}else{this.request.overrideMimeType("text/xml; charset=iso-8859-1")}}catch(d){try{this.request=new ActiveXObject("Msxml2.XMLHTTP")}catch(d){try{this.request=new ActiveXObject("Microsoft.XMLHTTP")}catch(d){this.request=false}}}if(!this.request){alert("AJAX not activated!");return}this.request.open("GET",a,true);if(g.toLowerCase()=="raw"){this.cbp=function(){var e=this.request;if(e.readyState==4){b(e.responseText)}}}else{this.cbp=function(){var e=this.request;if(e.readyState==4){this.parseString(e.responseText,b,g,a)}}}this.cb=JXG.bind(this.cbp,this);this.request.onreadystatechange=this.cb;try{this.request.send(null)}catch(d){throw new Error("JSXGraph: problems opening "+a+" !")}};this.cleanWhitespace=function(a){var b=a.firstChild;while(b!=null){if(b.nodeType==3&&!/\S/.test(b.nodeValue)){a.removeChild(b)}else{if(b.nodeType==1){this.cleanWhitespace(b)}}b=b.nextSibling}};this.stringToXMLTree=function(b){if(typeof DOMParser=="undefined"){DOMParser=function(){};DOMParser.prototype.parseFromString=function(g,h){if(typeof ActiveXObject!="undefined"){var e=new ActiveXObject("MSXML.DomDocument");e.loadXML(g);return e}}}var d=new DOMParser();var a=d.parseFromString(b,"text/xml");this.cleanWhitespace(a);return a};this.parseString=function(e,d,g,b){if(g.toLowerCase()=="geonext"){e=JXG.GeonextReader.prepareString(e)}if(g.toLowerCase()=="geogebra"){e=JXG.GeogebraReader.prepareString(e)}if(g.toLowerCase()=="intergeo"){e=JXG.IntergeoReader.prepareString(e)}d.xmlString=e;var a=this.stringToXMLTree(e);this.readElements(a,d,g)};this.readElements=function(a,b,d){if(d.toLowerCase()=="geonext"){b.suspendUpdate();if(a.getElementsByTagName("GEONEXT").length!=0){JXG.GeonextReader.readGeonext(a,b)}b.unsuspendUpdate()}else{if(a.getElementsByTagName("geogebra").length!=0){JXG.GeogebraReader.readGeogebra(a,b)}else{if(d.toLowerCase()=="intergeo"){JXG.IntergeoReader.readIntergeo(a,b)}}}b.afterLoad()}};JXG.GeogebraReader=new function(){this.ggbAct=function(type,m,n,p){var v1=m,v2=n;switch(type.toLowerCase()){case"end":JXG.GeogebraReader.debug("<b>end: </b>"+v1);return v1;break;case"coord":var s1=(board.ggbElements[v1])?JXG.getReference(JXG.GeogebraReader.board,v1):v1;var s2=(board.ggbElements[v2])?JXG.getReference(JXG.GeogebraReader.board,v2):v2;JXG.GeogebraReader.debug("<br/><b>Aktualisierung des Punktes:</b> <li>x["+typeof s1+": "+s1+"]</li><li>y["+typeof s2+": "+s2+"]</li>");p.addConstraint([new Function("return "+s1+";"),new Function("return "+s2+";")]);return p;break;case"le":return"( ("+v1+")<=("+v2+") )";break;case"ge":return"("+v1+">="+v2+")";break;case"eq":return"("+v1+"=="+v2+")";break;case"neq":return"("+v1+"!="+v2+")";break;case"lt":return"("+v1+"<"+v2+")";break;case"gt":return"("+v1+">"+v2+")";break;case"add":return v1+"+"+v2;break;case"sub":return v1+"-"+v2;break;case"neg":return"!("+v1+")";break;case"pow":return"Math.pow("+v1+", "+v2+")";break;case"or":return"("+v1+"||"+v2+")";break;case"and":return"("+v1+"&&"+v2+")";break;case"mul":return v1+"*"+v2;break;case"div":return v1+"/"+v2;break;case"negmult":return v1*-1;break;case"bra":return v1;break;case"int":return v1;break;case"float":return v1;break;case"param":return v1;break;case"html":return v1;break;case"string":if(v2){return[v1,v2]}else{return v1}break;case"var":if(v2){switch(v1.toLowerCase()){case"x":return v2+".X()";break;case"y":return v2+".Y()";break;default:return"Math."+v1.toLowerCase()+"("+v2+")";break}}else{if(typeof JXG.GeogebraReader.board.ggbElements[v1]=="undefined"||JXG.GeogebraReader.board.ggbElements[v1]==""){var input=JXG.GeogebraReader.getElement(v1);JXG.GeogebraReader.board.ggbElements[v1]=JXG.GeogebraReader.writeElement(JXG.GeogebraReader.board,input);JXG.GeogebraReader.debug("regged: "+v1+" (id: "+JXG.GeogebraReader.board.ggbElements[v1].id+")")}var a=JXG.GeogebraReader.board.ggbElements[v1];if(typeof a.Value!="undefined"&&typeof a._smin!="undefined"){return'JXG.getReference(JXG.GeogebraReader.board, "'+v1+'").Value()'}else{if(typeof a.Area!="undefined"){return'JXG.getReference(JXG.GeogebraReader.board, "'+v1+'").Area();'}else{return'JXG.getReference(JXG.GeogebraReader.board, "'+v1+'")'}}}break}};this.ggbParse=function(exp,element){var element=(element)?JXG.getReference(JXG.GeogebraReader.board,JXG.GeogebraReader.board.ggbElements[element].id):false;if(element){JXG.GeogebraReader.debug("Zu aktualisierendes Element: "+element.name+"("+element.id+")")}exp=(exp.match(/\u00B2/))?exp.replace(/\u00B2/,"^2"):exp;exp=(exp.match(/\u00B3/))?exp.replace(/\u00B3/,"^3"):exp;exp=(exp.match(/\u225F/))?exp.replace(/\u225F/,"=="):exp;exp=(exp.match(/\u2260/))?exp.replace(/\u2260/,"!="):exp;exp=(exp.match(/\u2264/))?exp.replace(/\u2264/,"<="):exp;exp=(exp.match(/\u2265/))?exp.replace(/\u2265/,">="):exp;exp=(exp.match(/\u2227/))?exp.replace(/\u2227/,"&&"):exp;exp=(exp.match(/\u2228/))?exp.replace(/\u2228/,"//"):exp;JXG.GeogebraReader.debug("EXP: "+exp);var _dbg_withtrace=false;var _dbg_string=new String();function __dbg_print(text){_dbg_string+=text+"\n"}function __lex(info){var state=0;var match=-1;var match_pos=0;var start=0;var pos=info.offset+1;do{pos--;state=0;match=-2;start=pos;if(info.src.length<=start){return 27}do{switch(state){case 0:if(info.src.charCodeAt(pos)==9||info.src.charCodeAt(pos)==32){state=1}else{if(info.src.charCodeAt(pos)==33){state=2}else{if(info.src.charCodeAt(pos)==40){state=3}else{if(info.src.charCodeAt(pos)==41){state=4}else{if(info.src.charCodeAt(pos)==42){state=5}else{if(info.src.charCodeAt(pos)==43){state=6}else{if(info.src.charCodeAt(pos)==44){state=7}else{if(info.src.charCodeAt(pos)==45){state=8}else{if(info.src.charCodeAt(pos)==47){state=9}else{if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)){state=10}else{if(info.src.charCodeAt(pos)==60){state=11}else{if(info.src.charCodeAt(pos)==62){state=12}else{if((info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)){state=13}else{if(info.src.charCodeAt(pos)==94){state=14}else{if(info.src.charCodeAt(pos)==34){state=25}else{if(info.src.charCodeAt(pos)==38){state=26}else{if(info.src.charCodeAt(pos)==46){state=27}else{if(info.src.charCodeAt(pos)==61){state=28}else{if(info.src.charCodeAt(pos)==95){state=29}else{if(info.src.charCodeAt(pos)==124){state=30}else{state=-1}}}}}}}}}}}}}}}}}}}}break;case 1:state=-1;match=1;match_pos=pos;break;case 2:if(info.src.charCodeAt(pos)==61){state=15}else{state=-1}match=22;match_pos=pos;break;case 3:state=-1;match=2;match_pos=pos;break;case 4:state=-1;match=3;match_pos=pos;break;case 5:state=-1;match=12;match_pos=pos;break;case 6:state=-1;match=10;match_pos=pos;break;case 7:state=-1;match=15;match_pos=pos;break;case 8:state=-1;match=11;match_pos=pos;break;case 9:state=-1;match=13;match_pos=pos;break;case 10:if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)){state=10}else{if(info.src.charCodeAt(pos)==46){state=18}else{state=-1}}match=4;match_pos=pos;break;case 11:if(info.src.charCodeAt(pos)==61){state=19}else{state=-1}match=20;match_pos=pos;break;case 12:if(info.src.charCodeAt(pos)==61){state=21}else{state=-1}match=21;match_pos=pos;break;case 13:if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)||(info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)){state=13}else{if(info.src.charCodeAt(pos)==95){state=32}else{state=-1}}match=7;match_pos=pos;break;case 14:state=-1;match=14;match_pos=pos;break;case 15:state=-1;match=19;match_pos=pos;break;case 16:state=-1;match=9;match_pos=pos;break;case 17:state=-1;match=24;match_pos=pos;break;case 18:if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)){state=18}else{state=-1}match=5;match_pos=pos;break;case 19:state=-1;match=16;match_pos=pos;break;case 20:state=-1;match=18;match_pos=pos;break;case 21:state=-1;match=17;match_pos=pos;break;case 22:state=-1;match=23;match_pos=pos;break;case 23:state=-1;match=8;match_pos=pos;break;case 24:if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)||(info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)){state=24}else{state=-1}match=6;match_pos=pos;break;case 25:if(info.src.charCodeAt(pos)==34){state=16}else{if(info.src.charCodeAt(pos)==32||info.src.charCodeAt(pos)==46||(info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)||info.src.charCodeAt(pos)==61||(info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)||info.src.charCodeAt(pos)==223||info.src.charCodeAt(pos)==228||info.src.charCodeAt(pos)==246||info.src.charCodeAt(pos)==252){state=25}else{state=-1}}break;case 26:if(info.src.charCodeAt(pos)==38){state=17}else{if((info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)){state=31}else{state=-1}}break;case 27:if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)){state=18}else{state=-1}break;case 28:if(info.src.charCodeAt(pos)==61){state=20}else{state=-1}break;case 29:if(info.src.charCodeAt(pos)==95){state=33}else{state=-1}break;case 30:if(info.src.charCodeAt(pos)==124){state=22}else{state=-1}break;case 31:if(info.src.charCodeAt(pos)==59){state=23}else{if((info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)){state=31}else{state=-1}}break;case 32:if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)||(info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)){state=13}else{if(info.src.charCodeAt(pos)==95){state=32}else{state=-1}}break;case 33:if((info.src.charCodeAt(pos)>=48&&info.src.charCodeAt(pos)<=57)||(info.src.charCodeAt(pos)>=65&&info.src.charCodeAt(pos)<=90)||(info.src.charCodeAt(pos)>=97&&info.src.charCodeAt(pos)<=122)){state=24}else{state=-1}break}pos++}while(state>-1)}while(1>-1&&match==1);if(match>-1){info.att=info.src.substr(start,match_pos-start);info.offset=match_pos}else{info.att=new String();match=-1}return match}function __parse(src,err_off,err_la){var sstack=new Array();var vstack=new Array();var err_cnt=0;var act;var go;var la;var rval;var parseinfo=new Function("","var offset; var src; var att;");var info=new parseinfo();var pop_tab=new Array(new Array(0,1),new Array(26,1),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,2),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,3),new Array(25,2),new Array(25,3),new Array(25,3),new Array(25,1),new Array(25,1),new Array(25,1),new Array(25,1),new Array(25,1),new Array(25,4),new Array(25,1));var act_tab=new Array(new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(27,0),new Array(13,12,12,13,24,14,23,15,14,16,11,17,10,18,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-1),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(10,29,27,-24,15,-24,16,-24,17,-24,18,-24,19,-24,20,-24,21,-24,11,-24,14,-24,23,-24,24,-24,12,-24,13,-24,3,-24),new Array(27,-20,15,-20,16,-20,17,-20,18,-20,19,-20,20,-20,21,-20,10,-20,11,-20,14,-20,23,-20,24,-20,12,-20,13,-20,3,-20),new Array(27,-21,15,-21,16,-21,17,-21,18,-21,19,-21,20,-21,21,-21,10,-21,11,-21,14,-21,23,-21,24,-21,12,-21,13,-21,3,-21),new Array(27,-22,15,-22,16,-22,17,-22,18,-22,19,-22,20,-22,21,-22,10,-22,11,-22,14,-22,23,-22,24,-22,12,-22,13,-22,3,-22),new Array(27,-23,15,-23,16,-23,17,-23,18,-23,19,-23,20,-23,21,-23,10,-23,11,-23,14,-23,23,-23,24,-23,12,-23,13,-23,3,-23),new Array(2,30,27,-26,15,-26,16,-26,17,-26,18,-26,19,-26,20,-26,21,-26,10,-26,11,-26,14,-26,23,-26,24,-26,12,-26,13,-26,3,-26),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(13,-11,12,-11,24,14,23,15,14,-11,11,-11,10,-11,21,-11,20,-11,19,-11,18,-11,17,-11,16,-11,15,-11,27,-11,3,-11),new Array(13,-17,12,-17,24,14,23,15,14,16,11,-17,10,-17,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-17,3,-17),new Array(13,12,12,13,24,14,23,15,14,16,11,17,10,18,21,19,20,20,19,21,18,22,17,23,16,24,15,25,3,45),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(22,3,11,4,2,5,9,6,4,7,5,8,6,9,8,10,7,11),new Array(13,-16,12,-16,24,14,23,15,14,16,11,-16,10,-16,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-16,3,-16),new Array(13,-15,12,-15,24,14,23,15,14,16,11,-15,10,-15,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-15,3,-15),new Array(13,-14,12,-14,24,-14,23,-14,14,-14,11,-14,10,-14,21,-14,20,-14,19,-14,18,-14,17,-14,16,-14,15,-14,27,-14,3,-14),new Array(13,-13,12,-13,24,-13,23,-13,14,-13,11,-13,10,-13,21,-13,20,-13,19,-13,18,-13,17,-13,16,-13,15,-13,27,-13,3,-13),new Array(13,-12,12,-12,24,14,23,15,14,-12,11,-12,10,-12,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-12,3,-12),new Array(13,12,12,13,24,14,23,15,14,16,11,-10,10,-10,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-10,3,-10),new Array(13,12,12,13,24,14,23,15,14,16,11,-9,10,-9,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-9,3,-9),new Array(13,-8,12,-8,24,14,23,15,14,-8,11,-8,10,-8,21,-8,20,-8,19,-8,18,-8,17,-8,16,-8,15,-8,27,-8,3,-8),new Array(13,-7,12,-7,24,14,23,15,14,-7,11,-7,10,-7,21,-7,20,-7,19,-7,18,-7,17,-7,16,-7,15,-7,27,-7,3,-7),new Array(13,-6,12,-6,24,14,23,15,14,-6,11,-6,10,-6,21,-6,20,-6,19,-6,18,-6,17,-6,16,-6,15,-6,27,-6,3,-6),new Array(13,-5,12,-5,24,14,23,15,14,-5,11,-5,10,-5,21,-5,20,-5,19,-5,18,-5,17,-5,16,-5,15,-5,27,-5,3,-5),new Array(13,-4,12,-4,24,14,23,15,14,-4,11,-4,10,-4,21,-4,20,-4,19,-4,18,-4,17,-4,16,-4,15,-4,27,-4,3,-4),new Array(13,-3,12,-3,24,14,23,15,14,-3,11,-3,10,-3,21,-3,20,-3,19,-3,18,-3,17,-3,16,-3,15,-3,27,-3,3,-3),new Array(13,-2,12,-2,24,14,23,15,14,-2,11,-2,10,-2,21,19,20,20,19,21,18,22,17,23,16,24,15,-2,27,-2,3,-2),new Array(27,-18,15,-18,16,-18,17,-18,18,-18,19,-18,20,-18,21,-18,10,-18,11,-18,14,-18,23,-18,24,-18,12,-18,13,-18,3,-18),new Array(13,12,12,13,24,14,23,15,14,16,11,-19,10,-19,21,19,20,20,19,21,18,22,17,23,16,24,15,25,27,-19,3,-19),new Array(13,12,12,13,24,14,23,15,14,16,11,17,10,18,21,19,20,20,19,21,18,22,17,23,16,24,15,25,3,48),new Array(27,-25,15,-25,16,-25,17,-25,18,-25,19,-25,20,-25,21,-25,10,-25,11,-25,14,-25,23,-25,24,-25,12,-25,13,-25,3,-25));var goto_tab=new Array(new Array(26,1,25,2),new Array(),new Array(),new Array(25,26),new Array(25,27),new Array(25,28),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(25,31),new Array(25,32),new Array(25,33),new Array(25,34),new Array(25,35),new Array(25,36),new Array(25,37),new Array(25,38),new Array(25,39),new Array(25,40),new Array(25,41),new Array(25,42),new Array(25,43),new Array(25,44),new Array(),new Array(),new Array(),new Array(25,46),new Array(25,47),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array(),new Array());var labels=new Array("p'","WHITESPACE","(",")","INT","FLOAT","PARAM","VAR","HTML","STRING","+","-","*","/","^",",","<=",">=","==","!=","<",">","!","||","&&","e","p","$");info.offset=0;info.src=src;info.att=new String();if(!err_off){err_off=new Array()}if(!err_la){err_la=new Array()}sstack.push(0);vstack.push(0);la=__lex(info);while(true){act=50;for(var i=0;i<act_tab[sstack[sstack.length-1]].length;i+=2){if(act_tab[sstack[sstack.length-1]][i]==la){act=act_tab[sstack[sstack.length-1]][i+1];break}}if(_dbg_withtrace&&sstack.length>0){__dbg_print("\nState "+sstack[sstack.length-1]+"\n\tLookahead: "+labels[la]+' ("'+info.att+'")\n\tAction: '+act+'\n\tSource: "'+info.src.substr(info.offset,30)+((info.offset+30<info.src.length)?"...":"")+'"\n\tStack: '+sstack.join()+"\n\tValue stack: "+vstack.join()+"\n")}if(act==50){if(_dbg_withtrace){__dbg_print("Error detected: There is no reduce or shift on the symbol "+labels[la])}err_cnt++;err_off.push(info.offset-info.att.length);err_la.push(new Array());for(var i=0;i<act_tab[sstack[sstack.length-1]].length;i+=2){err_la[err_la.length-1].push(labels[act_tab[sstack[sstack.length-1]][i]])}var rsstack=new Array();var rvstack=new Array();for(var i=0;i<sstack.length;i++){rsstack[i]=sstack[i];rvstack[i]=vstack[i]}while(act==50&&la!=27){if(_dbg_withtrace){__dbg_print("\tError recovery\nCurrent lookahead: "+labels[la]+" ("+info.att+")\nAction: "+act+"\n\n")}if(la==-1){info.offset++}while(act==50&&sstack.length>0){sstack.pop();vstack.pop();if(sstack.length==0){break}act=50;for(var i=0;i<act_tab[sstack[sstack.length-1]].length;i+=2){if(act_tab[sstack[sstack.length-1]][i]==la){act=act_tab[sstack[sstack.length-1]][i+1];break}}}if(act!=50){break}for(var i=0;i<rsstack.length;i++){sstack.push(rsstack[i]);vstack.push(rvstack[i])}la=__lex(info)}if(act==50){if(_dbg_withtrace){__dbg_print("\tError recovery failed, terminating parse process...")}break}if(_dbg_withtrace){__dbg_print("\tError recovery succeeded, continuing")}}if(act>0){if(_dbg_withtrace){__dbg_print("Shifting symbol: "+labels[la]+" ("+info.att+")")}sstack.push(act);vstack.push(info.att);la=__lex(info);if(_dbg_withtrace){__dbg_print("\tNew lookahead symbol: "+labels[la]+" ("+info.att+")")}}else{act*=-1;if(_dbg_withtrace){__dbg_print("Reducing by producution: "+act)}rval=void (0);if(_dbg_withtrace){__dbg_print("\tPerforming semantic action...")}switch(act){case 0:rval=vstack[vstack.length-1];break;case 1:rval=JXG.GeogebraReader.ggbAct("end",vstack[vstack.length-1]);break;case 2:rval=JXG.GeogebraReader.ggbAct("coord",vstack[vstack.length-3],vstack[vstack.length-1],element);break;case 3:rval=JXG.GeogebraReader.ggbAct("le",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 4:rval=JXG.GeogebraReader.ggbAct("ge",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 5:rval=JXG.GeogebraReader.ggbAct("eq",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 6:rval=JXG.GeogebraReader.ggbAct("neq",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 7:rval=JXG.GeogebraReader.ggbAct("lt",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 8:rval=JXG.GeogebraReader.ggbAct("gt",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 9:rval=JXG.GeogebraReader.ggbAct("add",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 10:rval=JXG.GeogebraReader.ggbAct("sub",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 11:rval=JXG.GeogebraReader.ggbAct("neg",vstack[vstack.length-1]);break;case 12:rval=JXG.GeogebraReader.ggbAct("pow",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 13:rval=JXG.GeogebraReader.ggbAct("or",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 14:rval=JXG.GeogebraReader.ggbAct("and",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 15:rval=JXG.GeogebraReader.ggbAct("mul",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 16:rval=JXG.GeogebraReader.ggbAct("div",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 17:rval=JXG.GeogebraReader.ggbAct("negmult",vstack[vstack.length-1]);break;case 18:rval=JXG.GeogebraReader.ggbAct("bra",vstack[vstack.length-2]);break;case 19:rval=JXG.GeogebraReader.ggbAct("string",vstack[vstack.length-3],vstack[vstack.length-1]);break;case 20:rval=JXG.GeogebraReader.ggbAct("int",vstack[vstack.length-1]);break;case 21:rval=JXG.GeogebraReader.ggbAct("float",vstack[vstack.length-1]);break;case 22:rval=JXG.GeogebraReader.ggbAct("param",vstack[vstack.length-1]);break;case 23:rval=JXG.GeogebraReader.ggbAct("html",vstack[vstack.length-1]);break;case 24:rval=JXG.GeogebraReader.ggbAct("string",vstack[vstack.length-1]);break;case 25:rval=JXG.GeogebraReader.ggbAct("var",vstack[vstack.length-4],vstack[vstack.length-2]);break;case 26:rval=JXG.GeogebraReader.ggbAct("var",vstack[vstack.length-1]);break}if(_dbg_withtrace){__dbg_print("\tPopping "+pop_tab[act][1]+" off the stack...")}for(var i=0;i<pop_tab[act][1];i++){sstack.pop();str=vstack.pop()}go=-1;for(var i=0;i<goto_tab[sstack[sstack.length-1]].length;i+=2){if(goto_tab[sstack[sstack.length-1]][i]==pop_tab[act][0]){go=goto_tab[sstack[sstack.length-1]][i+1];break}}if(act==0){break}if(_dbg_withtrace){__dbg_print("\tPushing non-terminal "+labels[pop_tab[act][0]])}sstack.push(go);vstack.push(rval)}if(_dbg_withtrace){JXG.GeogebraReader.debug(_dbg_string);_dbg_string=new String()}}if(_dbg_withtrace){__dbg_print("\nParse complete.");JXG.GeogebraReader.debug(_dbg_string)}return err_cnt}var error_offsets=new Array();var error_lookaheads=new Array();var error_count=0;var str=exp;if((error_count=__parse(str,error_offsets,error_lookaheads))>0){var errstr=new String();for(var i=0;i<error_count;i++){errstr+="Parse error in line "+(str.substr(0,error_offsets[i]).match(/\n/g)?str.substr(0,error_offsets[i]).match(/\n/g).length:1)+' near "'+str.substr(error_offsets[i])+'", expecting "'+error_lookaheads[i].join()+'"\n'}JXG.GeogebraReader.debug(errstr)}return str};this.debug=function(s){document.getElementById("debug").innerHTML+=s+"<br/>"};this.colorProperties=function(Data,attr){var a=(Data.getElementsByTagName("objColor").length>0&&Data.getElementsByTagName("objColor")[0].attributes.alpha)?1*Data.getElementsByTagName("objColor")[0].attributes.alpha.value:0;var r=(Data.getElementsByTagName("objColor").length>0&&Data.getElementsByTagName("objColor")[0].attributes.r)?(1*Data.getElementsByTagName("objColor")[0].attributes.r.value).toString(16):0;var g=(Data.getElementsByTagName("objColor").length>0&&Data.getElementsByTagName("objColor")[0].attributes.g)?(1*Data.getElementsByTagName("objColor")[0].attributes.g.value).toString(16):0;var b=(Data.getElementsByTagName("objColor").length>0&&Data.getElementsByTagName("objColor")[0].attributes.b)?(1*Data.getElementsByTagName("objColor")[0].attributes.b.value).toString(16):0;if(r.length==1){r="0"+r}if(g.length==1){g="0"+g}if(b.length==1){b="0"+b}attr.fillColor="#"+r+g+b;attr.strokeColor=attr.fillColor;attr.fillOpacity=a;return attr};this.boardProperties=function(gxtEl,Data,attr){return attr};this.coordinates=function(gxtEl,Data){gxtEl.x=(Data.getElementsByTagName("coords")[0])?parseFloat(Data.getElementsByTagName("coords")[0].attributes.x.value):(Data.getElementsByTagName("startPoint")[0])?parseFloat(Data.getElementsByTagName("startPoint")[0].attributes.x.value):(Data.getElementsByTagName("absoluteScreenLocation")[0])?parseFloat(Data.getElementsByTagName("absoluteScreenLocation")[0].attributes.x.value):false;gxtEl.y=(Data.getElementsByTagName("coords")[0])?parseFloat(Data.getElementsByTagName("coords")[0].attributes.y.value):(Data.getElementsByTagName("startPoint")[0])?parseFloat(Data.getElementsByTagName("startPoint")[0].attributes.y.value):(Data.getElementsByTagName("absoluteScreenLocation")[0])?parseFloat(Data.getElementsByTagName("absoluteScreenLocation")[0].attributes.y.value):false;gxtEl.z=(Data.getElementsByTagName("coords")[0])?parseFloat(Data.getElementsByTagName("coords")[0].attributes.z.value):(Data.getElementsByTagName("startPoint")[0])?parseFloat(Data.getElementsByTagName("startPoint")[0].attributes.z.value):false;return gxtEl};this.visualProperties=function(Data,attr){(Data.getElementsByTagName("show").length>0&&Data.getElementsByTagName("show")[0].attributes.object)?attr.visible=Data.getElementsByTagName("show")[0].attributes.object.value:false;(Data.getElementsByTagName("show").length>0&&Data.getElementsByTagName("show")[0].attributes.label)?attr.visibleLabel=Data.getElementsByTagName("show")[0].attributes.label.value:false;(Data.getElementsByTagName("pointSize")[0])?attr.style=Data.getElementsByTagName("pointSize")[0].attributes.val.value:false;(Data.getElementsByTagName("labelOffset")[0])?attr.labelX=1*Data.getElementsByTagName("labelOffset")[0].attributes.x.value:false;(Data.getElementsByTagName("labelOffset")[0])?attr.labelY=1*Data.getElementsByTagName("labelOffset")[0].attributes.y.value:false;(Data.getElementsByTagName("trace")[0])?attr.trace=Data.getElementsByTagName("trace")[0].attributes.val.value:false;(Data.getElementsByTagName("fix")[0])?attr.fixed=Data.getElementsByTagName("fix")[0].attributes.val.value:false;return attr};this.getElement=function(name,expr){expr=expr||false;for(var i=0;i<JXG.GeogebraReader.tree.getElementsByTagName("construction").length;i++){if(expr==false){for(var j=0;j<JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("element").length;j++){var Data=JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("element")[j];if(name==Data.attributes.label.value){return Data}}}else{for(var j=0;j<JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("expression").length;j++){var Data=JXG.GeogebraReader.tree.getElementsByTagName("construction")[i].getElementsByTagName("expression")[j];if(name==Data.attributes.label.value){return Data}}}}};this.functionParse=function(type,exp){switch(type){case"c":if(exp.match(/[a-zA-Z0-9]+\([a-zA-Z0-9]+[a-zA-Z0-9,\ ]*\)[\ ]*[=][\ ]*[a-zA-Z0-9\+\-\*\/]+/)){var input=exp.split("(")[1].split(")")[0];var vars=input.split(", ");var output=[];for(var i=0;i<vars.length;i++){output.push("__"+vars[i])}var expr=exp.split("=")[1];for(var i=0;i<vars.length;i++){if(vars[i]=="x"){expr=expr.replace(/x(?!\()/g,"__"+vars[i])}else{if(vars[i]=="y"){expr=expr.replace(/y(?!\()/g,"__"+vars[i])}else{expr=expr.replace(eval("/"+vars[i]+"/g"),"__"+vars[i])}}}if(JXG.GeogebraReader.format<=3.01){var s=expr.split(" ");var o="";for(var i=0;i<s.length;i++){if(s.length!=i+1){if(s[i].search(/\)$/)>-1||s[i].search(/[0-9]+$/)>-1||s[i].search(/[a-zA-Z]+(\_*[a-zA-Z0-9]+)*$/)>-1){if(s[i+1].search(/^\(/)>-1||s[i+1].search(/^[0-9]+/)>-1||s[i+1].search(/^[a-zA-Z]+(\_*[a-zA-Z0-9]+)*/)>-1||s[i+1].search(/\_\_[a-zA-Z0-9]+/)>-1){s[i]=s[i]+"*"}}}o+=s[i]}expr=o}output.push(expr);return output}else{return exp}break;case"s":exp=exp.replace(/x(?!\()/g,"__x");return["__x",exp];break}};this.writeBoard=function(board){var boardData=JXG.GeogebraReader.tree.getElementsByTagName("euclidianView")[0];board.origin={};board.origin.usrCoords=[1,0,0];board.origin.scrCoords=[1,1*boardData.getElementsByTagName("coordSystem")[0].attributes.xZero.value,1*boardData.getElementsByTagName("coordSystem")[0].attributes.yZero.value];board.unitX=(boardData.getElementsByTagName("coordSystem")[0].attributes.scale)?1*boardData.getElementsByTagName("coordSystem")[0].attributes.scale.value:1;board.unitY=(boardData.getElementsByTagName("coordSystem")[0].attributes.yscale)?1*boardData.getElementsByTagName("coordSystem")[0].attributes.yscale.value:board.unitX;board.stretchX=board.zoomX*board.unitX;board.stretchY=board.zoomY*board.unitY;board.fontSize=1*JXG.GeogebraReader.tree.getElementsByTagName("gui")[0].getElementsByTagName("font")[0].attributes.size.value;JXG.JSXGraph.boards[board.id]=board;board.renderer.enhancedRendering=true;var snap=(boardData.getElementsByTagName("evSettings")[0].attributes.pointCapturing.value=="true")?board.snapToGrid=true:null;var grid=(boardData.getElementsByTagName("evSettings")[0].attributes.grid.value=="true")?board.renderer.drawGrid(board):null;if(boardData.getElementsByTagName("evSettings")[0].attributes.axes&&boardData.getElementsByTagName("evSettings")[0].attributes.axes.value=="true"){board.ggbElements.xAxis=board.create("axis",[[0,0],[1,0]],{strokeColor:"black"});board.ggbElements.yAxis=board.create("axis",[[0,0],[0,1]],{strokeColor:"black"})}};this.writeElement=function(board,output,input,cmd){element=(typeof output==="object"&&typeof output.attributes==="undefined")?output[0]:output;var gxtEl={};gxtEl.type=(element.attributes.type&&typeof cmd==="undefined")?element.attributes.type.value.toLowerCase():cmd;gxtEl.label=element.attributes.label.value;var attr={};attr.name=gxtEl.label;JXG.GeogebraReader.debug("<br><b>Konstruiere</b> "+attr.name+"("+gxtEl.type+"):");switch(gxtEl.type){case"point":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{if(typeof input!="undefined"){p=board.create("glider",[gxtEl.x,gxtEl.y,input[0]],attr)}else{p=board.create("point",[gxtEl.x,gxtEl.y],attr)}JXG.GeogebraReader.debug("* <b>Point ("+p.id+"):</b> "+attr.name+"("+gxtEl.x+", "+gxtEl.y+")<br>\n");return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Point "+attr.name+"<br>\n");return false}break;case"segment":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Segment:</b> ("+attr.name+") First: "+input[0].name+", Last: "+input[1].name+"<br>\n");attr.straightFirst=false;attr.straightLast=false;l=board.create("line",input,attr);return l}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Segment "+attr.name+" First: "+input[0].name+", Last: "+input[1].name+"<br>\n");return false}break;case"line":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);if(JXG.getReference(board,input[1].id).type==1330925652){var type="line"}else{if(JXG.getReference(board,input[1].id).type==1330924622){var type="parallel"}}try{JXG.GeogebraReader.debug("* <b>Line:</b> ("+attr.name+") First: "+input[0].id+", Last: "+input[1].id+"<br>\n");l=board.create(type,input,attr);return l}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Line "+attr.label+"<br>\n");return false}break;case"orthogonalline":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Orthogonalline:</b> First: "+input[0].id+", Last: "+input[1].id+"<br>\n");l=board.create("normal",[input[0],input[1]],attr);return l}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Orthogonalline "+attr.label+"<br>\n");return false}break;case"polygon":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);var t;if(input.length==3&&output.length!=4){input[2]=parseInt(input[2]);t="regular"}try{JXG.GeogebraReader.debug("* <b>Polygon:</b> First: "+input[0].name+", Second: "+input[1].name+", Third: "+input[2].name+"<br>\n");var borders=[];var length=output.length;for(var i=1;i<output.length;i++){borders[i-1]={};borders[i-1].id="";borders[i-1].name=output[i].attributes.label.value;JXG.GeogebraReader.debug("border["+typeof borders[i-1]+"]: "+borders[i-1].name)}attr.borders=borders;var points=[];for(var i=0;i<input.length;i++){if(typeof input[i]==="object"){points.push(input[i]);JXG.GeogebraReader.debug("input-queue: added "+input[i].name)}}if(t=="regular"){l=board.create("regularpolygon",input,attr)}else{l=board.create("polygon",points,attr)}return l}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Polygon "+attr.name+"<br>\n");return false}break;case"intersect":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Intersection:</b> First: "+input[0].name+", Second: "+input[1].name+"<br>\n");l=board.create("intersection",[input[0],input[1],0],attr);return l}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Intersection "+attr.name+"<br>\n");return false}break;case"distance":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Distance:</b> First: "+input[0].name+", Second: "+input[1].name+"<br>\n");m=board.create("midpoint",input,{visible:"false"});t=board.create("text",[function(){return m.X()},function(){return m.Y()},function(){return"<span style='text-decoration: overline'>"+input[0].name+input[1].name+"</span> = "+JXG.getReference(board,input[0].id).Dist(JXG.getReference(board,input[1].id))}]);return t}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Intersection "+attr.name+"<br>\n");return false}break;case"vector":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Vector:</b> First: "+input[0].name+", Second: "+input[1].name+"<br>\n");v=board.create("arrow",input,attr);return v}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Vector "+attr.name+"<br>\n");return false}break;case"rotate":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Rotate:</b> First: "+input[0].name+", Second: "+input[1]+"<br>\n");attr.type="rotate";var d=parseInt(input[1]);r=board.create("transform",[d,input[2]],{type:"rotate"});p=board.create("point",[input[0],r],attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Rotate "+attr.name+"<br>\n");return false}break;case"dilate":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Dilate:</b> First: "+input[0].name+", Second: "+input[1]+"<br>\n");attr.type="rotate";var d=parseInt(input[1]);d1=board.create("transform",[d,d],{type:"scale"});d2=board.create("transform",[function(){return(1-d)*input[2].X()},function(){return(1-d)*input[2].Y()}],{type:"translate"});p=board.create("point",[input[0],[d1,d2]],attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Dilate "+attr.name+"<br>\n");return false}break;case"translate":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{t=board.create("transform",[function(){return input[1].point2.X()-input[1].point1.X()},function(){return input[1].point2.Y()-input[1].point1.Y()}],{type:"translate"});p=board.create("point",[input[0],t],attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Translate "+attr.name+"<br>\n");return false}break;case"mirror":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);if(JXG.getReference(board,input[1].id).type==1330925652){var type="mirrorpoint"}else{if(JXG.getReference(board,input[1].id).type==1330924622){var type="reflection"}}try{JXG.GeogebraReader.debug("* <b>Mirror:</b> First: "+input[0].name+", Second: "+input[1].name+"<br>\n");m=board.create(type,[input[1],input[0]],attr);return m}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Mirror "+attr.name+"<br>\n");return false}break;case"circle":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Circle:</b> First: "+input[0].name+", Second: "+input[1]+"<br>\n");c=board.create("circle",input,attr);return c}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Circle "+attr.name+"<br>\n");return false}break;case"circlearc":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>CircleArc:</b> First: "+input[0].name+", Second: "+input[1].name+"<br>\n");c=board.create("arc",input,attr);return c}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> CircleArc "+attr.name+"<br>\n");return false}break;case"circlesector":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>CircleSector:</b> First: "+input[0].name+", Second: "+input[1].name+"<br>\n");c=board.create("sector",input,attr);return c}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> CircleSector "+attr.name+"<br>\n");return false}break;case"linebisector":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>LineBiSector (Mittelsenkrechte):</b> First: "+input[0].name+"<br>\n");attr.straightFirst=true;attr.straightLast=true;m=board.create("midpoint",input,{visible:"false"});if(JXG.getReference(board,input[0].id).type==1330925652&&JXG.getReference(board,input[1].id).type==1330925652){l=board.create("line",input,{visible:"false"});p=board.create("perpendicular",[m,l],attr)}else{p=board.create("perpendicular",[m,input[0]],attr)}return p[0]}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> LineBiSector (Mittelsenkrechte) "+attr.name+"<br>\n");return false}break;case"ray":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Ray:</b> First: "+input[0].name+"<br>\n");attr.straightFirst=true;attr.straightLast=false;p=board.create("line",[input[1],input[0]],attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Ray "+attr.name+"<br>\n");return false}break;case"tangent":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Tangent:</b> First: "+input[0].name+", Sec.: "+input[1].name+"("+input[1].type+")<br>\n");switch(input[1].type){case 1330923344:input[0].makeGlider(input[1]);t=board.create("tangent",[input[0]],attr);return t;break;case 1330922316:var m=function(circ){return[[circ.midpoint.X()*circ.midpoint.X()+circ.midpoint.Y()*circ.midpoint.Y()-circ.getRadius()*circ.getRadius(),-circ.midpoint.X(),-circ.midpoint.Y()],[-circ.midpoint.X(),1,0],[-circ.midpoint.Y(),0,1]]};var t=board.create("line",[function(){return JXG.Math.matVecMult(m(input[1]),input[0].coords.usrCoords)[0]},function(){return JXG.Math.matVecMult(m(input[1]),input[0].coords.usrCoords)[1]},function(){return JXG.Math.matVecMult(m(input[1]),input[0].coords.usrCoords)[2]}],{visible:false});var i1=board.create("intersection",[input[1],t,0],{visible:false});var i2=board.create("intersection",[input[1],t,1],{visible:false});var t1=board.create("line",[input[0],i1]);var t2=board.create("line",[input[0],i2]);break}}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Tangent "+attr.name+"<br>\n");return false}break;case"circumcirclearc":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>CircumcircleArc:</b> First: "+input[0].name+"<br>\n");p=board.create("circumcircle",input,attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> CircumcircleArc "+attr.name+"<br>\n");return false}break;case"circumcirclesector":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>CircumcircleSector:</b> First: "+input[0].name+"<br>\n");p=board.create("sector",[input[0],input[2],input[1]],attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> CircumcircleSector "+attr.name+"<br>\n");return false}break;case"semicircle":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Semicircle:</b> First: "+input[0].name+"<br>\n");m=board.create("midpoint",input,{visible:"false"});p=board.create("sector",[m,input[0],input[1]],attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Semicircle "+attr.name+"<br>\n");return false}break;case"angle":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Angle:</b> First: "+input[0].name+"<br>\n");p=board.create("angle",input,attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Angle "+attr.name+"<br>\n");return false}break;case"angularbisector":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Angularbisector:</b> First: "+input[0].name+"<br>\n");p=board.create("bisector",input,attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Angularbisector "+attr.name+"<br>\n");return false}break;case"numeric":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);attr=JXG.GeogebraReader.visualProperties(element,attr);if(element.getElementsByTagName("slider").length==1){var sx=parseFloat(element.getElementsByTagName("slider")[0].attributes.x.value);var sy=parseFloat(element.getElementsByTagName("slider")[0].attributes.y.value);if(element.getElementsByTagName("slider")[0].attributes.absoluteScreenLocation&&element.getElementsByTagName("slider")[0].attributes.absoluteScreenLocation.value=="true"){var tmp=new JXG.Coords(JXG.COORDS_BY_SCREEN,[sx,sy],board);sx=tmp.usrCoords[1];sy=tmp.usrCoords[2]}if(element.getElementsByTagName("slider")[0].attributes.horizontal.value=="true"){var len=parseFloat(element.getElementsByTagName("slider")[0].attributes.width.value)/(board.unitX*board.zoomX);var ex=sx+len;var ey=sy}else{var len=parseFloat(element.getElementsByTagName("slider")[0].attributes.width.value)/(board.unitX*board.zoomX);var ex=sx;var ey=sy+len}var sip=parseFloat(element.getElementsByTagName("value")[0].attributes.val.value);var smin=parseFloat(element.getElementsByTagName("slider")[0].attributes.min.value);var smax=parseFloat(element.getElementsByTagName("slider")[0].attributes.max.value);(element.getElementsByTagName("animation")[0])?attr.snapWidth=parseFloat(element.getElementsByTagName("animation")[0].attributes.step.value):false;try{JXG.GeogebraReader.debug("* <b>Numeric:</b> First: "+attr.name+"<br>\n");n=board.create("slider",[[sx,sy],[ex,ey],[smin,sip,smax]],attr);return n}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Numeric "+attr.name+"<br>\n");return false}}break;case"midpoint":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{p=board.create("midpoint",input,attr);JXG.GeogebraReader.debug("* <b>Midpoint ("+p.id+"):</b> "+attr.name+"("+gxtEl.x+", "+gxtEl.y+")<br>\n");return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Midpoint "+attr.name+"<br>\n");return false}break;case"center":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{p=board.create("point",[function(){return JXG.getReference(board,input[0].id).midpoint.X()},function(){return JXG.getReference(board,input[0].id).midpoint.Y()}],attr);JXG.GeogebraReader.debug("* <b>Center ("+p.id+"):</b> "+attr.name+"("+gxtEl.x+", "+gxtEl.y+")<br>\n");return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Center "+attr.name+"<br>\n");return false}break;case"function":if(JXG.GeogebraReader.getElement(attr.name,true)){var func=JXG.GeogebraReader.getElement(attr.name,true).attributes.exp.value;func=JXG.GeogebraReader.functionParse("c",func)}else{var func=input[0];func=JXG.GeogebraReader.functionParse("s",func)}var l=func.length;func[func.length-1]="return "+JXG.GeogebraReader.ggbParse(func[func.length-1])+";";var range=[(input&&input[1])?input[1]:null,(input&&input[2])?input[2]:null];try{if(l==1){f=board.create("functiongraph",[new Function(func[0]),range[0],range[1]],attr)}else{if(l==2){f=board.create("functiongraph",[new Function(func[0],func[1]),range[0],range[1]],attr)}else{if(l==3){f=board.create("functiongraph",[new Function(func[0],func[1],func[2]),range[0],range[1]],attr)}else{if(l==4){f=board.create("functiongraph",[new Function(func[0],func[1],func[2],func[3]),range[0],range[1]],attr)}else{if(l==5){f=board.create("functiongraph",[new Function(func[0],func[1],func[2],func[3],func[4]),range[0],range[1]],attr)}}}}}return f}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Functiongraph "+attr.name+"<br>\n");return false}break;case"polar":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Polar:</b> First: "+input[0].name+", Sec.: "+input[1].name+"<br>\n");var m=function(circ){return[[circ.midpoint.X()*circ.midpoint.X()+circ.midpoint.Y()*circ.midpoint.Y()-circ.getRadius()*circ.getRadius(),-circ.midpoint.X(),-circ.midpoint.Y()],[-circ.midpoint.X(),1,0],[-circ.midpoint.Y(),0,1]]};var p=board.create("line",[function(){return JXG.Math.matVecMult(m(input[1]),input[0].coords.usrCoords)[0]},function(){return JXG.Math.matVecMult(m(input[1]),input[0].coords.usrCoords)[1]},function(){return JXG.Math.matVecMult(m(input[1]),input[0].coords.usrCoords)[2]}],attr);return p}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Polar "+attr.name+"<br>\n");return false}break;case"slope":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);try{JXG.GeogebraReader.debug("* <b>Slope:</b> First: "+input[0].name+"<br>\n");var l1=board.create("segment",[input[0].point1,[(1+input[0].point1.X()),input[0].point1.Y()]],{visible:false});var l2=board.create("normal",[l1,l1.point2],{visible:false});var i=board.create("intersection",[input[0],l2,0],{visible:false});var m=board.create("midpoint",[l1.point2,i],{visible:false});var slope=function(){return i.Y()-l1.point1.Y()};var t=board.create("text",[function(){return m.X()},function(){return m.Y()},function(){return"m = "+function(){return i.Y()-l1.point1.Y()}()}]);return m}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Slope "+attr.name+"<br>\n");return false}break;case"text":attr=JXG.GeogebraReader.boardProperties(gxtEl,element,attr);attr=JXG.GeogebraReader.colorProperties(element,attr);gxtEl=JXG.GeogebraReader.coordinates(gxtEl,element);attr=JXG.GeogebraReader.visualProperties(element,attr);var text=JXG.GeogebraReader.ggbParse(JXG.GeogebraReader.getElement(attr.name,true).attributes.exp.value);try{JXG.GeogebraReader.debug("* <b>Text:</b> "+text+"<br>\n");var tmp=new JXG.Coords(JXG.COORDS_BY_SCREEN,[gxtEl.x,gxtEl.y],JXG.GeogebraReader.board);var sx=tmp.usrCoords[1];var sy=tmp.usrCoords[2];var t=board.create("text",[sx,sy,text[0]+" "+new Function("return "+text[1]+";")()]);return t}catch(e){JXG.GeogebraReader.debug("* <b>Err:</b> Text: "+text+"<br>\n");return false}break;default:return false;break}};this.readGeogebra=function(tree,board){var el,Data,i;var els=[];board.ggbElements=[];JXG.GeogebraReader.tree=tree;JXG.GeogebraReader.board=board;JXG.GeogebraReader.format=parseFloat(JXG.GeogebraReader.tree.getElementsByTagName("geogebra")[0].attributes.format.value);JXG.GeogebraReader.writeBoard(board);var constructions=JXG.GeogebraReader.tree.getElementsByTagName("construction");for(var t=0;t<constructions.length;t++){var cmds=constructions[t].getElementsByTagName("command");for(var s=0;s<cmds.length;s++){Data=cmds[s];var input=[];for(i=0;i<Data.getElementsByTagName("input")[0].attributes.length;i++){el=Data.getElementsByTagName("input")[0].attributes[i].value;if(el.match(//)||!el.match(/\D/)||el.match(/Circle/)||Data.attributes.name.value=="Function"){input[i]=el}else{if(typeof board.ggbElements[el]=="undefined"||board.ggbElements[el]==""){var elnode=JXG.GeogebraReader.getElement(el);board.ggbElements[el]=JXG.GeogebraReader.writeElement(board,elnode);JXG.GeogebraReader.debug("regged: "+board.ggbElements[el]+"<br/>")}input[i]=board.ggbElements[el]}}var output=[],elname=Data.getElementsByTagName("output")[0].attributes[0].value;for(i=0;i<Data.getElementsByTagName("output")[0].attributes.length;i++){el=Data.getElementsByTagName("output")[0].attributes[i].value;output[i]=JXG.GeogebraReader.getElement(el)}if(typeof board.ggbElements[elname]=="undefined"||board.ggbElements[elname]==""){board.ggbElements[elname]=JXG.GeogebraReader.writeElement(board,output,input,Data.attributes.name.value.toLowerCase());JXG.GeogebraReader.debug("regged: "+board.ggbElements[elname].id+"<br/>");if(board.ggbElements[elname].borders){for(var i=0;i<board.ggbElements[elname].borders.length;i++){board.ggbElements[board.ggbElements[elname].borders[i].name]=board.ggbElements[elname].borders[i];JXG.GeogebraReader.debug(i+") regged: "+board.ggbElements[elname].borders[i].name+"("+board.ggbElements[board.ggbElements[elname].borders[i].name].id+")<br/>")}}}}var elements=constructions[t].getElementsByTagName("element");for(var s=0;s<elements.length;s++){var Data=elements[s];var el=Data.attributes.label.value;if(typeof board.ggbElements[el]=="undefined"||board.ggbElements[el]==""){JXG.GeogebraReader.debug("Betrachte Rest: "+el);board.ggbElements[el]=JXG.GeogebraReader.writeElement(board,Data);if(expr=JXG.GeogebraReader.getElement(el,true)){var type=Data.attributes.type.value;switch(type){case"text":case"function":break;default:JXG.GeogebraReader.ggbParse(expr.attributes.exp.value,el);break}}}}}board.fullUpdate();delete (board.ggbElements)};this.utf8=function(utftext){var string=[];var i=0;var c=0,c1=0,c2=0;while(i<utftext.length){c=utftext.charCodeAt(i);if(c<128){string.push(String.fromCharCode(c));i++}else{if((c>191)&&(c<224)){c2=utftext.charCodeAt(i+1);string.push(String.fromCharCode(((c&31)<<6)|(c2&63)));i+=2}else{c2=utftext.charCodeAt(i+1);c3=utftext.charCodeAt(i+2);string.push(String.fromCharCode(((c&15)<<12)|((c2&63)<<6)|(c3&63)));i+=3}}}return string.join("")};this.prepareString=function(fileStr){if(fileStr.indexOf("<")!=0){bA=[];for(i=0;i<fileStr.length;i++){bA[i]=JXG.Util.asciiCharCodeAt(fileStr,i)}fileStr=(new JXG.Util.Unzip(bA)).unzipFile("geogebra.xml")}fileStr=JXG.GeogebraReader.utf8(fileStr);return fileStr}};JXG.GeonextReader=new function(){this.changeOriginIds=function(a,b){if((b=="gOOe0")||(b=="gXOe0")||(b=="gYOe0")||(b=="gXLe0")||(b=="gYLe0")){return a.id+b}else{return b}};this.colorProperties=function(b,a){b.colorStroke=a.getElementsByTagName("color")[0].getElementsByTagName("stroke")[0].firstChild.data;b.highlightStrokeColor=a.getElementsByTagName("color")[0].getElementsByTagName("lighting")[0].firstChild.data;b.colorFill=a.getElementsByTagName("color")[0].getElementsByTagName("fill")[0].firstChild.data;b.colorLabel=a.getElementsByTagName("color")[0].getElementsByTagName("label")[0].firstChild.data;b.colorDraft=a.getElementsByTagName("color")[0].getElementsByTagName("draft")[0].firstChild.data;return b};this.firstLevelProperties=function(g,d){var a=d.childNodes,e,b;for(e=0;e<a.length;e++){if(a[e].firstChild!=null&&a[e].nodeName!="data"&&a[e].nodeName!="straight"){b=a[e].nodeName;g[b]=a[e].firstChild.data}}return g};this.boardProperties=function(b,a){return b};this.defProperties=function(b,a){if(a.nodeType==3||a.nodeType==8){return null}b.ident=a.nodeName;if(b.ident=="text"||b.ident=="intersection"||b.ident=="composition"){b.name=""}else{b.name=a.getElementsByTagName("name")[0].firstChild.data}b.id=a.getElementsByTagName("id")[0].firstChild.data;return b};this.visualProperties=function(b,a){b.visible=a.getElementsByTagName("visible")[0].firstChild.data;b.trace=a.getElementsByTagName("trace")[0].firstChild.data;return b};this.readNodes=function(k,e,b,g){var a=e.getElementsByTagName(b)[0].childNodes,d,h;for(h=0;h<a.length;h++){if(a[h].firstChild!=null){if(g!=null){d=g+JXG.capitalize(a[h].nodeName)}else{d=a[h].nodeName}k[d]=a[h].firstChild.data}}return k};this.subtreeToString=function(a){try{return(new XMLSerializer()).serializeToString(a)}catch(b){return a.xml}return null};this.readImage=function(d){var b="",a=d;if(a!=null){b=a.data;while(a.nextSibling!=null){a=a.nextSibling;b+=a.data}}return b};this.parseImage=function(m,l,a,u,s,z,k,e){var C,B,A,d,q,g,b;if(l==null){return null}if(l.getElementsByTagName("src")[0]!=null){C="src"}else{if(l.getElementsByTagName("image")[0]!=null){C="image"}else{return null}}b="data:image/png;base64,"+this.readImage(l.getElementsByTagName(C)[0].firstChild);if(b!=""){if(C=="src"){u=l.getElementsByTagName("x")[0].firstChild.data;s=l.getElementsByTagName("y")[0].firstChild.data;z=l.getElementsByTagName("width")[0].firstChild.data;k=l.getElementsByTagName("height")[0].firstChild.data}else{g=document.createElement("img");g.setAttribute("id","tmpimg");g.style.display="none";document.getElementsByTagName("body")[0].appendChild(g);g.setAttribute("src",b);B=g.width;A=g.height;B=(B==0)?3:B;A=(A==0)?3:A;s-=A*z/B*0.5;k=A*z/B;document.getElementsByTagName("body")[0].removeChild(g)}if(e!=null){d=e.id+"_image"}else{d=false}q=new JXG.Image(m,b,[u,s],[z,k],a,d,false,e);return q}};this.readConditions=function(h,g){var b,d,k,a;g.conditions="";if(h!=null){for(b=0;b<h.getElementsByTagName("data").length;b++){a=h.getElementsByTagName("data")[b];d=JXG.GeonextReader.subtreeToString(a);g.conditions+=d}}};this.printDebugMessage=function(a,e,d,b){};this.readGeonext=function(z,q){var w={},A,D,C,m,E,B,b,h,e,d,a,k,g,u,l;boardData=z.getElementsByTagName("board")[0];w.ident="board";w.id=boardData.getElementsByTagName("id")[0].firstChild.data;w.width=boardData.getElementsByTagName("width")[0].firstChild.data;w.height=boardData.getElementsByTagName("height")[0].firstChild.data;h=boardData.getElementsByTagName("fontsize")[0];w.fontSize=(h!=null)?document.body.style.fontSize=h.firstChild.data:document.body.style.fontSize;w.modus=boardData.getElementsByTagName("modus")[0].firstChild.data;h=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("origin")[0];w.originX=h.getElementsByTagName("x")[0].firstChild.data;w.originY=h.getElementsByTagName("y")[0].firstChild.data;h=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("zoom")[0];w.zoomX=h.getElementsByTagName("x")[0].firstChild.data;w.zoomY=h.getElementsByTagName("y")[0].firstChild.data;h=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("unit")[0];w.unitX=h.getElementsByTagName("x")[0].firstChild.data;w.unitY=h.getElementsByTagName("y")[0].firstChild.data;h=boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("viewport")[0];w.viewportTop=h.getElementsByTagName("top")[0].firstChild.data;w.viewportLeft=h.getElementsByTagName("left")[0].firstChild.data;w.viewportBottom=h.getElementsByTagName("bottom")[0].firstChild.data;w.viewportRight=h.getElementsByTagName("right")[0].firstChild.data;this.readConditions(boardData.getElementsByTagName("conditions")[0],w);q.origin={};q.origin.usrCoords=[1,0,0];q.origin.scrCoords=[1,1*w.originX,1*w.originY];q.zoomX=1*w.zoomX;q.zoomY=1*w.zoomY;q.unitX=1*w.unitX;q.unitY=1*w.unitY;q.stretchX=q.zoomX*q.unitX;q.stretchY=q.zoomY*q.unitY;if(q.options.takeSizeFromFile){q.resizeContainer(w.width,w.height)}if(1*w.fontSize!=0){q.fontSize=1*w.fontSize}else{q.fontSize=12}q.geonextCompatibilityMode=true;delete (JXG.JSXGraph.boards[q.id]);q.id=w.id;JXG.JSXGraph.boards[q.id]=q;q.initGeonextBoard();q.renderer.enhancedRendering=true;JXG.GeonextReader.parseImage(q,boardData.getElementsByTagName("file")[0],"images");A=(boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("snap")[0].firstChild.data=="true")?q.snapToGrid=true:null;D=(boardData.getElementsByTagName("grid")[1].getElementsByTagName("x")[0].firstChild.data)?q.gridX=boardData.getElementsByTagName("grid")[1].getElementsByTagName("x")[0].firstChild.data*1:null;C=(boardData.getElementsByTagName("grid")[1].getElementsByTagName("y")[0].firstChild.data)?q.gridY=boardData.getElementsByTagName("grid")[1].getElementsByTagName("y")[0].firstChild.data*1:null;q.calculateSnapSizes();m=boardData.getElementsByTagName("grid")[1].getElementsByTagName("dash")[0].firstChild.data;q.gridDash=q.algebra.str2Bool(m);E=boardData.getElementsByTagName("grid")[1].getElementsByTagName("color")[0].firstChild.data;if(E.length=="9"&&E.substr(0,1)=="#"){B=E.substr(7,2);B=parseInt(B.toUpperCase(),16)/255;E=E.substr(0,7)}else{B="1"}q.gridColor=E;q.gridOpacity=B;b=(boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("grid")[0].firstChild.data=="true")?q.renderer.drawGrid(q):null;if(boardData.getElementsByTagName("coordinates")[0].getElementsByTagName("coord")[0].firstChild.data=="true"){e=q.createElement("axis",[[0,0],[1,0]]);e.setProperty("strokeColor:"+e.visProp.strokeColor,"strokeWidth:"+e.visProp.strokeWidth,"fillColor:none","highlightStrokeColor:"+e.visProp.highlightStrokeColor,"highlightFillColor:none","visible:true");d=q.createElement("axis",[[0,0],[0,1]]);d.setProperty("strokeColor:"+d.visProp.strokeColor,"strokeWidth:"+d.visProp.strokeWidth,"fillColor:none","highlightStrokeColor:"+d.visProp.highlightStrokeColor,"highlightFillColor:none","visible:true")}a=boardData.getElementsByTagName("background")[0].getElementsByTagName("color")[0].firstChild.data;k=1;if(a.length=="9"&&a.substr(0,1)=="#"){k=a.substr(7,2);a=a.substr(0,7)}q.containerObj.style.backgroundColor=a;g=z.getElementsByTagName("elements")[0].childNodes;for(u=0;u<g.length;u++){(function(Y){var af,ah={},ac,U,S,W,ag,al,K,I,am,P=[],an=[],ai=[],ak=[],J=[],G=[],ae=[],ad=[],T=[],X=[],R=[],F,N,V,H,ab,Z,O,L,Q,aa;l=g[Y];ah=JXG.GeonextReader.defProperties(ah,l);if(ah==null){return}switch(l.nodeName.toLowerCase()){case"point":ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah=JXG.GeonextReader.readNodes(ah,l,"data");ah.fixed=l.getElementsByTagName("fix")[0].firstChild.data;JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"points");try{aa=new JXG.Point(q,[1*ah.x,1*ah.y],ah.id,ah.name,true);aa.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorStroke,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.highlightStrokeColor,"labelColor:"+ah.colorLabel,"visible:"+ah.visible,"fixed:"+ah.fixed,"draft:"+ah.draft);aa.setStyle(1*ah.style);aa.traced=(ah.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK")}catch(aj){alert(aj)}break;case"line":ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah=JXG.GeonextReader.readNodes(ah,l,"data");ah=JXG.GeonextReader.readNodes(ah,l,"straight","straight");ah.first=JXG.GeonextReader.changeOriginIds(q,ah.first);ah.last=JXG.GeonextReader.changeOriginIds(q,ah.last);ac=new JXG.Line(q,ah.first,ah.last,ah.id,ah.name);U=ac.point1.coords.usrCoords[1];S=ac.point1.coords.usrCoords[2];W=ac.point1.coords.distance(JXG.COORDS_BY_USER,ac.point2.coords);ag=0;ac.image=JXG.GeonextReader.parseImage(q,l,"lines",U,S,W,ag,ac);ah.straightFirst=(ah.straightFirst=="false")?false:true;ah.straightLast=(ah.straightLast=="false")?false:true;ac.setStraight(ah.straightFirst,ah.straightLast);ac.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorFill,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.colorFill,"labelColor:"+ah.colorLabel,"visible:"+ah.visible,"dash:"+ah.dash,"draft:"+ah.draft);ac.traced=(ah.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"circle":ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah.midpoint=l.getElementsByTagName("data")[0].getElementsByTagName("midpoint")[0].firstChild.data;JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"circles");if(l.getElementsByTagName("data")[0].getElementsByTagName("radius").length>0){ah.radiuspoint=l.getElementsByTagName("data")[0].getElementsByTagName("radius")[0].firstChild.data;ah.radius=null;ah.method="twoPoints"}else{if(l.getElementsByTagName("data")[0].getElementsByTagName("radiusvalue").length>0){ah.radiuspoint=null;ah.radius=l.getElementsByTagName("data")[0].getElementsByTagName("radiusvalue")[0].firstChild.data;ah.radiusnum=l.getElementsByTagName("data")[0].getElementsByTagName("radiusnum")[0].firstChild.data;ah.method="pointRadius"}}if(ah.method=="twoPoints"){if(q.objects[ah.radiuspoint].type==JXG.OBJECT_TYPE_LINE){ah.method="pointLine";ah.radiuspoint=JXG.GeonextReader.changeOriginIds(q,ah.radiuspoint)}else{if(q.objects[ah.radiuspoint].type==JXG.OBJECT_TYPE_CIRCLE){ah.method="pointCircle"}}}if(ah.method=="pointRadius"){ah.midpoint=JXG.GeonextReader.changeOriginIds(q,ah.midpoint);al=new JXG.Circle(q,ah.method,ah.midpoint,ah.radius,ah.id,ah.name)}else{ah.midpoint=JXG.GeonextReader.changeOriginIds(q,ah.midpoint);al=new JXG.Circle(q,ah.method,ah.midpoint,ah.radiuspoint,ah.id,ah.name)}al.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorFill,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.colorFill,"visible:"+ah.visible,"labelColor:"+ah.colorLabel,"dash:"+ah.dash,"draft:"+ah.draft);al.traced=(ah.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"slider":ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah=JXG.GeonextReader.readNodes(ah,l,"data");ah.fixed=l.getElementsByTagName("fix")[0].firstChild.data;ah=JXG.GeonextReader.readNodes(ah,l,"animate","animate");JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"points");try{aa=new JXG.Point(q,[1*ah.x,1*ah.y],ah.id,ah.name,true);ah.parent=JXG.GeonextReader.changeOriginIds(q,ah.parent);aa.makeGlider(ah.parent);aa.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorStroke,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.highlightStrokeColor,"visible:"+ah.visible,"fixed:"+ah.fixed,"labelColor:"+ah.colorLabel,"draft:"+ah.draft);aa.onPolygon=q.algebra.str2Bool(ah.onpolygon);aa.traced=(ah.trace=="false")?false:true;aa.setStyle(1*ah.style);JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK")}catch(aj){}break;case"cas":ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah.fixed=l.getElementsByTagName("fix")[0].firstChild.data;ah=JXG.GeonextReader.readNodes(ah,l,"data");JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"points");aa=new JXG.Point(q,[1*ah.xval,1*ah.yval],ah.id,ah.name,true);aa.addConstraint([ah.x,ah.y]);aa.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorStroke,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.highlightStrokeColor,"visible:"+ah.visible,"fixed:"+ah.fixed,"labelColor:"+ah.colorLabel,"draft:"+ah.draft);aa.traced=(ah.trace=="false")?false:true;aa.setStyle(1*ah.style);JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"intersection":ah=JXG.GeonextReader.readNodes(ah,l,"data");h=l.getElementsByTagName("first")[1];ah.outputFirstId=h.getElementsByTagName("id")[0].firstChild.data;ah.outputFirstName=h.getElementsByTagName("name")[0].firstChild.data;ah.outputFirstVisible=h.getElementsByTagName("visible")[0].firstChild.data;ah.outputFirstTrace=h.getElementsByTagName("trace")[0].firstChild.data;ah.outputFirstFixed=h.getElementsByTagName("fix")[0].firstChild.data;ah.outputFirstStyle=h.getElementsByTagName("style")[0].firstChild.data;ah.outputFirstStrokewidth=h.getElementsByTagName("strokewidth")[0].firstChild.data;h=l.getElementsByTagName("first")[1].getElementsByTagName("color")[0];ah.outputFirstColorStroke=h.getElementsByTagName("stroke")[0].firstChild.data;ah.outputFirstHighlightStrokeColor=h.getElementsByTagName("lighting")[0].firstChild.data;ah.outputFirstColorFill=h.getElementsByTagName("fill")[0].firstChild.data;ah.outputFirstColorLabel=h.getElementsByTagName("label")[0].firstChild.data;ah.outputFirstColorDraft=h.getElementsByTagName("draft")[0].firstChild.data;ah.first=JXG.GeonextReader.changeOriginIds(q,ah.first);ah.last=JXG.GeonextReader.changeOriginIds(q,ah.last);if((((q.objects[ah.first]).type==(q.objects[ah.last]).type)&&((q.objects[ah.first]).type==JXG.OBJECT_TYPE_LINE||(q.objects[ah.first]).type==JXG.OBJECT_TYPE_ARROW))||(((q.objects[ah.first]).type==JXG.OBJECT_TYPE_LINE)&&((q.objects[ah.last]).type==JXG.OBJECT_TYPE_ARROW))||(((q.objects[ah.last]).type==JXG.OBJECT_TYPE_LINE)&&((q.objects[ah.first]).type==JXG.OBJECT_TYPE_ARROW))){inter=new JXG.Intersection(q,ah.id,q.objects[ah.first],q.objects[ah.last],ah.outputFirstId,"",ah.outputFirstName,"");if(ah.outputFirstVisible=="false"){inter.hideElement()}inter.p.setProperty("strokeColor:"+ah.outputFirstColorStroke,"strokeWidth:"+ah.outputFirstStrokewidth,"fillColor:"+ah.outputFirstColorStroke,"highlightStrokeColor:"+ah.outputFirstHighlightStrokeColor,"highlightFillColor:"+ah.outputFirstHighlightStrokeColor,"visible:"+ah.outputFirstVisible,"labelColor:"+ah.outputFirstColorLabel,"draft:"+ah.draft);inter.p.setStyle(1*ah.outputFirstStyle);inter.p.traced=(ah.outputFirstTrace=="false")?false:true}else{h=l.getElementsByTagName("last")[1];ah.outputLastId=h.getElementsByTagName("id")[0].firstChild.data;ah.outputLastName=h.getElementsByTagName("name")[0].firstChild.data;ah.outputLastVisible=h.getElementsByTagName("visible")[0].firstChild.data;ah.outputLastTrace=h.getElementsByTagName("trace")[0].firstChild.data;ah.outputLastFixed=h.getElementsByTagName("fix")[0].firstChild.data;ah.outputLastStyle=h.getElementsByTagName("style")[0].firstChild.data;ah.outputLastStrokewidth=h.getElementsByTagName("strokewidth")[0].firstChild.data;h=l.getElementsByTagName("last")[1].getElementsByTagName("color")[0];ah.outputLastColorStroke=h.getElementsByTagName("stroke")[0].firstChild.data;ah.outputLastHighlightStrokeColor=h.getElementsByTagName("lighting")[0].firstChild.data;ah.outputLastColorFill=h.getElementsByTagName("fill")[0].firstChild.data;ah.outputLastColorLabel=h.getElementsByTagName("label")[0].firstChild.data;ah.outputLastColorDraft=h.getElementsByTagName("draft")[0].firstChild.data;inter=new JXG.Intersection(q,ah.id,q.objects[ah.first],q.objects[ah.last],ah.outputFirstId,ah.outputLastId,ah.outputFirstName,ah.outputLastName);inter.p1.setProperty("strokeColor:"+ah.outputFirstColorStroke,"strokeWidth:"+ah.outputFirstStrokewidth,"fillColor:"+ah.outputFirstColorStroke,"highlightStrokeColor:"+ah.outputFirstHighlightStrokeColor,"highlightFillColor:"+ah.outputFirstHighlightStrokeColor,"visible:"+ah.outputFirstVisible,"labelColor:"+ah.outputFirstColorLabel,"draft:"+ah.draft);inter.p1.setStyle(1*ah.outputFirstStyle);inter.p1.traced=(ah.outputFirstTrace=="false")?false:true;inter.p2.setProperty("strokeColor:"+ah.outputLastColorStroke,"strokeWidth:"+ah.outputLastStrokewidth,"fillColor:"+ah.outputLastColorStroke,"highlightStrokeColor:"+ah.outputLastHighlightStrokeColor,"highlightFillColor:"+ah.outputLastHighlightStrokeColor,"visible:"+ah.outputLastVisible,"labelColor:"+ah.outputLastColorLabel,"draft:"+ah.draft);inter.p2.setStyle(1*ah.outputLastStyle);inter.p2.traced=(ah.outputLastTrace=="false")?false:true;if(ah.outputFirstVisible=="false"){if(ah.outputLastVisible=="false"){inter.hideElement()}else{inter.p1.hideElement()}}else{if(ah.outputLastVisible=="false"){inter.p2.hideElement()}}}JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"composition":ah=JXG.GeonextReader.readNodes(ah,l,"data");ah=JXG.GeonextReader.firstLevelProperties(ah,l);switch(ah.type){case"210070":ah.typeName="ARROW_PARALLEL";break;case"210080":ah.typeName="BISECTOR";break;case"210090":ah.typeName="CIRCUMCIRCLE";break;case"210100":ah.typeName="CIRCUMCIRCLE_CENTER";break;case"210110":ah.typeName="MIDPOINT";break;case"210120":ah.typeName="MIRROR_LINE";break;case"210125":ah.typeName="MIRROR_POINT";break;case"210130":ah.typeName="NORMAL";break;case"210140":ah.typeName="PARALLEL";break;case"210150":ah.typeName="PARALLELOGRAM_POINT";break;case"210160":ah.typeName="PERPENDICULAR";break;case"210170":ah.typeName="PERPENDICULAR_POINT";break;case"210180":ah.typeName="ROTATION";break;case"210190":ah.typeName="SECTOR";break}ah.defEl=[];K=0;h=l.getElementsByTagName("data")[0].getElementsByTagName("input");for(af=0;af<h.length;af++){ah.defEl[af]=h[af].firstChild.data;K=af+1}h=l.getElementsByTagName("output")[0];ah.outputId=h.getElementsByTagName("id")[0].firstChild.data;ah.outputName=h.getElementsByTagName("name")[0].firstChild.data;ah.outputVisible=h.getElementsByTagName("visible")[0].firstChild.data;ah.outputTrace=h.getElementsByTagName("trace")[0].firstChild.data;ah=JXG.GeonextReader.readNodes(ah,l,"output","output");ah.outputName=h.getElementsByTagName("name")[0].firstChild.data;ah.outputDash=h.getElementsByTagName("dash")[0].firstChild.data;ah.outputDraft=h.getElementsByTagName("draft")[0].firstChild.data;ah.outputStrokewidth=h.getElementsByTagName("strokewidth")[0].firstChild.data;h=l.getElementsByTagName("output")[0].getElementsByTagName("color")[0];ah.outputColorStroke=h.getElementsByTagName("stroke")[0].firstChild.data;ah.outputHighlightStrokeColor=h.getElementsByTagName("lighting")[0].firstChild.data;ah.outputColorFill=h.getElementsByTagName("fill")[0].firstChild.data;ah.outputColorLabel=h.getElementsByTagName("label")[0].firstChild.data;ah.outputColorDraft=h.getElementsByTagName("draft")[0].firstChild.data;ah.defEl[0]=JXG.GeonextReader.changeOriginIds(q,ah.defEl[0]);ah.defEl[1]=JXG.GeonextReader.changeOriginIds(q,ah.defEl[1]);ah.defEl[2]=JXG.GeonextReader.changeOriginIds(q,ah.defEl[2]);if(ah.typeName=="MIDPOINT"){if(K==2){q.createElement("midpoint",[ah.defEl[0],ah.defEl[1]],{name:ah.outputName,id:ah.outputId})}else{if(K==1){q.createElement("midpoint",[ah.defEl[0]],{name:ah.outputName,id:ah.outputId})}}}else{if(ah.typeName=="NORMAL"){q.addNormal(ah.defEl[1],ah.defEl[0],ah.outputId,ah.outputName)}else{if(ah.typeName=="PARALLEL"){q.createElement("parallel",[ah.defEl[1],ah.defEl[0]],{id:ah.outputId,name:ah.outputName})}else{if(ah.typeName=="CIRCUMCIRCLE"){I=l.getElementsByTagName("output")[1].getElementsByTagName("id")[0].firstChild.data;am=l.getElementsByTagName("output")[1].getElementsByTagName("name")[0].firstChild.data;q.createElement("circumcircle",[ah.defEl[0],ah.defEl[1],ah.defEl[2]],{name:[ah.outputName,am],id:[ah.outputId,I]})}else{if(ah.typeName=="CIRCUMCIRCLE_CENTER"){q.createElement("circumcirclemidpoint",[ah.defEl[0],ah.defEl[1],ah.defEl[2]],{id:ah.outputId,name:ah.outputName})}else{if(ah.typeName=="BISECTOR"){q.createElement("bisector",[ah.defEl[0],ah.defEl[1],ah.defEl[2]],{id:ah.outputId,name:ah.outputName})}else{if(ah.typeName=="MIRROR_LINE"){q.createElement("reflection",[ah.defEl[1],ah.defEl[0]],{id:ah.outputId,name:ah.outputName})}else{if(ah.typeName=="MIRROR_POINT"){q.createElement("mirrorpoint",[ah.defEl[0],ah.defEl[1]],{name:ah.outputName,id:ah.outputId})}else{if(ah.typeName=="PARALLELOGRAM_POINT"){if(ah.defEl.length==2){q.createElement("parallelpoint",[JXG.getReference(ah.defEl[0]).point1,JXG.getReference(ah.defEl[0]).point2,ah.defEl[1]],{id:ah.outputId,name:ah.outputName})}else{q.createElement("parallelpoint",[ah.defEl[0],ah.defEl[1],ah.defEl[2]],{id:ah.outputId,name:ah.outputName})}}else{if(ah.typeName=="SECTOR"){JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"sectors");for(af=0;af<l.getElementsByTagName("output").length;af++){h=l.getElementsByTagName("output")[af];P[af]=h.getElementsByTagName("id")[0].firstChild.data;P[af]=JXG.GeonextReader.changeOriginIds(q,P[af]);an[af]=h.getElementsByTagName("name")[0];ai[af]=h.getElementsByTagName("visible")[0].firstChild.data;ak[af]=h.getElementsByTagName("trace")[0].firstChild.data;J[af]=h.getElementsByTagName("dash")[0].firstChild.data;G[af]=h.getElementsByTagName("draft")[0].firstChild.data;ae[af]=h.getElementsByTagName("strokewidth")[0].firstChild.data;h=l.getElementsByTagName("output")[af].getElementsByTagName("color")[0];ad[af]=h.getElementsByTagName("stroke")[0].firstChild.data;T[af]=h.getElementsByTagName("lighting")[0].firstChild.data;X[af]=h.getElementsByTagName("fill")[0].firstChild.data;R[af]=h.getElementsByTagName("label")[0].firstChild.data}F=new JXG.Sector(q,ah.defEl[0],ah.defEl[1],ah.defEl[2],[P[0],P[1],P[2],P[3]],[an[0].firstChild.data,an[1].firstChild.data,an[2].firstChild.data,an[3].firstChild.data],ah.id);N=P[0];q.objects[N].setProperty("strokeColor:"+ad[0],"strokeWidth:"+ae[0],"fillColor:"+X[0],"highlightStrokeColor:"+T[0],"highlightFillColor:"+X[0],"visible:"+ai[0],"dash:"+J[0],"draft:"+G[0]);q.objects[N].traced=(ak[0]=="false")?false:true;ah.firstArrow=l.getElementsByTagName("output")[0].getElementsByTagName("firstarrow")[0].firstChild.data;ah.lastArrow=l.getElementsByTagName("output")[0].getElementsByTagName("lastarrow")[0].firstChild.data;ah.firstArrow=(ah.firstArrow=="false")?false:true;ah.lastArrow=(ah.lastArrow=="false")?false:true;q.objects[N].setArrow(ah.firstArrow,ah.lastArrow);V=P[1];ah.fixed=l.getElementsByTagName("output")[1].getElementsByTagName("fix")[0].firstChild.data;q.objects[V].setProperty("strokeColor:"+ad[1],"strokeWidth:"+ae[1],"fillColor:"+ad[1],"highlightStrokeColor:"+T[1],"highlightFillColor:"+T[1],"visible:"+ai[1],"fixed:"+ah.fixed,"labelColor:"+R[1],"draft:"+G[1]);ah.style=l.getElementsByTagName("output")[1].getElementsByTagName("style")[0].firstChild.data;q.objects[V].setStyle(1*ah.style);q.objects[V].traced=(ak[1]=="false")?false:true;H=P[2];h=l.getElementsByTagName("output")[2].getElementsByTagName("straight")[0];ah.straightFirst=h.getElementsByTagName("first")[0].firstChild.data;ah.straightLast=h.getElementsByTagName("last")[0].firstChild.data;ah.straightFirst=(ah.straightFirst=="false")?false:true;ah.straightLast=(ah.straightLast=="false")?false:true;q.objects[H].setStraight(ah.straightFirst,ah.straightLast);q.objects[H].setProperty("strokeColor:"+ad[2],"strokeWidth:"+ae[2],"fillColor:"+X[2],"highlightStrokeColor:"+T[2],"highlightFillColor:"+X[2],"visible:"+ai[2],"dash:"+J[2],"draft:"+G[2]);q.objects[H].traced=(ak[2]=="false")?false:true;ab=P[3];h=l.getElementsByTagName("output")[3].getElementsByTagName("straight")[0];ah.straightFirst=h.getElementsByTagName("first")[0].firstChild.data;ah.straightLast=h.getElementsByTagName("last")[0].firstChild.data;ah.straightFirst=(ah.straightFirst=="false")?false:true;ah.straightLast=(ah.straightLast=="false")?false:true;q.objects[ab].setStraight(ah.straightFirst,ah.straightLast);q.objects[ab].setProperty("strokeColor:"+ad[3],"strokeWidth:"+ae[3],"fillColor:"+X[3],"highlightStrokeColor:"+T[3],"highlightFillColor:"+X[3],"visible:"+ai[3],"dash:"+J[3],"draft:"+G[3]);q.objects[ab].traced=(ak[3]=="false")?false:true}else{if(ah.typeName=="PERPENDICULAR"){for(af=0;af<l.getElementsByTagName("output").length;af++){h=l.getElementsByTagName("output")[af];P[af]=h.getElementsByTagName("id")[0].firstChild.data;P[af]=JXG.GeonextReader.changeOriginIds(q,P[af]);an[af]=h.getElementsByTagName("name")[0];ai[af]=h.getElementsByTagName("visible")[0].firstChild.data;ak[af]=h.getElementsByTagName("trace")[0].firstChild.data;J[af]=h.getElementsByTagName("dash")[0].firstChild.data;G[af]=h.getElementsByTagName("draft")[0].firstChild.data;ae[af]=h.getElementsByTagName("strokewidth")[0].firstChild.data;h=l.getElementsByTagName("output")[af].getElementsByTagName("color")[0];ad[af]=h.getElementsByTagName("stroke")[0].firstChild.data;T[af]=h.getElementsByTagName("lighting")[0].firstChild.data;X[af]=h.getElementsByTagName("fill")[0].firstChild.data;R[af]=h.getElementsByTagName("label")[0].firstChild.data}ah.outputFixed=l.getElementsByTagName("output")[0].getElementsByTagName("fix")[0].firstChild.data;ah.outputStyle=l.getElementsByTagName("output")[0].getElementsByTagName("style")[0].firstChild.data;q.createElement("perpendicular",[ah.defEl[1],ah.defEl[0]],{name:[an[1].firstChild.data,an[0].firstChild.data],id:[P[1],P[0]]});Z=P[0];q.objects[Z].setProperty("strokeColor:"+ad[0],"strokeWidth:"+ae[0],"fillColor:"+ad[0],"highlightStrokeColor:"+T[0],"highlightFillColor:"+T[0],"visible:"+ai[0],"fixed:"+ah.outputFixed,"labelColor:"+R[0],"draft:"+G[0]);q.objects[Z].setStyle(1*ah.outputStyle);q.objects[Z].traced=(ak[0]=="false")?false:true;O=P[1];q.objects[O].setProperty("strokeColor:"+ad[1],"strokeWidth:"+ae[1],"fillColor:"+X[1],"highlightStrokeColor:"+T[1],"highlightFillColor:"+X[1],"visible:"+ai[1],"dash:"+J[1],"draft:"+G[1]);q.objects[O].traced=(ak[1]=="false")?false:true}else{if(ah.typeName=="ARROW_PARALLEL"){for(af=0;af<l.getElementsByTagName("output").length;af++){h=l.getElementsByTagName("output")[af];P[af]=h.getElementsByTagName("id")[0].firstChild.data;P[af]=JXG.GeonextReader.changeOriginIds(q,P[af]);an[af]=h.getElementsByTagName("name")[0];ai[af]=h.getElementsByTagName("visible")[0].firstChild.data;ak[af]=h.getElementsByTagName("trace")[0].firstChild.data;J[af]=h.getElementsByTagName("dash")[0].firstChild.data;G[af]=h.getElementsByTagName("draft")[0].firstChild.data;ae[af]=h.getElementsByTagName("strokewidth")[0].firstChild.data;h=l.getElementsByTagName("output")[af].getElementsByTagName("color")[0];ad[af]=h.getElementsByTagName("stroke")[0].firstChild.data;T[af]=h.getElementsByTagName("lighting")[0].firstChild.data;X[af]=h.getElementsByTagName("fill")[0].firstChild.data;R[af]=h.getElementsByTagName("label")[0].firstChild.data}ah.outputFixed=l.getElementsByTagName("output")[1].getElementsByTagName("fix")[0].firstChild.data;ah.outputStyle=l.getElementsByTagName("output")[1].getElementsByTagName("style")[0].firstChild.data;q.createElement("arrowparallel",[ah.defEl[1],ah.defEl[0]],{id:[P[0],P[1]],name:[an[0].firstChild.data,an[1].firstChild.data]});L=P[0];q.objects[L].setProperty("strokeColor:"+ad[0],"strokeWidth:"+ae[0],"fillColor:"+X[0],"highlightStrokeColor:"+T[0],"highlightFillColor:"+X[0],"visible:"+ai[0],"dash:"+J[0],"draft:"+G[0]);q.objects[L].traced=(ak[0]=="false")?false:true;Z=P[1];q.objects[Z].setProperty("strokeColor:"+ad[1],"strokeWidth:"+ae[1],"fillColor:"+ad[1],"highlightStrokeColor:"+T[1],"highlightFillColor:"+T[1],"visible:"+ai[1],"fixed:"+ah.outputFixed,"labelColor:"+R[1],"draft:"+G[1]);q.objects[Z].setStyle(1*ah.outputStyle);q.objects[Z].traced=(ak[1]=="false")?false:true}else{if(ah.typeName=="PERPENDICULAR_POINT"){q.createElement("perpendicularpoint",[ah.defEl[1],ah.defEl[0]],{name:ah.outputName,id:ah.outputId})}else{throw new Error("JSXGraph: GEONExT-Element "+ah.typeName+" not yet implemented")}}}}}}}}}}}}}if(ah.typeName=="MIDPOINT"||ah.typeName=="MIRROR_LINE"||ah.typeName=="CIRCUMCIRCLE_CENTER"||ah.typeName=="PERPENDICULAR_POINT"||ah.typeName=="MIRROR_POINT"||ah.typeName=="PARALLELOGRAM_POINT"){ah.outputFixed=l.getElementsByTagName("output")[0].getElementsByTagName("fix")[0].firstChild.data;ah.outputStyle=l.getElementsByTagName("output")[0].getElementsByTagName("style")[0].firstChild.data;q.objects[ah.outputId].setProperty("strokeColor:"+ah.outputColorStroke,"strokeWidth:"+ah.outputStrokewidth,"fillColor:"+ah.outputColorStroke,"highlightStrokeColor:"+ah.outputHighlightStrokeColor,"highlightFillColor:"+ah.outputHighlightStrokeColor,"visible:"+ah.outputVisible,"fixed:"+ah.outputFixed,"labelColor:"+ah.outputColorLabel,"draft:"+ah.outputDraft);q.objects[ah.outputId].setStyle(1*ah.outputStyle);q.objects[ah.outputId].traced=(ah.outputTrace=="false")?false:true}else{if(ah.typeName=="BISECTOR"||ah.typeName=="NORMAL"||ah.typeName=="PARALLEL"){h=l.getElementsByTagName("output")[0].getElementsByTagName("straight")[0];ah.straightFirst=h.getElementsByTagName("first")[0].firstChild.data;ah.straightLast=h.getElementsByTagName("last")[0].firstChild.data;ah.straightFirst=(ah.straightFirst=="false")?false:true;ah.straightLast=(ah.straightLast=="false")?false:true;q.objects[ah.outputId].setStraight(ah.straightFirst,ah.straightLast);q.objects[ah.outputId].setProperty("strokeColor:"+ah.outputColorStroke,"strokeWidth:"+ah.outputStrokewidth,"fillColor:"+ah.outputColorFill,"highlightStrokeColor:"+ah.outputHighlightStrokeColor,"highlightFillColor:"+ah.outputColorFill,"visible:"+ah.outputVisible,"dash:"+ah.outputDash,"draft:"+ah.outputDraft);q.objects[ah.outputId].traced=(ah.outputTrace=="false")?false:true}else{if(ah.typeName=="CIRCUMCIRCLE"){for(af=0;af<l.getElementsByTagName("output").length;af++){h=l.getElementsByTagName("output")[af];P[af]=h.getElementsByTagName("id")[0].firstChild.data;P[af]=JXG.GeonextReader.changeOriginIds(q,P[af]);an[af]=h.getElementsByTagName("name")[0];ai[af]=h.getElementsByTagName("visible")[0].firstChild.data;ak[af]=h.getElementsByTagName("trace")[0].firstChild.data;J[af]=h.getElementsByTagName("dash")[0].firstChild.data;G[af]=h.getElementsByTagName("draft")[0].firstChild.data;ae[af]=h.getElementsByTagName("strokewidth")[0].firstChild.data;h=l.getElementsByTagName("output")[af].getElementsByTagName("color")[0];ad[af]=h.getElementsByTagName("stroke")[0].firstChild.data;T[af]=h.getElementsByTagName("lighting")[0].firstChild.data;X[af]=h.getElementsByTagName("fill")[0].firstChild.data;R[af]=h.getElementsByTagName("label")[0].firstChild.data}ah.outputFixed=l.getElementsByTagName("output")[0].getElementsByTagName("fix")[0].firstChild.data;ah.outputStyle=l.getElementsByTagName("output")[0].getElementsByTagName("style")[0].firstChild.data;Z=P[0];q.objects[Z].setProperty("strokeColor:"+ad[0],"strokeWidth:"+ae[0],"fillColor:"+ad[0],"highlightStrokeColor:"+T[0],"highlightFillColor:"+T[0],"visible:"+ai[0],"fixed:"+ah.outputFixed,"labelColor:"+R[0],"draft:"+G[0]);q.objects[Z].setStyle(1*ah.outputStyle);q.objects[Z].traced=(ak[0]=="false")?false:true;Q=P[1];q.objects[Q].setProperty("strokeColor:"+ad[1],"strokeWidth:"+ae[1],"fillColor:"+X[1],"highlightStrokeColor:"+T[1],"highlightFillColor:"+X[1],"visible:"+ai[1],"dash:"+J[1],"draft:"+G[1]);q.objects[Q].traced=(ak[1]=="false")?false:true}}}JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"polygon":ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah.dataVertex=[];for(af=0;af<l.getElementsByTagName("data")[0].getElementsByTagName("vertex").length;af++){ah.dataVertex[af]=l.getElementsByTagName("data")[0].getElementsByTagName("vertex")[af].firstChild.data;ah.dataVertex[af]=JXG.GeonextReader.changeOriginIds(q,ah.dataVertex[af])}ah.border=[];for(af=0;af<l.getElementsByTagName("border").length;af++){ah.border[af]={};h=l.getElementsByTagName("border")[af];ah.border[af].id=h.getElementsByTagName("id")[0].firstChild.data;ah.border[af].name=h.getElementsByTagName("name")[0].firstChild.data;ah.border[af].straightFirst=h.getElementsByTagName("straight")[0].getElementsByTagName("first")[0].firstChild.data;ah.border[af].straightLast=h.getElementsByTagName("straight")[0].getElementsByTagName("last")[0].firstChild.data;ah.border[af].straightFirst=(ah.border[af].straightFirst=="false")?false:true;ah.border[af].straightLast=(ah.border[af].straightLast=="false")?false:true;ah.border[af].strokewidth=h.getElementsByTagName("strokewidth")[0].firstChild.data;ah.border[af].dash=h.getElementsByTagName("dash")[0].firstChild.data;ah.border[af].visible=h.getElementsByTagName("visible")[0].firstChild.data;ah.border[af].draft=h.getElementsByTagName("draft")[0].firstChild.data;ah.border[af].trace=h.getElementsByTagName("trace")[0].firstChild.data;h=l.getElementsByTagName("border")[af].getElementsByTagName("color")[0];ah.border[af].colorStroke=h.getElementsByTagName("stroke")[0].firstChild.data;ah.border[af].highlightStrokeColor=h.getElementsByTagName("lighting")[0].firstChild.data;ah.border[af].colorFill=h.getElementsByTagName("fill")[0].firstChild.data;ah.border[af].colorLabel=h.getElementsByTagName("label")[0].firstChild.data;ah.border[af].colorDraft=h.getElementsByTagName("draft")[0].firstChild.data}JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"polygone");aa=new JXG.Polygon(q,ah.dataVertex,ah.border,ah.id,ah.name,true,true,true);aa.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorFill,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.colorFill,"labelColor:"+ah.colorLabel,"draft:"+ah.draft,"trace:"+ah.trace,"visible:true");if(!ah.visible){aa.setProperty("fillColor:none","highlightFillColor:none")}for(af=0;af<aa.borders.length;af++){aa.borders[af].setStraight(ah.border[af].straightFirst,ah.border[af].straightLast);aa.borders[af].setProperty("strokeColor:"+ah.border[af].colorStroke,"strokeWidth:"+ah.border[af].strokewidth,"fillColor:"+ah.border[af].colorFill,"highlightStrokeColor:"+ah.border[af].highlightStrokeColor,"highlightFillColor:"+ah.border[af].colorFill,"visible:"+ah.border[af].visible,"dash:"+ah.border[af].dash,"labelColor:"+ah.border[af].colorLabel,"draft:"+ah.border[af].draft,"trace:"+ah.border[af].trace)}JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"graph":ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah.funct=l.getElementsByTagName("data")[0].getElementsByTagName("function")[0].firstChild.data;JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"graphs");al=new JXG.Curve(q,["x","x",ah.funct],ah.id,ah.name);JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");al.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:none","highlightStrokeColor:"+ah.highlightStrokeColor);break;case"arrow":ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah=JXG.GeonextReader.readNodes(ah,l,"data");ah=JXG.GeonextReader.readNodes(ah,l,"straight","straight");ah=JXG.GeonextReader.visualProperties(ah,l);ah.first=JXG.GeonextReader.changeOriginIds(q,ah.first);ah.last=JXG.GeonextReader.changeOriginIds(q,ah.last);ac=new JXG.Line(q,ah.first,ah.last,ah.id,ah.name);ac.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorFill,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.colorFill,"labelColor:"+ah.colorLabel,"visible:"+ah.visible,"dash:"+ah.dash,"draft:"+ah.draft);ac.setStraight(false,false);ac.setArrow(false,true);ac.traced=(ah.trace=="false")?false:true;JXG.GeonextReader.printDebugMessage("debug",ac,l.nodeName,"OK");break;case"arc":ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah=JXG.GeonextReader.readNodes(ah,l,"data");ah.firstArrow=l.getElementsByTagName("firstarrow")[0].firstChild.data;ah.lastArrow=l.getElementsByTagName("lastarrow")[0].firstChild.data;JXG.GeonextReader.parseImage(q,l.getElementsByTagName("image")[0],"arcs");ah.midpoint=JXG.GeonextReader.changeOriginIds(q,ah.midpoint);ah.angle=JXG.GeonextReader.changeOriginIds(q,ah.angle);ah.radius=JXG.GeonextReader.changeOriginIds(q,ah.radius);al=new JXG.Arc(q,ah.midpoint,ah.radius,ah.angle,ah.id,ah.name);al.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorFill,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.colorFill,"labelColor:"+ah.colorLabel,"visible:"+ah.visible,"dash:"+ah.dash,"draft:"+ah.draft);al.traced=(ah.trace=="false")?false:true;ah.firstArrow=(ah.firstArrow=="false")?false:true;ah.lastArrow=(ah.lastArrow=="false")?false:true;al.setArrow(ah.firstArrow,ah.lastArrow);JXG.GeonextReader.printDebugMessage("debug",al,l.nodeName,"OK");break;case"angle":ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah=JXG.GeonextReader.readNodes(ah,l,"data");try{ah.txt=l.getElementsByTagName("text")[0].firstChild.data}catch(aj){ah.txt=""}al=new JXG.Angle(q,ah.first,ah.middle,ah.last,ah.radius,ah.txt,ah.id,ah.name);al.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:"+ah.colorFill,"highlightStrokeColor:"+ah.highlightStrokeColor,"highlightFillColor:"+ah.colorFill,"labelColor:"+ah.colorLabel,"visible:"+ah.visible,"dash:"+ah.dash);JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"text":if(ah.id.match(/oldVersion/)){break}ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.visualProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah=JXG.GeonextReader.readNodes(ah,l,"data");ah.mpStr=JXG.GeonextReader.subtreeToString(l.getElementsByTagName("data")[0].getElementsByTagName("mp")[0]);ah.mpStr=ah.mpStr.replace(/<\/?mp>/g,"");try{if(l.getElementsByTagName("data")[0].getElementsByTagName("parent")[0].firstChild){ah.parent=l.getElementsByTagName("data")[0].getElementsByTagName("parent")[0].firstChild.data}}catch(aj){}ah.condition=l.getElementsByTagName("condition")[0].firstChild.data;ah.content=l.getElementsByTagName("content")[0].firstChild.data;ah.fix=l.getElementsByTagName("fix")[0].firstChild.data;ah.autodigits=l.getElementsByTagName("digits")[0].firstChild.data;ah.parent=JXG.GeonextReader.changeOriginIds(q,ah.parent);al=new JXG.Text(q,ah.mpStr,ah.parent,[ah.x,ah.y],ah.id,ah.name,ah.autodigits,false,q.options.text.defaultType);al.setProperty("labelColor:"+ah.colorLabel,"visible:"+ah.visible);break;case"parametercurve":ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah.functionx=l.getElementsByTagName("functionx")[0].firstChild.data;ah.functiony=l.getElementsByTagName("functiony")[0].firstChild.data;ah.min=l.getElementsByTagName("min")[0].firstChild.data;ah.max=l.getElementsByTagName("max")[0].firstChild.data;al=new JXG.Curve(q,["t",ah.functionx,ah.functiony,ah.min,ah.max],ah.id,ah.name);al.setProperty("strokeColor:"+ah.colorStroke,"strokeWidth:"+ah.strokewidth,"fillColor:none","highlightStrokeColor:"+ah.highlightStrokeColor);JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;case"tracecurve":ah.tracepoint=l.getElementsByTagName("tracepoint")[0].firstChild.data;ah.traceslider=l.getElementsByTagName("traceslider")[0].firstChild.data;JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"<b>ERR</b>");break;case"group":ah=JXG.GeonextReader.boardProperties(ah,l);ah=JXG.GeonextReader.colorProperties(ah,l);ah=JXG.GeonextReader.firstLevelProperties(ah,l);ah.members=[];for(af=0;af<l.getElementsByTagName("data")[0].getElementsByTagName("member").length;af++){ah.members[af]=l.getElementsByTagName("data")[0].getElementsByTagName("member")[af].firstChild.data;ah.members[af]=JXG.GeonextReader.changeOriginIds(q,ah.members[af])}al=new JXG.Group(q,ah.id,ah.name,ah.members);JXG.GeonextReader.printDebugMessage("debug",ah,l.nodeName,"OK");break;default:}delete (ah)})(u)}q.addConditions(w.conditions)};this.decodeString=function(b){var a;if(b.indexOf("<GEONEXT>")<0){a=(new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(b))).unzip();if(a==""){return b}else{return a}}else{return b}};this.prepareString=function(a){try{if(a.indexOf("GEONEXT")<0){a=(JXG.GeonextReader.decodeString(a))[0][0]}a=JXG.GeonextReader.fixXML(a)}catch(b){a=""}return a};this.fixXML=function(g){var a=["active","angle","animate","animated","arc","area","arrow","author","autodigits","axis","back","background","board","border","bottom","buttonsize","cas","circle","color","comment","composition","condition","conditions","content","continuous","control","coord","coordinates","cross","cs","dash","data","description","digits","direction","draft","editable","elements","event","file","fill","first","firstarrow","fix","fontsize","free","full","function","functionx","functiony","GEONEXT","graph","grid","group","height","id","image","info","information","input","intersection","item","jsf","label","last","lastarrow","left","lefttoolbar","lighting","line","loop","max","maximized","member","middle","midpoint","min","modifier","modus","mp","mpx","multi","name","onpolygon","order","origin","output","overline","parametercurve","parent","point","pointsnap","polygon","position","radius","radiusnum","radiusvalue","right","section","selectedlefttoolbar","showconstruction","showcoord","showinfo","showunit","showx","showy","size","slider","snap","speed","src","start","stop","straight","stroke","strokewidth","style","term","text","top","trace","tracecurve","type","unit","value","VERSION","vertex","viewport","visible","width","wot","x","xooy","xval","y","yval","zoom"],d=a.join("|"),b="&lt;(/?("+d+"))&gt;",e=new RegExp(b,"g");g=JXG.escapeHTML(g);g=g.replace(e,"<$1>");g=g.replace(/(<content>.*)<arc>(.*<\/content>)/g,"$1&lt;arc&gt;$2");g=g.replace(/(<mp>.*)<arc>(.*<\/mpx>)/g,"$1&lt;arc&gt;$2");g=g.replace(/(<mpx>.*)<arc>(.*<\/mpx>)/g,"$1&lt;arc&gt;$2");return g}};JXG.IntergeoReader=new function(){this.board=null;this.objects={};this.readIntergeo=function(a,b){this.board=b;this.board.origin={};this.board.origin.usrCoords=[1,0,0];this.board.origin.scrCoords=[1,400,300];this.board.unitX=30;this.board.unitY=30;this.board.stretchX=this.board.zoomX*this.board.unitX;this.board.stretchY=this.board.zoomY*this.board.unitY;this.readElements(a.getElementsByTagName("elements"));this.readConstraints(a.getElementsByTagName("constraints"));this.cleanUp();this.board.fullUpdate()};this.readElements=function(a){var b;for(var b=0;b<a[0].childNodes.length;b++){(function(d){var e;e=a[0].childNodes[d];if(e.nodeType>1){return}if(e.nodeName=="point"){JXG.IntergeoReader.storePoint(e)}else{if(e.nodeName=="line"){JXG.IntergeoReader.storeLine(e)}else{if(e.nodeName=="line_segment"){JXG.IntergeoReader.storeLine(e)}else{if(e.nodeName=="circle"){JXG.IntergeoReader.storeCircle(e)}else{document.getElementById("debug").innerHTML+="Not implemented: "+e.nodeName+" "+e.getAttribute("id")+"<br>"}}}}})(b)}};this.addPointOld=function(d){var k=0,g=0,e=0,b,a=d.childNodes[k],m=[],h={strokeColor:"red",fillColor:"red",withLabel:true},q=[];while(a.nodeType>1){k++;a=d.childNodes[k]}h.name=d.getAttribute("id");if(a.nodeName=="homogeneous_coordinates"){for(g=0;g<a.childNodes.length;g++){if(a.childNodes[g].nodeType==1){if(a.childNodes[g].nodeName=="double"){m.push(a.childNodes[g].firstChild.data)}else{if(a.childNodes[g].nodeName=="complex"){for(e=0;e<a.childNodes[g].childNodes.length;e++){if(a.childNodes[g].childNodes[e].nodeName=="double"){m.push(a.childNodes[g].childNodes[e].firstChild.data)}}}else{document.getElementById("debug").innerHTML+="Not implemented: "+a.childNodes[g].nodeName+"<br>";return}}}}for(g=0;g<m.length;g++){m[g]=parseFloat(m[g])}if(m.length==3){q=[m[2],m[0],m[1]]}else{if(m.length==6&&Math.abs(m[1])<1e-10&&Math.abs(m[3])<1e-10&&Math.abs(m[5])<1e-10){q=[m[4],m[0],m[2]]}else{document.getElementById("debug").innerHTML+="type not supported, yet <br>";return}}}else{if(a.nodeName=="euclidean_coordinates"){for(g=0;g<a.childNodes.length;g++){if(a.childNodes[g].nodeType==1){m.push(a.childNodes[g].firstChild.data)}}for(g=0;g<m.length;g++){m[g]=parseFloat(m[g])}q=[m[0],m[1]]}else{if(a.nodeName=="polar_coordinates"){for(g=0;g<a.childNodes.length;g++){if(a.childNodes[g].nodeType==1){m.push(a.childNodes[g].firstChild.data)}}for(g=0;g<m.length;g++){m[g]=parseFloat(m[g])}q=[m[0]*Math.cos(m[1]),m[0]*Math.sin(m[1])]}else{document.getElementById("debug").innerHTML+="This coordinate type is not yet implemented: "+a.nodeName+"<br>";return}}}b=this.board.createElement("point",q,h);this.objects[d.getAttribute("id")]=b};this.storePoint=function(g){var e=0,d=0,a=0,h=g.childNodes[e],k=[],b=[];while(h.nodeType>1){e++;h=g.childNodes[e]}if(h.nodeName=="homogeneous_coordinates"){for(d=0;d<h.childNodes.length;d++){if(h.childNodes[d].nodeType==1){if(h.childNodes[d].nodeName=="double"){k.push(h.childNodes[d].firstChild.data)}else{if(h.childNodes[d].nodeName=="complex"){for(a=0;a<h.childNodes[d].childNodes.length;a++){if(h.childNodes[d].childNodes[a].nodeName=="double"){k.push(h.childNodes[d].childNodes[a].firstChild.data)}}}else{document.getElementById("debug").innerHTML+="Not implemented: "+h.childNodes[d].nodeName+"<br>";return}}}}for(d=0;d<k.length;d++){k[d]=parseFloat(k[d])}if(k.length==3){b=[k[2],k[0],k[1]]}else{if(k.length==6&&Math.abs(k[1])<1e-10&&Math.abs(k[3])<1e-10&&Math.abs(k[5])<1e-10){b=[k[4],k[0],k[2]]}else{document.getElementById("debug").innerHTML+="type not supported, yet <br>";return}}}else{if(h.nodeName=="euclidean_coordinates"){for(d=0;d<h.childNodes.length;d++){if(h.childNodes[d].nodeType==1){k.push(h.childNodes[d].firstChild.data)}}for(d=0;d<k.length;d++){k[d]=parseFloat(k[d])}b=[k[0],k[1]]}else{if(h.nodeName=="polar_coordinates"){for(d=0;d<h.childNodes.length;d++){if(h.childNodes[d].nodeType==1){k.push(h.childNodes[d].firstChild.data)}}for(d=0;d<k.length;d++){k[d]=parseFloat(k[d])}b=[k[0]*Math.cos(k[1]),k[0]*Math.sin(k[1])]}else{document.getElementById("debug").innerHTML+="This coordinate type is not yet implemented: "+h.nodeName+"<br>";return}}}this.objects[g.getAttribute("id")]={id:g.getAttribute("id"),coords:null};this.objects[g.getAttribute("id")].coords=b;this.objects[g.getAttribute("id")].id=g.getAttribute("id");this.objects[g.getAttribute("id")].exists=false};this.storeLine=function(d){var b,e,g,a;this.objects[d.getAttribute("id")]={id:d.getAttribute("id"),coords:null};b=0;e=d.childNodes[b];while(e.nodeType>1){b++;e=d.childNodes[b]}if(e.nodeName=="homogeneous_coordinates"){g=[];for(a=0;a<e.childNodes.length;a++){if(e.childNodes[a].nodeType==1){if(e.childNodes[a].nodeName=="double"){g.push(parseFloat(e.childNodes[a].firstChild.data))}else{}}}this.objects[d.getAttribute("id")].coords=g;this.objects[d.getAttribute("id")].id=d.getAttribute("id");this.objects[d.getAttribute("id")].exists=false}};this.addLine=function(e){var a,d=this.objects[e].coords,b;for(a=0;a<d.length;a++){d[a]=parseFloat(d[a])}b=this.board.createElement("line",[d[2],d[0],d[1]],{name:e,strokeColor:"black",withLabel:true});this.objects[e]=b};this.storeCircle=function(d){var b,a,e,g;this.objects[d.getAttribute("id")]={id:d.getAttribute("id"),coords:null};b=0;e=d.childNodes[b];while(e.nodeType>1){b++;e=d.childNodes[b]}if(e.nodeName=="matrix"){g=[];for(a=0;a<e.childNodes.length;a++){if(e.childNodes[a].nodeType==1){if(e.childNodes[a].nodeName=="double"){g.push(parseFloat(e.childNodes[a].firstChild.data))}else{}}}this.objects[d.getAttribute("id")].coords=g;this.objects[d.getAttribute("id")].id=d.getAttribute("id");this.objects[d.getAttribute("id")].exists=false}};this.readConstraints=function(a){var b,d;this.board.options.point.strokeColor="blue";this.board.options.point.fillColor="blue";for(b=0;b<a[0].childNodes.length;b++){(function(e){var g;g=a[0].childNodes[e];if(g.nodeType>1){return}if(g.nodeName=="line_through_two_points"){JXG.IntergeoReader.addLineThroughTwoPoints(g)}else{if(g.nodeName=="line_through_point"){JXG.IntergeoReader.addLineThroughPoint(g)}else{if(g.nodeName=="line_parallel_to_line_through_point"){JXG.IntergeoReader.addLineParallelToLineThroughPoint(g)}else{if(g.nodeName=="line_perpendicular_to_line_through_point"){JXG.IntergeoReader.addLinePerpendicularToLineThroughPoint(g)}else{if(g.nodeName=="line_segment_by_points"){JXG.IntergeoReader.addLineSegmentByTwoPoints(g)}else{if(g.nodeName=="endpoints_of_line_segment"){JXG.IntergeoReader.addEndpointsOfLineSegment(g)}else{if(g.nodeName=="free_point"){}else{if(g.nodeName=="free_line"){JXG.IntergeoReader.addFreeLine(g)}else{if(g.nodeName=="point_on_line"){JXG.IntergeoReader.addPointOnLine(g)}else{if(g.nodeName=="point_on_line_segment"){JXG.IntergeoReader.addPointOnLine(g)}else{if(g.nodeName=="point_on_circle"){JXG.IntergeoReader.addPointOnCircle(g)}else{if(g.nodeName=="angular_bisector_of_three_points"){JXG.IntergeoReader.addAngularBisectorOfThreePoints(g)}else{if(g.nodeName=="angular_bisectors_of_two_lines"){JXG.IntergeoReader.addAngularBisectorsOfTwoLines(g)}else{if(g.nodeName=="midpoint_of_two_points"){JXG.IntergeoReader.addMidpointOfTwoPoints(g)}else{if(g.nodeName=="midpoint"){JXG.IntergeoReader.addMidpointOfTwoPoints(g)}else{if(g.nodeName=="midpoint_of_line_segment"||g.nodeName=="midpoint_line_segment"){JXG.IntergeoReader.addMidpointOfLineSegment(g)}else{if(g.nodeName=="point_intersection_of_two_lines"){JXG.IntergeoReader.addPointIntersectionOfTwoLines(g)}else{if(g.nodeName=="locus_defined_by_point"){JXG.IntergeoReader.addLocusDefinedByPoint(g)}else{if(g.nodeName=="locus_defined_by_point_on_line"){JXG.IntergeoReader.addLocusDefinedByPointOnLine(g)}else{if(g.nodeName=="locus_defined_by_point_on_line_segment"){JXG.IntergeoReader.addLocusDefinedByPointOnLine(g)}else{if(g.nodeName=="locus_defined_by_line_through_point"){JXG.IntergeoReader.addLocusDefinedByLineThroughPoint(g)}else{if(g.nodeName=="locus_defined_by_point_on_circle"){JXG.IntergeoReader.addLocusDefinedByPointOnCircle(g)}else{if(g.nodeName=="circle_by_three_points"){JXG.IntergeoReader.addCircleByThreePoints(g)}else{if(g.nodeName=="circle_by_center_and_point"){JXG.IntergeoReader.addCircleByCenterAndPoint(g)}else{if(g.nodeName=="center_of_circle"){JXG.IntergeoReader.addCenterOfCircle(g)}else{if(g.nodeName=="intersection_points_of_two_circles"){JXG.IntergeoReader.addIntersectionPointsOfTwoCircles(g)}else{if(g.nodeName=="intersection_points_of_circle_and_line"){JXG.IntergeoReader.addIntersectionPointsOfCircleAndLine(g)}else{if(g.nodeName=="other_intersection_point_of_two_circles"){JXG.IntergeoReader.addOtherIntersectionPointOfTwoCircles(g)}else{if(g.nodeName=="other_intersection_point_of_circle_and_line"){JXG.IntergeoReader.addOtherIntersectionPointOfCircleAndLine(g)}else{if(g.nodeName=="circle_tangent_lines_by_point"){JXG.IntergeoReader.addCircleTangentLinesByPoint(g)}else{d=JXG.IntergeoReader.readParams(g);$("debug").innerHTML+="readConstraints: not implemented: "+g.nodeName+": "+d[0]+"<br>"}}}}}}}}}}}}}}}}}}}}}}}}}}}}}}})(b)}};this.setAttributes=function(a){a.setProperty({strokecolor:this.board.options.point.strokeColor,fillColor:this.board.options.point.fillColor})};this.readParams=function(b){var d=[],a;for(a=0;a<b.childNodes.length;a++){if(b.childNodes[a].nodeType==1){d.push(b.childNodes[a].firstChild.data)}}return d};this.addPoint=function(a){if(!a.exists){a.exists=true;a=this.board.createElement("point",a.coords,{name:a.id});a.setProperty({strokecolor:"red",fillColor:"red"})}return a};this.cleanUp=function(){var a;for(a in this.objects){if(this.objects[a].exists==false){this.addPoint(this.objects[a])}}};this.addLineThroughTwoPoints=function(e){var g=JXG.IntergeoReader.readParams(e),b,a,d;b=this.addPoint(this.objects[g[1]]);a=this.addPoint(this.objects[g[2]]);d=this.board.createElement("line",[b.id,a.id],{name:g[0],withLabel:true});this.objects[g[0]]=d;this.objects[g[0]].exists=true};this.addLineThroughPoint=function(d){var g=JXG.IntergeoReader.readParams(d),a,h=this.objects[g[0]].coords,e=this.addPoint(this.objects[g[1]]),b;for(a=0;a<h.length;a++){h[a]=parseFloat(h[a])}b=this.board.createElement("line",[function(){return h[2]-h[0]*e.X()-h[1]*e.Y()-h[2]*e.Z()},h[0],h[1]],{name:g[0],strokeColor:"black",withLabel:true});this.objects[g[0]]=b;this.objects[g[0]].exists=true};this.addLineParallelToLineThroughPoint=function(e){var g=JXG.IntergeoReader.readParams(e),b,a,d;b=this.addPoint(this.objects[g[1]]);a=this.addPoint(this.objects[g[2]]);d=this.board.createElement("parallel",[b.id,a.id],{name:g[0],withLabel:true});this.objects[g[0]]=d;this.objects[g[0]].exists=true};this.addLinePerpendicularToLineThroughPoint=function(e){var g=JXG.IntergeoReader.readParams(e),b,a,d;b=this.addPoint(this.objects[g[1]]);a=this.addPoint(this.objects[g[2]]);d=this.board.createElement("perpendicular",[b.id,a.id],{name:[g[0],g[0]+"foot"],id:[g[0],g[0]+"foot"],withLabel:true});d[0].setProperty("straightFirst:true","straightLast:true");d[1].setProperty("visible:false");this.objects[g[0]]=d[0];this.objects[g[0]].exists=true};this.addLineSegmentByTwoPoints=function(e){var g=JXG.IntergeoReader.readParams(e),b,a,d;b=this.addPoint(this.objects[g[1]]);a=this.addPoint(this.objects[g[2]]);d=this.board.createElement("line",[b.id,a.id],{name:g[0],straightFirst:false,straightLast:false,strokeColor:"black",withLabel:true});this.objects[g[0]]=d;this.objects[g[0]].exists=true};this.addPointIntersectionOfTwoLines=function(d){var e=JXG.IntergeoReader.readParams(d),b=this.objects[e[1]],a=this.objects[e[2]];this.objects[e[0]]=this.board.createElement("intersection",[b,a,0],{name:e[0],id:e[0],withLabel:true});this.setAttributes(this.objects[e[0]]);this.objects[e[0]].exists=true};this.addFreeLine=function(g){var h=JXG.IntergeoReader.readParams(g),e=this.objects[h[0]].coords[0],d=this.objects[h[0]].coords[1],k=this.objects[h[0]].coords[2];el=this.board.createElement("line",[k,e,d],{name:h[0],id:h[0],withLabel:true});this.objects[h[0]]=el;this.objects[h[0]].exists=true};this.addPointOnLine=function(d){var e=JXG.IntergeoReader.readParams(d),a=JXG.getReference(this.board,e[1]),b;b=this.board.createElement("glider",[0,0,a],{name:e[0],id:e[0],withLabel:true});this.objects[e[0]].exists=true};this.addPointOnCircle=function(b){var d=JXG.IntergeoReader.readParams(b),e=JXG.getReference(this.board,d[1]),a;e.update();a=this.board.createElement("glider",[this.objects[d[0]].coords[1],this.objects[d[0]].coords[2],e],{name:d[0],id:d[0],withLabel:true});this.objects[d[0]].exists=true};this.addEndpointsOfLineSegment=function(b){var g=JXG.IntergeoReader.readParams(b),a=this.objects[g[2]],e=this.addPoint(this.objects[g[0]]),d=this.addPoint(this.objects[g[1]]);e.addConstraint([function(){return a.point1.Z()},function(){return a.point1.X()},function(){return a.point1.Y()}]);d.addConstraint([function(){return a.point2.Z()},function(){return a.point2.X()},function(){return a.point2.Y()}]);this.setAttributes(e);this.setAttributes(d)};this.addAngularBisectorOfThreePoints=function(g){var h=JXG.IntergeoReader.readParams(g),d,b,a,e;d=this.addPoint(this.objects[h[1]]);b=this.addPoint(this.objects[h[2]]);a=this.addPoint(this.objects[h[3]]);e=this.board.createElement("bisector",[d.id,b.id,a.id],{name:[h[0]+"_1",h[0]+"_2"],id:[h[0]+"_1",h[0]+"_2"],withLabel:true});e.setProperty({straightFirst:false,straightLast:true,strokeColor:"#000000"});this.objects[h[0]]=e;this.objects[h[0]].exists=true};this.addMidpointOfTwoPoints=function(e){var g=JXG.IntergeoReader.readParams(e),d,b,a;d=this.addPoint(this.objects[g[1]]);b=this.addPoint(this.objects[g[2]]);el=this.board.createElement("midpoint",[d.id,b.id],{name:g[0]});this.setAttributes(el);this.objects[g[0]].exists=true};this.addMidpointOfLineSegment=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);el=this.board.createElement("midpoint",[a.point1,a.point2],{name:d[0]});this.setAttributes(el);this.objects[d[0]].exists=true};this.addCircleByThreePoints=function(d){var g=JXG.IntergeoReader.readParams(d),e=[],b,a;for(b=0;b<3;b++){e[b]=this.addPoint(this.objects[g[b+1]])}a=this.board.createElement("circumcircle",e,{name:[g[0]+"c",g[0]],id:[g[0]+"c",g[0]],withLabel:true});a[0].setProperty({visible:false});a[1].setProperty({withLabel:true});this.objects[g[0]].exists=true};this.addCenterOfCircle=function(b){var d=JXG.IntergeoReader.readParams(b),e=JXG.getReference(this.board,d[1]),a=this.board.createElement("point",[function(){return e.midpoint.X()},function(){return e.midpoint.Y()}],{name:d[0],id:d[0],withLabel:true});this.setAttributes(a);this.objects[d[0]].exists=true};this.addCircleTangentLinesByPoint=function(e){var d=JXG.IntergeoReader.readParams(e),s=JXG.getReference(this.board,d[2]),b=this.addPoint(this.objects[d[3]]),g,a,k,h,q,l;a=this.board.createElement("line",[function(){return JXG.Math.matVecMult(s.quadraticform,b.coords.usrCoords)[0]},function(){return JXG.Math.matVecMult(s.quadraticform,b.coords.usrCoords)[1]},function(){return JXG.Math.matVecMult(s.quadraticform,b.coords.usrCoords)[2]}],{visible:false});k=this.board.createElement("intersection",[s,a,0],{visible:false});h=this.board.createElement("intersection",[s,a,1],{visible:false});q=this.board.createElement("tangent",[k,s]);l=this.board.createElement("tangent",[h,s]);this.objects[d[0]]=q;this.objects[d[1]]=l;this.objects[d[0]].exists=true;this.objects[d[1]].exists=true};this.addIntersectionPointsOfTwoCircles=function(d){var h=JXG.IntergeoReader.readParams(d),b=JXG.getReference(this.board,h[2]),a=JXG.getReference(this.board,h[3]),g,e;g=this.board.createElement("intersection",[b,a,0],{name:h[0],id:h[0],withLabel:true});e=this.board.createElement("intersection",[b,a,1],{name:h[1],id:h[1],withLabel:true});this.setAttributes(g);this.setAttributes(e);this.objects[h[0]].exists=true;this.objects[h[1]].exists=true};this.addIntersectionPointsOfCircleAndLine=function(d){var h=JXG.IntergeoReader.readParams(d),b=JXG.getReference(this.board,h[2]),a=JXG.getReference(this.board,h[3]),g,e;g=this.board.createElement("intersection",[b,a,0],{name:h[0],id:h[0],withLabel:true});e=this.board.createElement("intersection",[b,a,1],{name:h[1],id:h[1],withLabel:true});this.setAttributes(g);this.setAttributes(e);this.objects[h[0]].exists=true;this.objects[h[1]].exists=true};this.addCircleByCenterAndPoint=function(d){var e=JXG.IntergeoReader.readParams(d),b=this.addPoint(this.objects[e[1]]),a=this.addPoint(this.objects[e[2]]);el=this.board.createElement("circle",[b.id,a.id],{name:e[0],id:e[0],withLabel:true});this.objects[e[0]].exists=true};this.addOtherIntersectionPointOfTwoCircles=function(d){var h=JXG.IntergeoReader.readParams(d),b=JXG.getReference(this.board,h[2]),a=JXG.getReference(this.board,h[3]),g=JXG.getReference(this.board,h[1]),e;e=this.board.createElement("otherintersection",[b,a,g],{name:h[0],id:h[0],withLabel:true});this.setAttributes(e);this.objects[h[0]].exists=true};this.addOtherIntersectionPointOfCircleAndLine=function(a){this.addOtherIntersectionPointOfTwoCircles(a)};this.addAngularBisectorsOfTwoLines=function(e){var g=JXG.IntergeoReader.readParams(e),b=this.objects[g[2]],a=this.objects[g[3]],d;d=this.board.createElement("bisectorlines",[b,a],{name:[g[0],g[1]],id:[g[0],g[1]],straightFirst:true,straightLast:true,strokeColor:"#ff0000",withLabel:true});this.objects[g[0]].exists=true;this.objects[g[1]].exists=true};this.addLocusDefinedByPoint=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a;this.setAttributes(a)};this.addLocusDefinedByPointOnLine=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a;this.setAttributes(a)};this.addLocusDefinedByLineThroughPoint=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a;this.setAttributes(a)};this.addLocusDefinedByPointOnCircle=function(b){var d=JXG.IntergeoReader.readParams(b),a=JXG.getReference(this.board,d[1]);a.setProperty({trace:true});this.objects[d[1]]=a;this.setAttributes(a)};this.prepareString=function(b){var d=[],a;if(b.indexOf("<")!=0){for(a=0;a<b.length;a++){d[a]=JXG.Util.asciiCharCodeAt(b,a)}b=(new JXG.Util.Unzip(d)).unzipFile("construction/intergeo.xml")}return b}};JXG.Board=function(a,h,b,s,q,m,l,k,d,e,g){this.BOARD_MODE_NONE=0;this.BOARD_MODE_DRAG=1;this.BOARD_MODE_CONSTRUCT=16;this.BOARD_MODE_MOVE_ORIGIN=2;this.BOARD_QUALITY_LOW=1;this.BOARD_QUALITY_HIGH=2;this.CONSTRUCTION_TYPE_POINT=1129599060;this.CONSTRUCTION_TYPE_CIRCLE=1129595724;this.CONSTRUCTION_TYPE_LINE=1129598030;this.CONSTRUCTION_TYPE_GLIDER=1129596740;this.CONSTRUCTION_TYPE_MIDPOINT=1129598288;this.CONSTRUCTION_TYPE_PERPENDICULAR=1129599044;this.CONSTRUCTION_TYPE_PARALLEL=1129599052;this.CONSTRUCTION_TYPE_INTERSECTION=1129597267;this.container=a;this.containerObj=document.getElementById(this.container);if(this.containerObj==null){throw new Error("\nJSXGraph: HTML container element '"+(box)+"' not found.")}this.renderer=h;this.options=JXG.deepCopy(JXG.Options);this.dimension=2;this.origin={};this.origin.usrCoords=[1,0,0];this.origin.scrCoords=[1,s[0],s[1]];this.zoomX=q;this.zoomY=m;this.unitX=l;this.unitY=k;this.stretchX=this.zoomX*this.unitX;this.stretchY=this.zoomY*this.unitY;this.canvasWidth=d;this.canvasHeight=e;this.fontSize=this.options.fontSize;this.algebra=new JXG.Algebra(this);this.mathStatistics=new JXG.MathStatistics();if((b!="")&&(b!=null)&&(typeof document.getElementById(b)!="undefined")){this.id=b}else{this.id=this.generateId()}this.hooks=[];this.dependentBoards=[];this.objects={};this.animationObjects={};this.highlightedObjects={};this.numObjects=0;this.elementsByName={};this.mode=this.BOARD_MODE_NONE;this.updateQuality=this.BOARD_QUALITY_HIGH;this.isSuspendedRedraw=false;this.snapToGrid=this.options.grid.snapToGrid;this.gridX=this.options.grid.gridX;this.gridY=this.options.grid.gridY;this.gridColor=this.options.grid.gridColor;this.gridOpacity=this.options.grid.gridOpacity;this.gridDash=this.options.grid.gridDash;this.snapSizeX=this.options.grid.snapSizeX;this.snapSizeY=this.options.grid.snapSizeY;this.calculateSnapSizes();this.hasGrid=this.options.grid.hasGrid;this.drag_dx=0;this.drag_dy=0;this.drag_obj=null;this.xmlString="";if((g!=null&&g)||(g==null&&this.options.showCopyright)){this.renderer.displayCopyright(JXG.JSXGraph.licenseText,this.options.fontSize)}this.needsFullUpdate=false;this.reducedUpdate=false;this.geonextCompatibilityMode=false;if(this.options.text.useASCIIMathML){if(typeof translateASCIIMath!="undefined"){init()}else{this.options.text.useASCIIMathML=false}}JXG.addEvent(document,"mousedown",this.mouseDownListener,this);JXG.addEvent(this.containerObj,"mousemove",this.mouseMoveListener,this)};JXG.Board.prototype.generateName=function(d){if(d.type==JXG.OBJECT_TYPE_TICKS){return}var l;if(d.elementClass==JXG.OBJECT_CLASS_POINT){l=["","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]}else{l=["","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"]}var g=3;var b="";var q="";var m="";if(d.elementClass==JXG.OBJECT_CLASS_POINT||d.elementClass==JXG.OBJECT_CLASS_LINE){}else{if(d.type==JXG.OBJECT_TYPE_POLYGON){b="P_{";m="}"}else{if(d.type==JXG.OBJECT_TYPE_CIRCLE){b="k_{";m="}"}else{if(d.type==JXG.OBJECT_TYPE_ANGLE){b="W_{";m="}"}else{b="s_{";m="}"}}}}var s=[];var a="";var k="";var h=0;var e=0;for(h=0;h<g;h++){s[h]=0}while(s[g-1]<l.length){for(s[0]=1;s[0]<l.length;s[0]++){a=b;for(h=g;h>0;h--){a+=l[s[h-1]]}if(this.elementsByName[a+m]==null){return a+m}}s[0]=l.length;for(h=1;h<g;h++){if(s[h-1]==l.length){s[h-1]=1;s[h]++}}}return""};JXG.Board.prototype.generateId=function(){var a=1;while(JXG.JSXGraph.boards["gxtBoard"+a]!=null){a=Math.round(Math.random()*33)}return("gxtBoard"+a)};JXG.Board.prototype.setId=function(e,d){var b=this.numObjects,a=e.id;this.numObjects++;if((a=="")||(a==null)){a=this.id+d+b}e.id=a;this.objects[a]=e;if(e.hasLabel){e.label.content.id=a+"Label";this.addText(e.label.content)}return a};JXG.Board.prototype.getRelativeMouseCoordinates=function(b){var d=this.containerObj,a=JXG.getOffset(d),e;e=parseInt(JXG.getStyle(d,"borderLeftWidth"));if(isNaN(e)){e=0}a[0]+=e;e=parseInt(JXG.getStyle(d,"borderTopWidth"));if(isNaN(e)){e=0}a[1]+=e;e=parseInt(JXG.getStyle(d,"paddingLeft"));if(isNaN(e)){e=0}a[0]+=e;e=parseInt(JXG.getStyle(d,"paddingTop"));if(isNaN(e)){e=0}a[1]+=e;return a};JXG.Board.prototype.clickLeftArrow=function(a){this.origin.scrCoords[1]+=this.canvasWidth*0.1;this.moveOrigin();return this};JXG.Board.prototype.clickRightArrow=function(a){this.origin.scrCoords[1]-=this.canvasWidth*0.1;this.moveOrigin();return this};JXG.Board.prototype.clickUpArrow=function(a){this.origin.scrCoords[2]+=this.canvasHeight*0.1;this.moveOrigin();return this};JXG.Board.prototype.clickDownArrow=function(a){this.origin.scrCoords[2]-=this.canvasHeight*0.1;this.moveOrigin();return this};JXG.Board.prototype.mouseUpListener=function(a){this.updateQuality=this.BOARD_QUALITY_HIGH;JXG.removeEvent(document,"mouseup",this.mouseUpListener,this);this.mode=this.BOARD_MODE_NONE;if(this.mode==this.BOARD_MODE_MOVE_ORIGIN){this.moveOrigin()}else{this.update()}this.drag_obj=null};JXG.Board.prototype.mouseDownListener=function(h){var e,k,g,a,d,b;g=this.getRelativeMouseCoordinates(h);a=JXG.getPosition(h);d=a[0]-g[0];b=a[1]-g[1];if(h.shiftKey){this.drag_dx=d-this.origin.scrCoords[1];this.drag_dy=b-this.origin.scrCoords[2];this.mode=this.BOARD_MODE_MOVE_ORIGIN;JXG.addEvent(document,"mouseup",this.mouseUpListener,this);return}if(this.mode==this.BOARD_MODE_CONSTRUCT){return}this.mode=this.BOARD_MODE_DRAG;if(this.mode==this.BOARD_MODE_DRAG){for(e in this.objects){k=this.objects[e];if((k.hasPoint!=undefined)&&((k.type==JXG.OBJECT_TYPE_POINT)||(k.type==JXG.OBJECT_TYPE_GLIDER))&&(k.visProp.visible)&&(!k.fixed)&&(k.hasPoint(d,b))){this.drag_obj=this.objects[e];if((k.type==JXG.OBJECT_TYPE_POINT)||(k.type==JXG.OBJECT_TYPE_GLIDER)){break}}}}if(this.drag_obj==null){this.mode=this.BOARD_MODE_NONE;return}this.dragObjCoords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[d,b],this);JXG.addEvent(document,"mouseup",this.mouseUpListener,this)};JXG.Board.prototype.mouseMoveListener=function(h){var b,d,k,a,m,l,e;k=this.getRelativeMouseCoordinates(h);a=JXG.getPosition(h);x=a[0]-k[0];y=a[1]-k[1];this.updateQuality=this.BOARD_QUALITY_LOW;this.dehighlightAll(x,y);if(this.mode!=this.BOARD_MODE_DRAG){this.renderer.hide(this.infobox)}if(this.mode==this.BOARD_MODE_MOVE_ORIGIN){this.origin.scrCoords[1]=x-this.drag_dx;this.origin.scrCoords[2]=y-this.drag_dy;this.moveOrigin()}else{if(this.mode==this.BOARD_MODE_DRAG){e=new JXG.Coords(JXG.COORDS_BY_SCREEN,this.getScrCoordsOfMouse(x,y),this);if(this.drag_obj.type==JXG.OBJECT_TYPE_POINT||this.drag_obj.type==JXG.OBJECT_TYPE_LINE||this.drag_obj.type==JXG.OBJECT_TYPE_CIRCLE||this.drag_obj.type==JXG.OBJECT_TYPE_CURVE){if((this.geonextCompatibilityMode&&this.drag_obj.type==JXG.OBJECT_TYPE_POINT)||this.drag_obj.group.length!=0){this.drag_obj.setPositionDirectly(JXG.COORDS_BY_USER,e.usrCoords[1],e.usrCoords[2])}else{this.drag_obj.setPositionByTransform(JXG.COORDS_BY_USER,e.usrCoords[1]-this.dragObjCoords.usrCoords[1],e.usrCoords[2]-this.dragObjCoords.usrCoords[2]);this.dragObjCoords=e}this.update(this.drag_obj)}else{if(this.drag_obj.type==JXG.OBJECT_TYPE_GLIDER){var g=this.drag_obj.coords;this.drag_obj.setPositionDirectly(JXG.COORDS_BY_USER,e.usrCoords[1],e.usrCoords[2]);if(this.drag_obj.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){this.drag_obj.coords=this.algebra.projectPointToCircle(this.drag_obj,this.drag_obj.slideObject)}else{if(this.drag_obj.slideObject.type==JXG.OBJECT_TYPE_LINE){this.drag_obj.coords=this.algebra.projectPointToLine(this.drag_obj,this.drag_obj.slideObject)}}if(this.drag_obj.group.length!=0){this.drag_obj.group[this.drag_obj.group.length-1].dX=this.drag_obj.coords.scrCoords[1]-g.scrCoords[1];this.drag_obj.group[this.drag_obj.group.length-1].dY=this.drag_obj.coords.scrCoords[2]-g.scrCoords[2];this.drag_obj.group[this.drag_obj.group.length-1].update(this)}else{this.update(this.drag_obj)}}}this.updateInfobox(this.drag_obj)}else{for(b in this.objects){d=this.objects[b];if(d.hasPoint!=undefined&&d.visProp.visible==true&&d.hasPoint(x,y)){this.updateInfobox(d);if(this.highlightedObjects[b]==null){d.highlight();this.highlightedObjects[b]=d}}}}}this.updateQuality=this.BOARD_QUALITY_HIGH};JXG.Board.prototype.updateInfobox=function(b){var a,g,d,e;if((b.elementClass==JXG.OBJECT_CLASS_POINT)&&b.showInfobox){d=b.coords.usrCoords[1]*1;e=b.coords.usrCoords[2]*1;this.infobox.setCoords(d+this.infobox.distanceX/(this.stretchX),e+this.infobox.distanceY/(this.stretchY));a=Math.abs(d);if(a>0.1){a=d.toFixed(2)}else{if(a>=0.01){a=d.toFixed(4)}else{if(a>=0.0001){a=d.toFixed(6)}else{a=d}}}g=Math.abs(e);if(g>0.1){g=e.toFixed(2)}else{if(g>=0.01){g=e.toFixed(4)}else{if(g>=0.0001){g=e.toFixed(6)}else{g=e}}}this.highlightInfobox(a,g,b);this.renderer.show(this.infobox);this.renderer.updateText(this.infobox)}return this};JXG.Board.prototype.highlightInfobox=function(a,d,b){this.infobox.setText('<span style="color:#bbbbbb;">('+a+", "+d+")</span>");return this};JXG.Board.prototype.dehighlightAll=function(a,e){var b,d;for(b in this.highlightedObjects){d=this.highlightedObjects[b];if((d.hasPoint==undefined)||(!d.hasPoint(a,e))||(d.visProp.visible==false)){d.noHighlight();delete (this.highlightedObjects[b])}}return this};JXG.Board.prototype.getScrCoordsOfMouse=function(a,d){if(this.snapToGrid){var b=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,d],this);b.setCoordinates(JXG.COORDS_BY_USER,[Math.round((b.usrCoords[1])*this.snapSizeX)/this.snapSizeX,Math.round((b.usrCoords[2])*this.snapSizeY)/this.snapSizeY]);return[b.scrCoords[1],b.scrCoords[2]]}else{return[a,d]}};JXG.Board.prototype.getUsrCoordsOfMouse=function(g){var d=this.getRelativeMouseCoordinates(g);var b=JXG.getPosition(g);var a=b[0]-d[0];var h=b[1]-d[1];var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,h],this);if(this.snapToGrid){e.setCoordinates(JXG.COORDS_BY_USER,[Math.round((e.usrCoords[1])*this.snapSizeX)/this.snapSizeX,Math.round((e.usrCoords[2])*this.snapSizeY)/this.snapSizeY])}return[e.usrCoords[1],e.usrCoords[2]]};JXG.Board.prototype.getAllUnderMouse=function(b){var a=this.getAllObjectsUnderMouse(b);a.push(this.getUsrCoordsOfMouse(b));return a};JXG.Board.prototype.getAllObjectsUnderMouse=function(k){var h=this.getRelativeMouseCoordinates(k);var a=JXG.getPosition(k);var d=a[0]-h[0];var b=a[1]-h[1];var e=[];for(var g in this.objects){if(this.objects[g].visProp.visible&&this.objects[g].hasPoint(d,b)){e.push(this.objects[g])}}return e};JXG.Board.prototype.setBoardMode=function(a){this.mode=a;return this};JXG.Board.prototype.moveOrigin=function(){for(var a in this.objects){if((this.objects[a].elementClass==JXG.OBJECT_CLASS_POINT)||(this.objects[a].type==JXG.OBJECT_TYPE_CURVE)||(this.objects[a].type==JXG.OBJECT_TYPE_AXIS)||(this.objects[a].type==JXG.OBJECT_TYPE_TEXT)){if((this.objects[a].type!=JXG.OBJECT_TYPE_CURVE)&&(this.objects[a].type!=JXG.OBJECT_TYPE_AXIS)){this.objects[a].coords.usr2screen()}}}this.clearTraces();this.fullUpdate();if(this.hasGrid){this.renderer.removeGrid(this);this.renderer.drawGrid(this)}return this};JXG.Board.prototype.finalizeAdding=function(a){if(a.hasLabel){this.renderer.drawText(a.label.content)}if(!a.visProp.visible){this.renderer.hide(a)}if(a.hasLabel&&!a.label.content.visProp.visible){this.renderer.hide(a.label.content)}};JXG.Board.prototype.addPoint=function(a){var b=this.setId(a,"P");this.renderer.drawPoint(a);this.finalizeAdding(a);return b};JXG.Board.prototype.addLine=function(a){var b=this.setId(a,"L");this.renderer.drawLine(a);this.finalizeAdding(a);return b};JXG.Board.prototype.addCircle=function(a){var b=this.setId(a,"C");this.renderer.drawCircle(a);this.finalizeAdding(a);return b};JXG.Board.prototype.addPolygon=function(a){var b=this.setId(a,"Py");this.renderer.drawPolygon(a);this.finalizeAdding(a);return b};JXG.Board.prototype.addArc=function(a){var b=this.setId(a,"Ac");this.renderer.drawArc(a);this.finalizeAdding(a);return b};JXG.Board.prototype.addSector=function(a){return this.setId(a,"Sc")};JXG.Board.prototype.addAngle=function(a){var b=this.setId(a,"Ag");this.renderer.drawAngle(a);this.finalizeAdding(a);return b};JXG.Board.prototype.addCurve=function(a){var b=this.setId(a,"G");this.renderer.drawCurve(a);this.finalizeAdding(a);return b};JXG.Board.prototype.addChart=function(a){return this.setId(a,"Chart")};JXG.Board.prototype.addArrow=function(d){var b=this.numObjects,a;this.numObjects++;a=d.id;if((a=="")||(a==null)){a=this.id+"A"+b}this.objects[a]=d;d.id=a;this.renderer.drawArrow(d);return a};JXG.Board.prototype.addNormal=function(g,d,b,a){var s=JXG.getReference(this,d);var u=JXG.getReference(this,g);var h=this.numObjects;h++;if((b=="")||(b==null)){b=this.id+"L"+h}var q=this.algebra.perpendicular(u,s);var k=q[0].usrCoords.slice(1);var m=new JXG.Point(this,k,b+"P2","",false);m.fixed=true;s.addChild(m);u.addChild(m);var e;if(q[1]){e=new JXG.Line(this,m.id,s.id,b,a)}else{e=new JXG.Line(this,s.id,m.id,b,a)}e.changed=q[1];e.update=function(){if(this.needsUpdate){var w=this.board.algebra.perpendicular(u,s);m.coords=w[0];if(this.changed!=w[1]){var l=this.point1;this.point1=this.point2;this.point2=l}this.updateStdform();if(this.traced){this.cloneToBackground(true)}}};return e};JXG.Board.prototype.addIntersection=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"I"+b}this.objects[a]=d;d.id=a;d.intersect1.addChild(d);d.intersect2.addChild(d);return a};JXG.Board.prototype.addText=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"T"+b}this.objects[a]=d;d.id=a;if(!d.isLabel){this.renderer.drawText(d);if(!d.visProp.visible){this.renderer.hide(d)}}return a};JXG.Board.prototype.addConditions=function(s){var q=null;var b="var el,x,y,c;\n";var l=s.indexOf("<data>");var k=s.indexOf("</data>");if(l<0){return}while(l>=0){var h=s.slice(l+6,k);var g=h.indexOf("=");var e=h.slice(0,g);var w=h.slice(g+1);g=e.indexOf(".");var a=e.slice(0,g);var d=this.elementsByName[JXG.unescapeHTML(a)];var u=e.slice(g+1).replace(/\s+/g,"").toLowerCase();w=this.algebra.geonext2JS(w);w=w.replace(/this\.board\./g,"this.");if(typeof this.elementsByName[a]=="undefined"){alert("debug conditions: |"+a+"| undefined")}b+='el = this.objects["'+d.id+'"];\n';switch(u){case"x":b+="y=el.coords.usrCoords[2];\n";b+="el.setPositionDirectly(JXG.COORDS_BY_USER,"+(w)+",y);\n";b+="el.update();\n";break;case"y":b+="x=el.coords.usrCoords[1];\n";b+="el.coords=new JXG.Coords(JXG.COORDS_BY_USER,[x,"+(w)+"],this);\n";break;case"visible":b+="c="+(w)+";\n";b+="if (c) {el.showElement();} else {el.hideElement();}\n";break;case"position":b+="el.position = "+(w)+";\n";b+="el.update();\n";break;case"stroke":b+="el.strokeColor = "+(w)+";\n";break;case"strokewidth":b+="el.strokeWidth = "+(w)+";\n";break;case"label":break;default:alert("property '"+u+"' in conditions not implemented:"+w);break}s=s.slice(k+7);l=s.indexOf("<data>");k=s.indexOf("</data>")}b+="this.prepareUpdate();\n";b+="this.updateElements();\n";b+="return true;\n";this.updateConditions=new Function(b);this.updateConditions()};JXG.Board.prototype.updateConditions=function(){return false};JXG.Board.prototype.addImage=function(d){var b=this.numObjects;this.numObjects++;var a=d.id;if((a=="")||(a==null)){a=this.id+"Im"+b}this.objects[a]=d;this.elementsByName[d.name]=d;d.id=a;this.renderer.drawImage(d);if(!d.visProp.visible){this.renderer.hide(d)}return a};JXG.Board.prototype.addIntegral=function(g,k,a,u,s){var b={},e=0,m=0,w,z,h,l,q,A,d;if(!JXG.isArray(a)||(a.length!=5)){a=["","","","",""]}if(!JXG.isArray(u)||(u.length!=5)){u=["","","","",""]}if((typeof s!="undefined")&&(s!=null)){b=s}b.name=u[0];b.id=a[0];if(g[0]>k.points[0].usrCoords[1]){e=g[0]}else{e=k.points[0].usrCoords[1]}if(g[1]<k.points[k.points.length-1].usrCoords[1]){m=g[1]}else{m=k.points[k.points.length-1].usrCoords[1]}w=this.createElement("glider",[e,k.yterm(e),k],b);b.name=u[1];b.id=a[1];b.visible=false;z=this.createElement("point",[function(){return w.X()},0],b);w.addChild(z);b.name=u[2];b.id=a[2];b.visible=true;h=this.createElement("glider",[m,k.yterm(m),k],b);b.name=u[3];b.id=a[3];b.visible=false;l=this.createElement("point",[function(){return h.X()},0],b);h.addChild(l);q=JXG.Math.Numerics.I([e,m],k.yterm);A=this.createElement("text",[function(){return h.X()+0.2},function(){return h.Y()-0.8},function(){var B=JXG.Math.Numerics.I([z.X(),l.X()],k.yterm);return"&int; = "+(B).toFixed(4)}],{labelColor:s.labelColor});b={};if((typeof s!="undefined")&&(s!=null)){b=s}b.name=u[4];b.id=a[4];b.visible=true;b.fillColor=b.fillColor||this.options.polygon.fillColor;b.highlightFillColor=b.highlightFillColor||this.options.polygon.highlightFillColor;b.fillOpacity=b.fillOpacity||this.options.polygon.fillOpacity;b.highlightFillOpacity=b.highlightFillOpacity||this.options.polygon.highlightFillOpacity;b.strokeWidth=0;b.strokeOpacity=0;d=this.createElement("curve",[[0],[0]],b);d.updateDataArray=function(){var B=[z.coords.usrCoords[1],w.coords.usrCoords[1]],D=[z.coords.usrCoords[2],w.coords.usrCoords[2]],C;for(C=0;C<k.numberPoints;C++){if((z.X()<=k.points[C].usrCoords[1])&&(k.points[C].usrCoords[1]<=l.X())){B.push(k.points[C].usrCoords[1]);D.push(k.points[C].usrCoords[2])}}B.push(h.coords.usrCoords[1]);D.push(h.coords.usrCoords[2]);B.push(l.coords.usrCoords[1]);D.push(l.coords.usrCoords[2]);B.push(z.coords.usrCoords[1]);D.push(z.coords.usrCoords[2]);this.dataX=B;this.dataY=D};w.addChild(d);h.addChild(d);w.addChild(A);h.addChild(A);return d};JXG.Board.prototype.calculateSnapSizes=function(){var d=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this),b=new JXG.Coords(JXG.COORDS_BY_USER,[1/this.gridX,1/this.gridY],this),a=d.scrCoords[1]-b.scrCoords[1],e=d.scrCoords[2]-b.scrCoords[2];this.snapSizeX=this.gridX;while(Math.abs(a)>25){this.snapSizeX*=2;a/=2}this.snapSizeY=this.gridY;while(Math.abs(e)>25){this.snapSizeY*=2;e/=2}return this};JXG.Board.prototype.applyZoom=function(){var a;for(a in this.objects){if((this.objects[a].elementClass==JXG.OBJECT_CLASS_POINT)||(this.objects[a].type==JXG.OBJECT_TYPE_CURVE)||(this.objects[a].type==JXG.OBJECT_TYPE_AXIS)||(this.objects[a].type==JXG.OBJECT_TYPE_TEXT)){if((this.objects[a].type!=JXG.OBJECT_TYPE_CURVE)&&(this.objects[a].type!=JXG.OBJECT_TYPE_AXIS)){this.objects[a].coords.usr2screen()}}}this.calculateSnapSizes();this.clearTraces();this.fullUpdate();if(this.hasGrid){this.renderer.removeGrid(this);this.renderer.drawGrid(this)}return this};JXG.Board.prototype.zoomIn=function(){var b,a;this.zoomX*=this.options.zoom.factor;this.zoomY*=this.options.zoom.factor;b=this.origin.scrCoords[1]*this.options.zoom.factor;a=this.origin.scrCoords[2]*this.options.zoom.factor;this.origin=new JXG.Coords(JXG.COORDS_BY_SCREEN,[b,a],this);this.stretchX=this.zoomX*this.unitX;this.stretchY=this.zoomY*this.unitY;this.applyZoom();return this};JXG.Board.prototype.zoomOut=function(){var b,a;this.zoomX/=this.options.zoom.factor;this.zoomY/=this.options.zoom.factor;b=this.origin.scrCoords[1]/this.options.zoom.factor;a=this.origin.scrCoords[2]/this.options.zoom.factor;this.origin=new JXG.Coords(JXG.COORDS_BY_SCREEN,[b,a],this);this.stretchX=this.zoomX*this.unitX;this.stretchY=this.zoomY*this.unitY;this.applyZoom();return this};JXG.Board.prototype.zoom100=function(){var e,b,d,a;d=this.zoomX;a=this.zoomY;this.zoomX=1;this.zoomY=1;e=this.origin.scrCoords[1]/d;b=this.origin.scrCoords[2]/a;this.origin=new JXG.Coords(JXG.COORDS_BY_SCREEN,[e,b],this);this.stretchX=this.zoomX*this.unitX;this.stretchY=this.zoomY*this.unitY;this.applyZoom();return this};JXG.Board.prototype.zoomAllPoints=function(){var s,l,e,k,b,h,m,A,z,w,u,q,g,d,a,B;s=this.zoomX/this.zoomY;l=0;e=0;k=0;b=0;for(h in this.objects){if((this.objects[h].elementClass==JXG.OBJECT_CLASS_POINT)&&this.objects[h].visProp.visible){if(this.objects[h].coords.usrCoords[1]<l){l=this.objects[h].coords.usrCoords[1]}else{if(this.objects[h].coords.usrCoords[1]>e){e=this.objects[h].coords.usrCoords[1]}}if(this.objects[h].coords.usrCoords[2]>b){b=this.objects[h].coords.usrCoords[2]}else{if(this.objects[h].coords.usrCoords[2]<k){k=this.objects[h].coords.usrCoords[2]}}}}m=50;A=m/(this.unitX*this.zoomX);z=m/(this.unitY*this.zoomY);w=e-l+2*A;u=b-k+2*z;q=Math.min(this.canvasWidth/(this.unitX*w),this.canvasHeight/(this.unitY*u));d=q;g=q*s;a=-(l-A)*this.unitX*g;B=(b+z)*this.unitY*d;this.origin=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,B],this);this.zoomX=g;this.zoomY=d;this.stretchX=this.zoomX*this.unitX;this.stretchY=this.zoomY*this.unitY;this.applyZoom();return this};JXG.Board.prototype.removeObject=function(a){var d,b;if(JXG.isArray(a)){for(b=0;b<a.length;b++){this.removeObject(a[b])}}a=JXG.getReference(this,a);if(a==undefined){return this}try{for(d in a.childElements){a.childElements[d].board.removeObject(a.childElements[d])}for(d in this.objects){if(typeof this.objects[d].childElements!="undefined"){delete (this.objects[d].childElements[a.id])}}delete (this.objects[a.id]);delete (this.elementsByName[a.name]);if(a.remove!=undefined){a.remove()}}catch(g){}return this};JXG.Board.prototype.initGeonextBoard=function(){var g,e,d,b,a;g=new JXG.Point(this,[0,0],this.id+"gOOe0","Ursprung",false);g.fixed=true;e=new JXG.Point(this,[1,0],this.id+"gXOe0","Punkt_1_0",false);e.fixed=true;d=new JXG.Point(this,[0,1],this.id+"gYOe0","Punkt_0_1",false);d.fixed=true;b=new JXG.Line(this,this.id+"gOOe0",this.id+"gXOe0",this.id+"gXLe0","X-Achse");b.hideElement();a=new JXG.Line(this,this.id+"gOOe0",this.id+"gYOe0",this.id+"gYLe0","Y-Achse");a.hideElement();return this};JXG.Board.prototype.initInfobox=function(){this.infobox=new JXG.Text(this,"0,0","",[0,0],this.id+"__infobox",null,null,false,"html");this.infobox.distanceX=-20;this.infobox.distanceY=25;this.renderer.hide(this.infobox);return this};JXG.Board.prototype.resizeContainer=function(a,b){this.canvasWidth=1*a;this.canvasHeight=1*b;this.containerObj.style.width=(this.canvasWidth)+"px";this.containerObj.style.height=(this.canvasHeight)+"px";return this};JXG.Board.prototype.showDependencies=function(){var d,b,g,e,a;b="<p>\n";for(d in this.objects){a=0;for(g in this.objects[d].childElements){a++}if(a>=0){b+="<b>"+this.objects[d].id+":</b> "}for(g in this.objects[d].childElements){b+=this.objects[d].childElements[g].id+"("+this.objects[d].childElements[g].name+"), "}b+="<p>\n"}b+="</p>\n";e=window.open();e.document.open();e.document.write(b);e.document.close();return this};JXG.Board.prototype.showXML=function(){var a=window.open("");a.document.open();a.document.write("<pre>"+JXG.escapeHTML(this.xmlString)+"</pre>");a.document.close();return this};JXG.Board.prototype.prepareUpdate=function(b){var a;for(a in this.objects){this.objects[a].needsUpdate=true}return this};JXG.Board.prototype.updateElements=function(b){var a,e,d=true;b=JXG.getReference(this,b);if(b==null){d=false}for(a in this.objects){e=this.objects[a];if(b!=null&&e.id!=b.id){d=false}if(!(d||this.needsFullUpdate||e.needsRegularUpdate)){continue}if(b==null||e.id!=b.id){e.update(true)}else{e.update(false)}}return this};JXG.Board.prototype.updateRenderer=function(b){var a,d;b=JXG.getReference(this,b);for(a in this.objects){d=this.objects[a];if(!this.needsFullUpdate&&!d.needsRegularUpdate){continue}if(b==null||d.id!=b.id){d.updateRenderer()}else{d.updateRenderer()}}return this};JXG.Board.prototype.addHook=function(a){this.hooks.push(a);a(this);return(this.hooks.length-1)};JXG.Board.prototype.removeHook=function(a){this.hooks[a]=null;return this};JXG.Board.prototype.updateHooks=function(){var a;for(a=0;a<this.hooks.length;a++){if(this.hooks[a]!=null){this.hooks[a](this)}}return this};JXG.Board.prototype.addChild=function(a){this.dependentBoards.push(a);this.update();return this};JXG.Board.prototype.removeChild=function(b){var a;for(a=this.dependentBoards.length-1;a>=0;a--){if(this.dependentBoards[a]==b){this.dependentBoards.splice(a,1)}}return this};JXG.Board.prototype.update=function(d){var b,a,e;if(this.isSuspendedUpdate){return this}this.prepareUpdate(d).updateElements(d).updateConditions();this.renderer.suspendRedraw();this.updateRenderer(d);this.renderer.unsuspendRedraw();this.updateHooks();a=this.dependentBoards.length;for(b=0;b<a;b++){e=this.dependentBoards[b].id;if(JXG.JSXGraph.boards[e]!=this){JXG.JSXGraph.boards[e].updateQuality=this.updateQuality;JXG.JSXGraph.boards[e].prepareUpdate(d).updateElements(d).updateConditions();JXG.JSXGraph.boards[e].renderer.suspendRedraw();JXG.JSXGraph.boards[e].updateRenderer(d);JXG.JSXGraph.boards[e].renderer.unsuspendRedraw();JXG.JSXGraph.boards[e].updateHooks()}}return this};JXG.Board.prototype.fullUpdate=function(){this.needsFullUpdate=true;this.update();this.needsFullUpdate=false;return this};JXG.Board.prototype.createElement=function(b,d,a){var h,e,g;if(b!="turtle"&&(d==null||d.length==0)){return null}if(d==null){d=[]}b=b.toLowerCase();if(a==null){a={}}for(e=0;e<d.length;e++){d[e]=JXG.getReference(this,d[e])}if(JXG.JSXGraph.elements[b]!=null){h=JXG.JSXGraph.elements[b](this,d,a)}else{throw new Error("JSXGraph: JXG.createElement: Unknown element type given: "+b)}if(h==undefined){return}if(JXG.isArray(a)){a=a[0]}if(h.multipleElements){for(g in h){if(typeof h[g].setProperty!="undefined"){h[g].setProperty(a)}}}else{if(typeof h.setProperty!="undefined"){h.setProperty(a)}}this.update(h);return h};JXG.Board.prototype.create=JXG.Board.prototype.createElement;JXG.Board.prototype.clearTraces=function(){var a;for(a in this.objects){if(this.objects[a].traced){this.objects[a].clearTrace()}}return this};JXG.Board.prototype.beforeLoad=function(){};JXG.Board.prototype.afterLoad=function(){};JXG.Board.prototype.suspendUpdate=function(){this.isSuspendedUpdate=true};JXG.Board.prototype.unsuspendUpdate=function(){this.isSuspendedUpdate=false;this.update()};JXG.Board.prototype.setBoundingBox=function(e,b){if(!JXG.isArray(e)){return}var d,a;a=this.canvasWidth;d=this.canvasHeight;if(b){this.unitX=a/(e[2]-e[0]);this.unitY=d/(-e[3]+e[1]);if(this.unitX>this.unitY){this.unitY=this.unitX}else{this.unitX=this.unitY}}else{this.unitX=a/(e[2]-e[0]);this.unitY=d/(-e[3]+e[1])}this.originX=-this.unitX*e[0];this.originY=this.unitY*e[1];this.stretchX=this.zoomX*this.unitX;this.stretchY=this.zoomY*this.unitY;this.moveOrigin();return this};JXG.Board.prototype.animate=function(){var d=0,a,h,g,b,e,k;for(a in this.animationObjects){if(this.animationObjects[a]==null){continue}d++;h=this.animationObjects[a];if(h.animationPath){g=h.animationPath.pop();if(typeof g=="undefined"){delete (h.animationPath)}else{h.setPositionByTransform(JXG.COORDS_BY_USER,g[0]-h.coords.usrCoords[1],g[1]-h.coords.usrCoords[2])}}if(h.animationData){k=0;for(b in h.animationData){e=h.animationData[b].pop();if(typeof e=="undefined"){delete (h.animationData[e])}else{k++;h.setProperty(b+":"+e)}}if(k==0){delete (h.animationData)}}if(typeof h.animationData=="undefined"&&typeof h.animationPath=="undefined"){this.animationObjects[a]=null;delete (this.animationObjects[a])}}if(d==0){window.clearInterval(this.animationIntervalCode);delete (this.animationIntervalCode)}else{this.update()}};JXG.Options={fontSize:12,showCopyright:true,showNavigation:true,takeSizeFromFile:true,renderer:"svg",grid:{hasGrid:false,gridX:2,gridY:2,gridColor:"#C0C0C0",gridOpacity:"0.5",gridDash:true,snapToGrid:false,snapSizeX:2,snapSizeY:2},zoom:{factor:1.25},elements:{color:{strokeOpacity:1,highlightStrokeOpacity:1,fillOpacity:1,highlightFillOpacity:1,strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF",fillColor:"none",highlightFillColor:"none"},strokeWidth:"2px",draft:{draft:false,color:"#565656",opacity:0.8,strokeWidth:"1px"}},point:{style:5,fillColor:"#ff0000",highlightFillColor:"#EEEEEE",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF"},line:{firstArrow:false,lastArrow:false,straightFirst:true,straightLast:true,fillColor:"#000000",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#888888",ticks:{drawLabels:true,drawZero:false,insertTicks:false,minTicksDistance:50,maxTicksDistance:300,minorHeight:4,majorHeight:10,minorTicks:4,defaultDistance:1}},circle:{fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF"},angle:{radius:1,fillColor:"#FF7F00",highlightFillColor:"#FF7F00",strokeColor:"#FF7F00",fillOpacity:0.3,highlightFillOpacity:0.3},arc:{firstArrow:false,lastArrow:false,fillColor:"none",highlightFillColor:"none",strokeColor:"#0000ff",highlightStrokeColor:"#C3D9FF"},polygon:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:0.3,highlightFillOpacity:0.3},sector:{fillColor:"#00FF00",highlightFillColor:"#00FF00",fillOpacity:0.3,highlightFillOpacity:0.3},text:{strokeColor:"#000000",useASCIIMathML:false,defaultDisplay:"html"},curve:{strokeWidth:"1px",strokeColor:"#0000ff",RDPsmoothing:false,numberPointsHigh:1600,numberPointsLow:400,doAdvancedPlot:true},precision:{hasPoint:4,epsilon:0.0001}};JXG.useStandardOptions=function(e){var g=JXG.Options,d=e.hasGrid,b,a;e.hasGrid=g.grid.hasGrid;e.gridX=g.grid.gridX;e.gridY=g.grid.gridY;e.gridColor=g.grid.gridColor;e.gridOpacity=g.grid.gridOpacity;e.gridDash=g.grid.gridDash;e.snapToGrid=g.grid.snapToGrid;e.snapSizeX=g.grid.SnapSizeX;e.snapSizeY=g.grid.SnapSizeY;e.takeSizeFromFile=g.takeSizeFromFile;for(b in e.objects){p=e.objects[b];if(p.elementClass==JXG.OBJECT_CLASS_POINT){p.visProp.fillColor=g.point.fillColor;p.visProp.highlightFillColor=g.point.highlightFillColor;p.visProp.strokeColor=g.point.strokeColor;p.visProp.highlightStrokeColor=g.point.highlightStrokeColor}else{if(p.elementClass==JXG.OBJECT_CLASS_LINE){p.visProp.fillColor=g.line.fillColor;p.visProp.highlightFillColor=g.line.highlightFillColor;p.visProp.strokeColor=g.line.strokeColor;p.visProp.highlightStrokeColor=g.line.highlightStrokeColor;for(a in p.ticks){a.majorTicks=g.line.ticks.majorTicks;a.minTicksDistance=g.line.ticks.minTicksDistance;a.minorHeight=g.line.ticks.minorHeight;a.majorHeight=g.line.ticks.majorHeight}}else{if(p.elementClass==JXG.OBJECT_CLASS_CIRCLE){p.visProp.fillColor=g.circle.fillColor;p.visProp.highlightFillColor=g.circle.highlightFillColor;p.visProp.strokeColor=g.circle.strokeColor;p.visProp.highlightStrokeColor=g.circle.highlightStrokeColor}else{if(p.type==JXG.OBJECT_TYPE_ANGLE){p.visProp.fillColor=g.angle.fillColor;p.visProp.highlightFillColor=g.angle.highlightFillColor;p.visProp.strokeColor=g.angle.strokeColor}else{if(p.type==JXG.OBJECT_TYPE_ARC){p.visProp.fillColor=g.arc.fillColor;p.visProp.highlightFillColor=g.arc.highlightFillColor;p.visProp.strokeColor=g.arc.strokeColor;p.visProp.highlightStrokeColor=g.arc.highlightStrokeColor}else{if(p.type==JXG.OBJECT_TYPE_POLYGON){p.visProp.fillColor=g.polygon.fillColor;p.visProp.highlightFillColor=g.polygon.highlightFillColor;p.visProp.fillOpacity=g.polygon.fillOpacity;p.visProp.highlightFillOpacity=g.polygon.highlightFillOpacity}else{if(p.type==JXG.OBJECT_TYPE_CURVE){p.visProp.strokeColor=g.curve.strokeColor}}}}}}}}for(b in e.objects){p=e.objects[b];if(p.type==JXG.OBJECT_TYPE_SECTOR){p.arc.visProp.fillColor=g.sector.fillColor;p.arc.visProp.highlightFillColor=g.sector.highlightFillColor;p.arc.visProp.fillOpacity=g.sector.fillOpacity;p.arc.visProp.highlightFillOpacity=g.sector.highlightFillOpacity}}e.fullUpdate();if(d&&e.hasGrid){e.renderer.removeGrid(e);e.renderer.drawGrid(e)}else{if(d&&!e.hasGrid){e.renderer.removeGrid(e)}else{if(!d&&e.hasGrid){e.renderer.drawGrid(e)}}}};JXG.useBlackWhiteOptions=function(a){o=JXG.Options;o.point.fillColor=JXG.rgb2bw(o.point.fillColor);o.point.highlightFillColor=JXG.rgb2bw(o.point.highlightFillColor);o.point.strokeColor=JXG.rgb2bw(o.point.strokeColor);o.point.highlightStrokeColor=JXG.rgb2bw(o.point.highlightStrokeColor);o.line.fillColor=JXG.rgb2bw(o.line.fillColor);o.line.highlightFillColor=JXG.rgb2bw(o.line.highlightFillColor);o.line.strokeColor=JXG.rgb2bw(o.line.strokeColor);o.line.highlightStrokeColor=JXG.rgb2bw(o.line.highlightStrokeColor);o.circle.fillColor=JXG.rgb2bw(o.circle.fillColor);o.circle.highlightFillColor=JXG.rgb2bw(o.circle.highlightFillColor);o.circle.strokeColor=JXG.rgb2bw(o.circle.strokeColor);o.circle.highlightStrokeColor=JXG.rgb2bw(o.circle.highlightStrokeColor);o.arc.fillColor=JXG.rgb2bw(o.arc.fillColor);o.arc.highlightFillColor=JXG.rgb2bw(o.arc.highlightFillColor);o.arc.strokeColor=JXG.rgb2bw(o.arc.strokeColor);o.arc.highlightStrokeColor=JXG.rgb2bw(o.arc.highlightStrokeColor);o.polygon.fillColor=JXG.rgb2bw(o.polygon.fillColor);o.polygon.highlightFillColor=JXG.rgb2bw(o.polygon.highlightFillColor);o.sector.fillColor=JXG.rgb2bw(o.sector.fillColor);o.sector.highlightFillColor=JXG.rgb2bw(o.sector.highlightFillColor);o.curve.strokeColor=JXG.rgb2bw(o.curve.strokeColor);o.grid.gridColor=JXG.rgb2bw(o.grid.gridColor);JXG.useStandardOptions(a)};JXG.rgb2bw=function(d){if(d=="none"){return d}var b,g="0123456789ABCDEF",e,a;a=JXG.rgbParser(d);b=0.3*a[0]+0.59*a[1]+0.11*a[2];e=g.charAt((b>>4)&15)+g.charAt(b&15);d="#"+e+""+e+""+e;return d};JXG.loadOptionsFromFile=function(b,d,a){this.cbp=function(e){this.parseString(e,d,a)};this.cb=JXG.bind(this.cbp,this);JXG.FileReader.parseFileContent(b,this.cb,"raw")};JXG.parseOptionsString=function(text,applyTo,board){var newOptions="";if(text!=""){newOptions=eval("("+text+")")}else{return}var maxDepth=10;var applyOption=function(base,option,depth){if(depth==10){return}depth++;for(var key in option){if((JXG.isNumber(option[key]))||(JXG.isArray(option[key]))||(JXG.isString(option[key]))||(option[key]==true)||(option[key]==false)){base[key]=option[key]}else{applyOption(base[key],option[key],depth)}}};applyOption(this,newOptions,0);if(applyTo&&typeof board!="undefined"){JXG.useStandardOptions(board)}};JXG.JSXGraph=new function(){var g,b,e,a;this.licenseText="JSXGraph v0.79rc1 Copyright (C) see http://jsxgraph.org";this.rendererType="";this.boards={};this.elements={};if((typeof forceRenderer=="undefined")||(forceRenderer==null)||(forceRenderer=="")){g=navigator.appVersion.match(/MSIE (\d\.\d)/);b=(navigator.userAgent.toLowerCase().indexOf("opera")!=-1);if((!g)||(b)){JXG.Options.renderer="svg"}else{JXG.Options.renderer="vml";function d(h){document.body.scrollLeft;document.body.scrollTop}document.onmousemove=d}}else{this.rendererType=forceRenderer}a=JXG.rendererFiles[JXG.Options.renderer].split(",");for(e=0;e<a.length;e++){(function(h){JXG.require(JXG.requirePath+h+".js")})(a[e])}this.initBoard=function(q,l){var A,J,I,D,B,F,m,k,H,G,E,C,z,s,u;k=JXG.getDimensions(q);if(typeof l=="undefined"){l={}}if(typeof l.boundingbox!="undefined"){H=l.boundingbox;F=parseInt(k.width);m=parseInt(k.height);if(l.keepaspectratio){D=F/(H[2]-H[0]);B=m/(-H[3]+H[1]);if(D>B){B=D}else{D=B}}else{D=F/(H[2]-H[0]);B=m/(-H[3]+H[1])}J=-D*H[0];I=B*H[1]}else{J=((typeof l.originX)=="undefined"?150:l.originX);I=((typeof l.originY)=="undefined"?150:l.originY);D=((typeof l.unitX)=="undefined"?50:l.unitX);B=((typeof l.unitY)=="undefined"?50:l.unitY)}G=((typeof l.zoom)=="undefined"?1:l.zoom);E=G*((typeof l.zoomX)=="undefined"?1:l.zoomX);C=G*((typeof l.zoomY)=="undefined"?1:l.zoomY);if(typeof l.showcopyright!="undefined"){l.showCopyright=l.showcopyright}z=((typeof l.showCopyright)=="undefined"?true:l.showCopyright);if(JXG.Options.renderer=="svg"){A=new JXG.SVGRenderer(document.getElementById(q))}else{if(JXG.Options.renderer=="vml"){A=new JXG.VMLRenderer(document.getElementById(q))}else{A=new JXG.SilverlightRenderer(document.getElementById(q),k.width,k.height)}}u=new JXG.Board(q,A,"",[J,I],1,1,D,B,k.width,k.height,z);this.boards[u.id]=u;u.initInfobox();if((typeof l.axis!="undefined")&&l.axis){u.defaultAxes={};u.defaultAxes.x=u.createElement("axis",[[0,0],[1,0]],{});u.defaultAxes.y=u.createElement("axis",[[0,0],[0,1]],{})}if((typeof l.grid!="undefined")&&l.grid){u.renderer.drawGrid(u)}if(typeof l.shownavigation!="undefined"){l.showNavigation=l.shownavigation}s=((typeof l.showNavigation)=="undefined"?u.options.showNavigation:l.showNavigation);if(s){u.renderer.drawZoomBar(u)}return u};this.loadBoardFromFile=function(m,h,s){var q,k,l;if(JXG.Options.renderer=="svg"){q=new JXG.SVGRenderer(document.getElementById(m))}else{q=new JXG.VMLRenderer(document.getElementById(m))}l=JXG.getDimensions(m);k=new JXG.Board(m,q,"",[150,150],1,1,50,50,l.width,l.height);k.initInfobox();k.beforeLoad();JXG.FileReader.parseFileContent(h,k,s);if(k.options.showNavigation){k.renderer.drawZoomBar(k)}this.boards[k.id]=k;return k};this.loadBoardFromString=function(m,h,s){var q,l,k;if(JXG.Options.renderer=="svg"){q=new JXG.SVGRenderer(document.getElementById(m))}else{q=new JXG.VMLRenderer(document.getElementById(m))}l=JXG.getDimensions(m);k=new JXG.Board(m,q,"",[150,150],1,1,50,50,l.width,l.height);k.initInfobox();k.beforeLoad();JXG.FileReader.parseString(h,k,s);if(k.options.showNavigation){k.renderer.drawZoomBar(k)}this.boards[k.id]=k;return k};this.freeBoard=function(k){var h;if(typeof(k)=="string"){k=this.boards[k]}JXG.removeEvent(document,"mousedown",k.mouseDownListener,k);JXG.removeEvent(document,"mouseup",k.mouseUpListener,k);JXG.removeEvent(k.containerObj,"mousemove",k.mouseMoveListener,k);for(h in k.objects){k.removeObject(k.objects[h])}k.containerObj.innerHTML="";for(h in k.objects){delete (k.objects[h])}delete (k.renderer);delete (k.algebra);delete (this.boards[k.id])};this.registerElement=function(h,k){h=h.toLowerCase();this.elements[h]=k;if(JXG.Board.prototype["_"+h]){throw new Error("JSXGraph: Can't create wrapper method in JXG.Board because member '_"+h+"' already exists'")}JXG.Board.prototype["_"+h]=function(m,l){return this.createElement(h,m,l)}};this.unregisterElement=function(h){delete (this.elements[h.toLowerCase()]);delete (JXG.Board.prototype["_"+h.toLowerCase()])}};JXG.getReference=function(b,a){if(typeof(a)=="string"){if(b.objects[a]!=null){a=b.objects[a]}else{if(b.elementsByName[a]!=null){a=b.elementsByName[a]}}}return a};JXG.isString=function(a){return typeof a=="string"};JXG.isNumber=function(a){return typeof a=="number"};JXG.isFunction=function(a){return typeof a=="function"};JXG.isArray=function(a){return a!=null&&typeof a=="object"&&"splice" in a&&"join" in a};JXG.isPoint=function(a){if(typeof a=="object"){return(a.elementClass==JXG.OBJECT_CLASS_POINT)}return false};JXG._board=function(b,a){return JXG.JSXGraph.initBoard(b,a)};JXG.createEvalFunction=function(b,g,h){var d=[],a,e;for(a=0;a<h;a++){if(typeof g[a]=="string"){e=b.algebra.geonext2JS(g[a]);e=e.replace(/this\.board\./g,"board.");d[a]=new Function("","return "+(e)+";")}}return function(m){var l=g[m];if(typeof l=="string"){return d[m]()}else{if(typeof l=="function"){return l()}else{if(typeof l=="number"){return l}}}return 0}};JXG.createFunction=function(b,d,e,g){var a;if((g==null||g==true)&&JXG.isString(b)){a=d.algebra.geonext2JS(b);return new Function(e,"return "+a+";")}else{if(JXG.isFunction(b)){return b}else{if(JXG.isNumber(b)){return function(){return b}}else{if(JXG.isString(b)){return function(){return b}}}}}return null};JXG.getDimensions=function(h){var g,l,d,m,k,b,a,e;g=document.getElementById(h);if(g==null){throw new Error("\nJSXGraph: HTML container element '"+(h)+"' not found.")}l=g.style.display;if(l!="none"&&l!=null){return{width:g.offsetWidth,height:g.offsetHeight}}d=g.style;m=d.visibility;k=d.position;b=d.display;d.visibility="hidden";d.position="absolute";d.display="block";a=g.clientWidth;e=g.clientHeight;d.display=b;d.position=k;d.visibility=m;return{width:a,height:e}};JXG.addEvent=function(e,d,b,a){a["x_internal"+d]=function(){return b.apply(a,arguments)};if(typeof e.addEventListener!="undefined"){e.addEventListener(d,a["x_internal"+d],false)}else{e.attachEvent("on"+d,a["x_internal"+d])}};JXG.removeEvent=function(h,d,b,a){try{if(typeof h.addEventListener!="undefined"){h.removeEventListener(d,a["x_internal"+d],false)}else{h.detachEvent("on"+d,a["x_internal"+d])}}catch(g){}};JXG.bind=function(b,a){return function(){return b.apply(a,arguments)}};JXG.getPosition=function(b){var a=0,d=0,b;if(!b){b=window.event}if(b.pageX||b.pageY){a=b.pageX;d=b.pageY}else{if(b.clientX||b.clientY){a=b.clientX+document.body.scrollLeft+document.documentElement.scrollLeft;d=b.clientY+document.body.scrollTop+document.documentElement.scrollTop}}return[a,d]};JXG.getOffset=function(d){var e=d,a=e.offsetLeft,b=e.offsetTop;while(e=e.offsetParent){a+=e.offsetLeft;b+=e.offsetTop;if(e.offsetParent){a+=e.clientLeft;b+=e.clientTop}}return[a,b]};JXG.getStyle=function(b,a){return b.style[a]};JXG.keys=function(a){var b=[],d;for(d in a){b.push(d)}return b};JXG.escapeHTML=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")};JXG.unescapeHTML=function(a){return a.replace(/<\/?[^>]+>/gi,"").replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">")};JXG.clone=function(b){var a={};a.prototype=b;return a};JXG.deepCopy=function(d){var g,b,e,a;if(typeof d!=="object"||d==null){return d}if(this.isArray(d)){g=[];for(b=0;b<d.length;b++){e=d[b];if(typeof e=="object"){if(this.isArray(e)){g[b]=[];for(a=0;a<e.length;a++){if(typeof e[a]!="object"){g[b].push(e[a])}else{g[b].push(this.deepCopy(e[a]))}}}else{g[b]=this.deepCopy(e)}}else{g[b]=e}}}else{g={};for(b in d){e=d[b];if(typeof e=="object"){if(this.isArray(e)){g[b]=[];for(a=0;a<e.length;a++){if(typeof e[a]!="object"){g[b].push(e[a])}else{g[b].push(this.deepCopy(e[a]))}}}else{g[b]=this.deepCopy(e)}}else{g[b]=e}}}return g};JXG.cloneAndCopy=function(e,d){var a={},b;a.prototype=e;for(b in d){a[b]=d[b]}return a};JXG.toJSON=function(d){switch(typeof d){case"object":if(d){var b=[];if(d instanceof Array){for(var a=0;a<d.length;a++){b.push(JXG.toJSON(d[a]))}return"["+b.join(",")+"]"}else{for(var e in d){b.push('"'+e+'":'+JXG.toJSON(d[e]))}return"{"+b.join(",")+"}"}}else{return"null"}case"string":return'"'+d.replace(/(["'])/g,"\\$1")+'"';case"number":case"boolean":return new String(d)}};JXG.capitalize=function(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()};JXG.timedChunk=function(b,e,d,g){var a=b.concat();setTimeout(function(){var h=+new Date();do{e.call(d,a.shift())}while(a.length>0&&(+new Date()-h<300));if(a.length>0){setTimeout(arguments.callee,1)}else{g(b)}},1)};JXG.OBJECT_TYPE_ARC=1330921795;JXG.OBJECT_TYPE_ARROW=1330921815;JXG.OBJECT_TYPE_AXIS=1330921816;JXG.OBJECT_TYPE_TICKS=1330926680;JXG.OBJECT_TYPE_CIRCLE=1330922316;JXG.OBJECT_TYPE_CURVE=1330923344;JXG.OBJECT_TYPE_GLIDER=1330923340;JXG.OBJECT_TYPE_IMAGE=1330926157;JXG.OBJECT_TYPE_LINE=1330924622;JXG.OBJECT_TYPE_POINT=1330925652;JXG.OBJECT_TYPE_SLIDER=1330926404;JXG.OBJECT_TYPE_CAS=1330922320;JXG.OBJECT_TYPE_POLYGON=1330925657;JXG.OBJECT_TYPE_SECTOR=1330926403;JXG.OBJECT_TYPE_TEXT=1330926661;JXG.OBJECT_TYPE_ANGLE=1330921799;JXG.OBJECT_TYPE_INTERSECTION=1330926158;JXG.OBJECT_TYPE_TURTLE=5198933;JXG.OBJECT_CLASS_POINT=1;JXG.OBJECT_CLASS_LINE=2;JXG.OBJECT_CLASS_CIRCLE=3;JXG.OBJECT_CLASS_CURVE=4;JXG.OBJECT_CLASS_AREA=5;JXG.OBJECT_CLASS_OTHER=6;JXG.GeometryElement=function(){this.board=null;this.id="";this.needsUpdate=true;this.name="";this.visProp={};JXG.clearVisPropOld(this);this.isReal=true;this.visProp.dash=0;this.childElements={};this.hasLabel=false;this.notExistingParents={};this.traced=false;this.traces={};this.numTraces=0;this.transformations=[];this.baseElement=null;this.descendants={};this.ancestors={};this.symbolic={};this.stdform=[1,0,0,0,1,1,0,0];this.quadraticform=[[1,0,0],[0,1,0],[0,0,1]];this.needsRegularUpdate=true};JXG.GeometryElement.prototype.init=function(b,d,a){if(typeof(b)=="string"){b=JXG.JSXGraph.boards[b]}this.board=b;this.id=d;if((a!=null)&&(typeof a!="undefined")){a=a}else{a=this.board.generateName(this)}this.board.elementsByName[a]=this;this.name=a;this.visProp.strokeColor=this.board.options.elements.color.strokeColor;this.visProp.highlightStrokeColor=this.board.options.elements.color.highlightStrokeColor;this.visProp.fillColor=this.board.options.elements.color.fillColor;this.visProp.highlightFillColor=this.board.options.elements.color.highlightFillColor;this.visProp.strokeWidth=this.board.options.elements.strokeWidth;this.visProp.strokeOpacity=this.board.options.elements.color.strokeOpacity;this.visProp.highlightStrokeOpacity=this.board.options.elements.color.highlightStrokeOpacity;this.visProp.fillOpacity=this.board.options.elements.color.fillOpacity;this.visProp.highlightFillOpacity=this.board.options.elements.color.highlightFillOpacity;this.visProp.draft=this.board.options.elements.draft.draft;this.visProp.visible=true;this.visProp.shadow=false;this.visProp.gradient="none";this.visProp.gradientSecondColor="black";this.visProp.gradientAngle="270";this.visProp.gradientSecondOpacity=this.visProp.fillOpacity;this.visProp.gradientPositionX=0.5;this.visProp.gradientPositionY=0.5};JXG.GeometryElement.prototype.addChild=function(d){var b,a;this.childElements[d.id]=d;this.addDescendants(d);d.ancestors[this.id]=this;for(b in this.descendants){this.descendants[b].ancestors[this.id]=this;for(a in this.ancestors){this.descendants[b].ancestors[this.ancestors[a].id]=this.ancestors[a]}}for(b in this.ancestors){for(a in this.descendants){this.ancestors[b].descendants[this.descendants[a].id]=this.descendants[a]}}return this};JXG.GeometryElement.prototype.addDescendants=function(b){var a;this.descendants[b.id]=b;for(a in b.childElements){this.addDescendants(b.childElements[a])}return this};JXG.GeometryElement.prototype.generatePolynomial=function(){return[]};JXG.GeometryElement.prototype.animate=function(e,d){var a,b,h=35,k=Math.ceil(d/(h*1)),g,m=this;this.animationData={};var q=function(D,C,A){var B,z,w,u,s;B=JXG.rgb2hsv(D);z=JXG.rgb2hsv(C);w=(z[0]-B[0])/(1*k);u=(z[1]-B[1])/(1*k);s=(z[2]-B[2])/(1*k);m.animationData[A]=new Array(k);for(g=0;g<k;g++){m.animationData[A][k-g-1]=JXG.hsv2rgb(B[0]+(g+1)*w,B[1]+(g+1)*u,B[2]+(g+1)*s)}},l=function(A,u,z){A=parseFloat(A);u=parseFloat(u);if(isNaN(A)||isNaN(u)){return}var w=(u-A)/(1*k);m.animationData[z]=new Array(k);for(g=0;g<k;g++){m.animationData[z][k-g-1]=A+(g+1)*w}};for(a in e){b=a.toLowerCase();switch(b){case"strokecolor":q(this.visProp.strokeColor,e[a],"strokeColor");break;case"strokeopacity":l(this.visProp.strokeOpacity,e[a],"strokeOpacity");break;case"strokewidth":l(this.visProp.strokeWidth,e[a],"strokeWidth");break;case"fillcolor":q(this.visProp.fillColor,e[a],"fillColor");break;case"fillopacity":l(this.visProp.fillOpacity,e[a],"fillOpacity");break}}this.board.animationObjects[this.id]=this;if(typeof this.board.animationIntervalCode=="undefined"){this.board.animationIntervalCode=window.setInterval("JXG.JSXGraph.boards['"+this.board.id+"'].animate();",h)}return this};JXG.GeometryElement.prototype.update=function(){if(this.traced){this.cloneToBackground(true)}return this};JXG.GeometryElement.prototype.updateRenderer=function(){};JXG.GeometryElement.prototype.hideElement=function(){this.visProp.visible=false;this.board.renderer.hide(this);if(this.label!=null&&this.hasLabel){this.label.hiddenByParent=true;if(this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}return this};JXG.GeometryElement.prototype.showElement=function(){this.visProp.visible=true;this.board.renderer.show(this);if(this.label!=null&&this.hasLabel&&this.label.hiddenByParent){this.label.hiddenByParent=false;if(this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}return this};JXG.GeometryElement.prototype.setProperty=function(){var h,g,d,b,e,k;for(h=0;h<arguments.length;h++){b=arguments[h];if(typeof b=="string"){k=b.split(":")}else{if(!JXG.isArray(b)){for(g in b){this.setProperty([g,b[g]])}return this}else{k=b}}if(k[1]==null){continue}switch(k[0].replace(/\s+/g).toLowerCase()){case"strokewidth":this.visProp.strokeWidth=k[1];this.board.renderer.setObjectStrokeWidth(this,this.visProp.strokeWidth);break;case"strokecolor":d=k[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.strokeColor=d;this.visProp.strokeOpacity=parseInt(e.toUpperCase(),16)/255;this.board.renderer.setObjectStrokeColor(this,this.visProp.strokeColor,this.visProp.strokeOpacity);break;case"fillcolor":d=k[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.fillColor=d;this.visProp.fillOpacity=parseInt(e.toUpperCase(),16)/255;this.board.renderer.setObjectFillColor(this,this.visProp.fillColor,this.visProp.fillOpacity);break;case"highlightstrokecolor":d=k[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.highlightStrokeColor=d;this.visProp.highlightStrokeOpacity=parseInt(e.toUpperCase(),16)/255;break;case"highlightfillcolor":d=k[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.highlightFillColor=d;this.visProp.highlightFillOpacity=parseInt(e.toUpperCase(),16)/255;break;case"fillopacity":this.visProp.fillOpacity=k[1];this.board.renderer.setObjectFillColor(this,this.visProp.fillColor,this.visProp.fillOpacity);break;case"strokeopacity":this.visProp.strokeOpacity=k[1];this.board.renderer.setObjectStrokeColor(this,this.visProp.strokeColor,this.visProp.strokeOpacity);break;case"highlightfillopacity":this.visProp.highlightFillOpacity=k[1];break;case"highlightstrokeopacity":this.visProp.highlightStrokeOpacity=k[1];break;case"labelcolor":d=k[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}if(e=="00"){if(this.label!=null&&this.hasLabel){this.label.content.hideElement()}}if(this.label!=null&&this.hasLabel){this.label.color=d;this.board.renderer.setObjectStrokeColor(this.label.content,d,e)}if(this.type==JXG.OBJECT_TYPE_TEXT){this.visProp.strokeColor=d;this.board.renderer.setObjectStrokeColor(this,this.visProp.strokeColor,1)}break;case"showinfobox":if(k[1]=="false"||k[1]==false){this.showInfobox=false}else{if(k[1]=="true"||k[1]==true){this.showInfobox=true}}break;case"visible":if(k[1]=="false"||k[1]==false){this.visProp.visible=false;this.hideElement()}else{if(k[1]=="true"||k[1]==true){this.visProp.visible=true;this.showElement()}}break;case"dash":this.setDash(k[1]);break;case"trace":if(k[1]=="false"||k[1]==false){this.traced=false}else{if(k[1]=="true"||k[1]==true){this.traced=true}}break;case"style":this.setStyle(1*k[1]);break;case"face":if(this.elementClass==JXG.OBJECT_CLASS_POINT){this.setFace(k[1])}break;case"size":if(this.elementClass==JXG.OBJECT_CLASS_POINT){this.visProp.size=1*k[1];this.board.renderer.updatePoint(this)}break;case"fixed":this.fixed=((k[1]=="false")||(k[1]==false))?false:true;break;case"shadow":if(k[1]=="false"||k[1]==false){this.visProp.shadow=false}else{if(k[1]=="true"||k[1]==true){this.visProp.shadow=true}}this.board.renderer.setShadow(this);break;case"gradient":this.visProp.gradient=k[1];this.board.renderer.setGradient(this);break;case"gradientsecondcolor":d=k[1];if(d.length=="9"&&d.substr(0,1)=="#"){e=d.substr(7,2);d=d.substr(0,7)}else{e="FF"}this.visProp.gradientSecondColor=d;this.visProp.gradientSecondOpacity=parseInt(e.toUpperCase(),16)/255;this.board.renderer.updateGradient(this);break;case"gradientsecondopacity":this.visProp.gradientSecondOpacity=k[1];this.board.renderer.updateGradient(this);break;case"draft":if(k[1]=="false"||k[1]==false){if(this.visProp.draft==true){this.visProp.draft=false;this.board.renderer.removeDraft(this)}}else{if(k[1]=="true"||k[1]==true){this.visProp.draft=true;this.board.renderer.setDraft(this)}}break;case"straightfirst":if(k[1]=="false"||k[1]==false){this.visProp.straightFirst=false}else{if(k[1]=="true"||k[1]==true){this.visProp.straightFirst=true}}this.setStraight(this.visProp.straightFirst,this.visProp.straightLast);break;case"straightlast":if(k[1]=="false"||k[1]==false){this.visProp.straightLast=false}else{if(k[1]=="true"||k[1]==true){this.visProp.straightLast=true}}this.setStraight(this.visProp.straightFirst,this.visProp.straightLast);break;case"firstarrow":if(k[1]=="false"||k[1]==false){this.visProp.firstArrow=false}else{if(k[1]=="true"||k[1]==true){this.visProp.firstArrow=true}}this.setArrow(this.visProp.firstArrow,this.visProp.lastArrow);break;case"lastarrow":if(k[1]=="false"||k[1]==false){this.visProp.lastArrow=false}else{if(k[1]=="true"||k[1]==true){this.visProp.lastArrow=true}}this.setArrow(this.visProp.firstArrow,this.visProp.lastArrow);break;case"curvetype":this.curveType=k[1];break;case"fontsize":this.visProp.fontSize=k[1];break;case"insertticks":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.insertTicks;this.insertTicks=true;if(k[1]=="false"||k[1]==false){this.insertTicks=false}if(a!=this.insertTicks){this.calculateTicksCoordinates()}}break;case"drawlabels":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.drawLabels;this.drawLabels=true;if(k[1]=="false"||k[1]==false){this.drawLabels=false}if(a!=this.drawLabels){this.calculateTicksCoordinates()}}break;case"drawzero":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.drawZero;this.drawZero=true;if(k[1]=="false"||k[1]==false){this.drawZero=false}if(a!=this.drawZero){this.calculateTicksCoordinates()}}break;case"minorticks":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.minorTicks;if((k[1]!=null)&&(k[1]>0)){this.minorTicks=k[1]}if(a!=this.minorTicks){this.calculateTicksCoordinates()}}break;case"majortickheight":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.majorHeight;if((k[1]!=null)&&(k[1]>0)){this.majorHeight=k[1]}if(a!=this.majorHeight){this.calculateTicksCoordinates()}}break;case"minortickheight":if(this.type==JXG.OBJECT_TYPE_TICKS){var a=this.minorHeight;if((k[1]!=null)&&(k[1]>0)){this.minorHeight=k[1]}if(a!=this.minorHeight){this.calculateTicksCoordinates()}}break;case"snapwidth":if(this.type==JXG.OBJECT_TYPE_GLIDER){this.snapWidth=k[1]}}}return this};JXG.GeometryElement.prototype.setDash=function(a){this.visProp.dash=a;this.board.renderer.setDashStyle(this,this.visProp);return this};JXG.GeometryElement.prototype.prepareUpdate=function(){this.needsUpdate=true;return this};JXG.GeometryElement.prototype.remove=function(){this.board.renderer.remove(document.getElementById(this.id));if(this.hasLabel){this.board.renderer.remove(document.getElementById(this.label.content.id))}return this};JXG.GeometryElement.prototype.getTextAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)};JXG.GeometryElement.prototype.getLabelAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)};JXG.GeometryElement.prototype.setStyle=function(a){return this};JXG.GeometryElement.prototype.setStraight=function(a,b){return this};JXG.GeometryElement.prototype.setArrow=function(b,a){return this};JXG.GeometryElement.prototype.createLabel=function(b,d){var a=false;if(typeof d=="undefined"||d==null){d=[10,10]}this.nameHTML=this.board.algebra.replaceSup(this.board.algebra.replaceSub(this.name));this.label={};if(typeof b=="undefined"||b==true){if(this.board.objects[this.id]==null){this.board.objects[this.id]=this;a=true}this.label.relativeCoords=d;this.label.content=new JXG.Text(this.board,this.nameHTML,this.id,[this.label.relativeCoords[0]/(this.board.stretchX),this.label.relativeCoords[1]/(this.board.stretchY)],this.id+"Label","",null,true,this.board.options.text.defaultType);if(a){delete (this.board.objects[this.id])}this.label.color="#000000";if(!this.visProp.visible){this.label.hiddenByParent=true;this.label.content.visProp.visible=false}this.hasLabel=true}return this};JXG.GeometryElement.prototype.addLabelToElement=function(){this.createLabel(true);this.label.content.id=this.id+"Label";this.board.addText(this.label.content);this.board.renderer.drawText(this.label.content);if(!this.label.content.visProp.visible){board.renderer.hide(this.label.content)}return this};JXG.GeometryElement.prototype.highlight=function(){this.board.renderer.highlight(this);return this};JXG.GeometryElement.prototype.noHighlight=function(){this.board.renderer.noHighlight(this);return this};JXG.GeometryElement.prototype.clearTrace=function(){var a;for(a in this.traces){this.board.renderer.remove(this.traces[a])}this.numTraces=0;return this};JXG.GeometryElement.prototype.cloneToBackground=function(a){return this};JXG.GeometryElement.prototype.normalize=function(){this.stdform=this.board.algebra.normalize(this.stdform);return this};JXG.GeometryElement.prototype.toJSON=function(){var b='{"name":'+this.name;b+=', "id":'+this.id;var d=[];for(var a in this.visProp){if(this.visProp[a]!=null){d.push('"'+a+'":'+this.visProp[a])}}b+=', "visProp":{'+d.toString()+"}";b+="}";return b};JXG.clearVisPropOld=function(a){a.visPropOld={};a.visPropOld.strokeColor="";a.visPropOld.strokeOpacity="";a.visPropOld.strokeWidth="";a.visPropOld.fillColor="";a.visPropOld.fillOpacity="";a.visPropOld.shadow=false;a.visPropOld.firstArrow=false;a.visPropOld.lastArrow=false};JXG.COORDS_BY_USER=1;JXG.COORDS_BY_SCREEN=2;JXG.Coords=function(d,b,a){this.board=a;this.usrCoords=[];this.scrCoords=[];if(d==JXG.COORDS_BY_USER){if(b.length<=2){this.usrCoords[0]=1;this.usrCoords[1]=b[0];this.usrCoords[2]=b[1]}else{this.usrCoords[0]=b[0];this.usrCoords[1]=b[1];this.usrCoords[2]=b[2];this.normalizeUsrCoords()}this.usr2screen()}else{this.scrCoords[0]=1;this.scrCoords[1]=b[0];this.scrCoords[2]=b[1];this.screen2usr()}};JXG.Coords.prototype.normalizeUsrCoords=function(){var a=0.000001;if(Math.abs(this.usrCoords[0])>a){this.usrCoords[1]/=this.usrCoords[0];this.usrCoords[2]/=this.usrCoords[0];this.usrCoords[0]=1}};JXG.Coords.prototype.usr2screen=function(h){var g=Math.round,a=this.board,e=this.usrCoords,d=this.board.origin.scrCoords;if(h==null||h){this.scrCoords[0]=g(e[0]);this.scrCoords[1]=g(e[0]*d[1]+e[1]*a.stretchX);this.scrCoords[2]=g(e[0]*d[2]-e[2]*a.stretchY)}else{this.scrCoords[0]=e[0];this.scrCoords[1]=e[0]*d[1]+e[1]*a.stretchX;this.scrCoords[2]=e[0]*d[2]-e[2]*a.stretchY}};JXG.Coords.prototype.screen2usr=function(){var e=this.board.origin.scrCoords,d=this.scrCoords,a=this.board;this.usrCoords[0]=1;this.usrCoords[1]=(d[1]-e[1])/a.stretchX;this.usrCoords[2]=(e[2]-d[2])/a.stretchY};JXG.Coords.prototype.distance=function(b,e){var d=0,k,a=this.usrCoords,h=this.scrCoords,g;if(b==JXG.COORDS_BY_USER){k=e.usrCoords;g=a[0]-k[0];d=g*g;g=a[1]-k[1];d+=g*g;g=a[2]-k[2];d+=g*g}else{k=e.scrCoords;g=h[0]-k[0];d=g*g;g=h[1]-k[1];d+=g*g;g=h[2]-k[2];d+=g*g}return Math.sqrt(d)};JXG.Coords.prototype.setCoordinates=function(g,d,b){var a=this.usrCoords,e=this.scrCoords;if(g==JXG.COORDS_BY_USER){if(d.length==2){a[0]=1;a[1]=d[0];a[2]=d[1]}else{a[0]=d[0];a[1]=d[1];a[2]=d[2];this.normalizeUsrCoords()}this.usr2screen(b)}else{e[1]=d[0];e[2]=d[1];this.screen2usr()}};JXG.POINT_STYLE_X_SMALL=0;JXG.POINT_STYLE_X=1;JXG.POINT_STYLE_X_BIG=2;JXG.POINT_STYLE_CIRCLE_TINY=3;JXG.POINT_STYLE_CIRCLE_SMALL=4;JXG.POINT_STYLE_CIRCLE=5;JXG.POINT_STYLE_CIRCLE_BIG=6;JXG.POINT_STYLE_SQUARE_SMALL=7;JXG.POINT_STYLE_SQUARE=8;JXG.POINT_STYLE_SQUARE_BIG=9;JXG.POINT_STYLE_PLUS_SMALL=10;JXG.POINT_STYLE_PLUS=11;JXG.POINT_STYLE_PLUS_BIG=12;JXG.Point=function(e,g,h,b,a,d){this.constructor();this.type=JXG.OBJECT_TYPE_POINT;this.elementClass=JXG.OBJECT_CLASS_POINT;this.init(e,h,b);if(g==null){g=[0,0]}this.coords=new JXG.Coords(JXG.COORDS_BY_USER,g,this.board);this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,g,this.board);this.showInfobox=true;this.label={};this.label.relativeCoords=[10,10];this.nameHTML=this.board.algebra.replaceSup(this.board.algebra.replaceSub(this.name));if(typeof d=="undefined"||d==true){this.board.objects[this.id]=this;this.label.content=new JXG.Text(this.board,this.nameHTML,this.id,[this.label.relativeCoords[0]/this.board.stretchX,this.label.relativeCoords[1]/this.board.stretchY],this.id+"Label","",null,true,this.board.options.text.defaultType);delete (this.board.objects[this.id]);this.label.color="#000000";if(!a){this.label.hiddenByParent=true;this.label.content.visProp.visible=false}this.hasLabel=true}else{this.showInfobox=false}this.fixed=false;this.position=null;this.onPolygon=false;this.visProp.style=this.board.options.point.style;this.visProp.face="circle";this.visProp.size=3;this.r=this.board.options.precision.hasPoint;this.visProp.fillColor=this.board.options.point.fillColor;this.visProp.highlightFillColor=this.board.options.point.highlightFillColor;this.visProp.strokeColor=this.board.options.point.strokeColor;this.visProp.highlightStrokeColor=this.board.options.point.highlightStrokeColor;this.visProp.visible=a;this.slideObject=null;this.group=[];this.id=this.board.addPoint(this)};JXG.Point.prototype=new JXG.GeometryElement();JXG.Point.prototype.hasPoint=function(b,e){var a=this.coords.scrCoords,d;d=this.visProp.size;if(d<this.r){d=this.r}return((Math.abs(a[1]-b)<d+2)&&(Math.abs(a[2]-e))<d+2)};JXG.Point.prototype.updateConstraint=function(){return this};JXG.Point.prototype.update=function(g){if(!this.needsUpdate){return}if(typeof g=="undefined"){g=false}if(this.traced){this.cloneToBackground(true)}if(this.type==JXG.OBJECT_TYPE_GLIDER){if(this.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){if(g){this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.midpoint.X()+Math.cos(this.position),this.slideObject.midpoint.Y()+Math.sin(this.position)]);this.coords=this.board.algebra.projectPointToCircle(this,this.slideObject)}else{this.coords=this.board.algebra.projectPointToCircle(this,this.slideObject);this.position=this.board.algebra.rad([this.slideObject.midpoint.X()+1,this.slideObject.midpoint.Y()],this.slideObject.midpoint,this)}}else{if(this.slideObject.type==JXG.OBJECT_TYPE_LINE){this.coords=this.board.algebra.projectPointToLine(this,this.slideObject);var e=this.slideObject.point1.coords;var l=this.slideObject.point2.coords;if(g){if(Math.abs(e.usrCoords[0])>=JXG.Math.eps&&Math.abs(l.usrCoords[0])>=JXG.Math.eps){this.coords.setCoordinates(JXG.COORDS_BY_USER,[e.usrCoords[1]+this.position*(l.usrCoords[1]-e.usrCoords[1]),e.usrCoords[2]+this.position*(l.usrCoords[2]-e.usrCoords[2])])}}else{var m=1;var w=e.distance(JXG.COORDS_BY_USER,this.coords);var b=e.distance(JXG.COORDS_BY_USER,l);var k=l.distance(JXG.COORDS_BY_USER,this.coords);if(((w>b)||(k>b))&&(w<k)){m=-1}this.position=m*w/b;if(this.snapWidth!=null&&Math.abs(this._smax-this._smin)>=JXG.Math.eps){if(this.position<0){this.position=0}if(this.position>1){this.position=1}var z=this.position*(this._smax-this._smin)+this._smin;z=Math.round(z/this.snapWidth)*this.snapWidth;this.position=(z-this._smin)/(this._smax-this._smin);this.update(true)}}var d=this.slideObject.point1.coords.scrCoords;var u=this.slideObject.point2.coords.scrCoords;var h;if(this.slideObject.getSlope()==0){h=1}else{h=2}var q=this.coords.scrCoords[h];if(!this.slideObject.visProp.straightFirst){if(d[h]<u[h]){if(q<d[h]){this.coords=this.slideObject.point1.coords;this.position=0}}else{if(d[h]>u[h]){if(q>d[h]){this.coords=this.slideObject.point1.coords;this.position=0}}}}if(!this.slideObject.visProp.straightLast){if(d[h]<u[h]){if(q>u[h]){this.coords=this.slideObject.point2.coords;this.position=1}}else{if(d[h]>u[h]){if(q<u[h]){this.coords=this.slideObject.point2.coords;this.position=1}}}}if(this.onPolygon){var A=this.slideObject.point1.coords;var s=this.slideObject.point2.coords;if(Math.abs(this.coords.scrCoords[1]-A.scrCoords[1])<this.r&&Math.abs(this.coords.scrCoords[2]-A.scrCoords[2])<this.r){var a=this.slideObject.parentPolygon;for(var h=0;h<a.borders.length;h++){if(this.slideObject==a.borders[h]){this.slideObject=a.borders[(h-1+a.borders.length)%a.borders.length];break}}}else{if(Math.abs(this.coords.scrCoords[1]-s.scrCoords[1])<this.r&&Math.abs(this.coords.scrCoords[2]-s.scrCoords[2])<this.r){var a=this.slideObject.parentPolygon;for(var h=0;h<a.borders.length;h++){if(this.slideObject==a.borders[h]){this.slideObject=a.borders[(h+1+a.borders.length)%a.borders.length];break}}}}}}else{if(this.slideObject.type==JXG.OBJECT_TYPE_CURVE){this.updateConstraint();this.coords=this.board.algebra.projectPointToCurve(this,this.slideObject)}else{if(this.slideObject.type==JXG.OBJECT_TYPE_TURTLE){this.updateConstraint();this.coords=this.board.algebra.projectPointToTurtle(this,this.slideObject)}}}}}if(this.type==JXG.OBJECT_TYPE_CAS){this.updateConstraint()}this.updateTransform();this.needsUpdate=false;return this};JXG.Point.prototype.updateRenderer=function(){if(this.visProp.visible){var a=this.isReal;this.isReal=(isNaN(this.coords.usrCoords[1]+this.coords.usrCoords[2]))?false:true;this.isReal=(Math.abs(this.coords.usrCoords[0])>this.board.algebra.eps)?this.isReal:false;if(this.isReal){if(a!=this.isReal){this.board.renderer.show(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}this.board.renderer.updatePoint(this)}else{if(a!=this.isReal){this.board.renderer.hide(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}}}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}return this};JXG.Point.prototype.X=function(){return this.coords.usrCoords[1]};JXG.Point.prototype.Y=function(){return this.coords.usrCoords[2]};JXG.Point.prototype.Z=function(){return this.coords.usrCoords[0]};JXG.Point.prototype.XEval=function(){return this.coords.usrCoords[1]};JXG.Point.prototype.YEval=function(){return this.coords.usrCoords[2]};JXG.Point.prototype.ZEval=function(){return this.coords.usrCoords[0]};JXG.Point.prototype.Dist=function(b){var d,g=b.coords.usrCoords,a=this.coords.usrCoords,e;e=a[0]-g[0];d=e*e;e=a[1]-g[1];d+=e*e;e=a[2]-g[2];d+=e*e;return Math.sqrt(d)};JXG.Point.prototype.setPositionDirectly=function(e,a,d){var b=this.coords;this.coords=new JXG.Coords(e,[a,d],this.board);if(this.group.length!=0){this.group[this.group.length-1].dX=this.coords.scrCoords[1]-b.scrCoords[1];this.group[this.group.length-1].dY=this.coords.scrCoords[2]-b.scrCoords[2];this.group[this.group.length-1].update(this)}else{this.update()}return this};JXG.Point.prototype.setPositionByTransform=function(g,a,e){var d=this.coords;var b=this.board.createElement("transform",[a,e],{type:"translate"});if(this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(b)}else{this.addTransform(this,b)}if(this.group.length!=0){}else{this.update()}return this};JXG.Point.prototype.setPosition=function(d,a,b){this.setPositionByTransform(d,a,b);return this};JXG.Point.prototype.makeGlider=function(a){this.slideObject=JXG.getReference(this.board,a);this.type=JXG.OBJECT_TYPE_GLIDER;this.snapWidth=null;this.slideObject.addChild(this);if(this.slideObject.elementClass==JXG.OBJECT_CLASS_LINE){this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)}}else{if(this.slideObject.elementClass==JXG.OBJECT_CLASS_CIRCLE){this.generatePolynomial=function(){return this.slideObject.generatePolynomial(this)}}}this.needsUpdate=true;this.update();return this};JXG.Point.prototype.addConstraint=function(g){this.type=JXG.OBJECT_TYPE_CAS;var h=this.board.elementsByName;var k=[];var a;for(var e=0;e<g.length;e++){var b=g[e];if(typeof b=="string"){var d=this.board.algebra.geonext2JS(b);k[e]=new Function("","return "+d+";")}else{if(typeof b=="function"){k[e]=b}else{if(typeof b=="number"){k[e]=function(l){return function(){return l}}(b)}else{if(typeof b=="object"&&typeof b.Value=="function"){k[e]=(function(l){return function(){return l.Value()}})(b)}}}}}if(g.length==1){this.updateConstraint=function(){var l=k[0]();if(JXG.isArray(l)){this.coords.setCoordinates(JXG.COORDS_BY_USER,l)}else{this.coords=l}}}else{if(g.length==2){this.XEval=k[0];this.YEval=k[1];a="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.XEval(),this.YEval()]);";this.updateConstraint=new Function("",a)}else{this.ZEval=k[0];this.XEval=k[1];this.YEval=k[2];a="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.ZEval(),this.XEval(),this.YEval()]);";this.updateConstraint=new Function("",a)}}if(!this.board.isSuspendedUpdate){this.update()}return this};JXG.Point.prototype.updateTransform=function(){if(this.transformations.length==0||this.baseElement==null){return}if(this===this.baseElement){var b=this.transformations[0].apply(this.baseElement,"self")}else{var b=this.transformations[0].apply(this.baseElement)}this.coords.setCoordinates(JXG.COORDS_BY_USER,[b[1],b[2]]);for(var a=1;a<this.transformations.length;a++){b=this.transformations[a].apply(this);this.coords.setCoordinates(JXG.COORDS_BY_USER,[b[1],b[2]])}return this};JXG.Point.prototype.addTransform=function(d,a){if(this.transformations.length==0){this.baseElement=d}var e;if(JXG.isArray(a)){e=a}else{e=[a]}for(var b=0;b<e.length;b++){this.transformations.push(e[b])}return this};JXG.Point.prototype.startAnimation=function(a,b){if((this.type==JXG.OBJECT_TYPE_GLIDER)&&(typeof this.intervalCode=="undefined")){this.intervalCode=window.setInterval("JXG.JSXGraph.boards['"+this.board.id+"'].objects['"+this.id+"']._anim("+a+", "+b+")",250);if(typeof this.intervalCount=="undefined"){this.intervalCount=0}}return this};JXG.Point.prototype.stopAnimation=function(){if(typeof this.intervalCode!="undefined"){window.clearInterval(this.intervalCode);delete (this.intervalCode)}return this};JXG.Point.prototype.moveTo=function(k,d){var l=35,m=Math.ceil(d/(l*1)),q=new Array(m+1),b=this.coords.usrCoords[1],a=this.coords.usrCoords[2],g=(k[0]-b),e=(k[1]-a),h;if(Math.abs(g)<JXG.Math.eps&&Math.abs(e)<JXG.Math.eps){return this}for(h=m;h>=0;h--){q[m-h]=[b+g*Math.sin((h/(m*1))*Math.PI/2),a+e*Math.sin((h/(m*1))*Math.PI/2)]}this.animationPath=q;this.board.animationObjects[this.id]=this;if(typeof this.board.animationIntervalCode=="undefined"){this.board.animationIntervalCode=window.setInterval("JXG.JSXGraph.boards['"+this.board.id+"'].animate();",l)}return this};JXG.Point.prototype.visit=function(m,e,b){if(arguments.length==2){b=1}var q=35,s=Math.ceil(e/(q*1)),u=new Array(b*(s+1)),d=this.coords.usrCoords[1],a=this.coords.usrCoords[2],k=(m[0]-d),g=(m[1]-a),l,h;for(h=0;h<b;h++){for(l=s;l>=0;l--){u[h*(s+1)+s-l]=[d+k*Math.pow(Math.sin((l/(s*1))*Math.PI),2),a+g*Math.pow(Math.sin((l/(s*1))*Math.PI),2)]}}this.animationPath=u;this.board.animationObjects[this.id]=this;if(typeof this.board.animationIntervalCode=="undefined"){this.board.animationIntervalCode=window.setInterval("JXG.JSXGraph.boards['"+this.board.id+"'].animate();",q)}return this};JXG.Point.prototype._anim=function(s,h){this.intervalCount++;if(this.intervalCount>h){this.intervalCount=0}if(this.slideObject.type==JXG.OBJECT_TYPE_LINE){var b=this.slideObject.point1.coords.distance(JXG.COORDS_BY_SCREEN,this.slideObject.point2.coords);var m=this.slideObject.getSlope();var k;var g;if(m!="INF"){var e=Math.atan(m);k=Math.round((this.intervalCount/h)*b*Math.cos(e));g=Math.round((this.intervalCount/h)*b*Math.sin(e))}else{k=0;g=Math.round((this.intervalCount/h)*b)}var d;var q=1;if(s<0){d=this.slideObject.point2;if(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]>0){q=-1}else{if(this.slideObject.point2.coords.scrCoords[1]-this.slideObject.point1.coords.scrCoords[1]==0){if(this.slideObject.point2.coords.scrCoords[2]-this.slideObject.point1.coords.scrCoords[2]>0){q=-1}}}}else{d=this.slideObject.point1;if(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]>0){q=-1}else{if(this.slideObject.point1.coords.scrCoords[1]-this.slideObject.point2.coords.scrCoords[1]==0){if(this.slideObject.point1.coords.scrCoords[2]-this.slideObject.point2.coords.scrCoords[2]>0){q=-1}}}}this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[d.coords.scrCoords[1]+q*k,d.coords.scrCoords[2]+q*g])}else{if(this.slideObject.type==JXG.OBJECT_TYPE_CURVE){var a;if(s>0){a=Math.round(this.intervalCount/h*this.board.canvasWidth)}else{a=Math.round((h-this.intervalCount)/h*this.board.canvasWidth)}this.coords.setCoordinates(JXG.COORDS_BY_SCREEN,[a,0]);this.coords=this.board.algebra.projectPointToCurve(this,this.slideObject)}else{if(this.slideObject.type==JXG.OBJECT_TYPE_CIRCLE){var e;if(s<0){e=this.intervalCount/h*2*Math.PI}else{e=(h-this.intervalCount)/h*2*Math.PI}var l=this.slideObject.getRadius();this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.slideObject.midpoint.coords.usrCoords[1]+l*Math.cos(e),this.slideObject.midpoint.coords.usrCoords[2]+l*Math.sin(e)])}}}this.board.update(this);return this};JXG.Point.prototype.setStyle=function(a){if(a==0||a==1||a==2){this.visProp.face="cross";if(a==0){this.visProp.size=2}else{if(a==1){this.visProp.size=3}else{this.visProp.size=4}}}else{if(a==3||a==4||a==5||a==6){this.visProp.face="circle";if(a==3){this.visProp.size=1}else{if(a==4){this.visProp.size=2}else{if(a==5){this.visProp.size=3}else{this.visProp.size=4}}}}else{if(a==7||a==8||a==9){this.visProp.face="square";if(a==7){this.visProp.size=2}else{if(a==8){this.visProp.size=3}else{this.visProp.size=4}}}else{if(a==10||a==11||a==12){this.visProp.face="plus";if(a==10){this.visProp.size=2}else{if(a==11){this.visProp.size=3}else{this.visProp.size=4}}}}}}this.board.renderer.changePointStyle(this);return this};JXG.Point.prototype.setFace=function(a){a=a.toLowerCase();if(a=="cross"||a=="x"||a=="plus"||a=="+"||a=="circle"||a=="o"||a=="square"||a=="[]"){this.visProp.face=a}else{this.visProp.face="circle"}this.board.renderer.changePointStyle(this);return this};JXG.Point.prototype.remove=function(){if(this.hasLabel){this.board.renderer.remove(document.getElementById(this.label.content.id))}this.board.renderer.remove(document.getElementById(this.id))};JXG.Point.prototype.getTextAnchor=function(){return this.coords};JXG.Point.prototype.getLabelAnchor=function(){return this.coords};JXG.Point.prototype.cloneToBackground=function(a){var b={};b.id=this.id+"T"+this.numTraces;this.numTraces++;b.coords=this.coords;b.visProp=this.visProp;b.elementClass=JXG.OBJECT_CLASS_POINT;JXG.clearVisPropOld(b);this.board.renderer.drawPoint(b);this.traces[b.id]=document.getElementById(b.id);delete b;return this};JXG.createPoint=function(g,b,h){var e;if(h==null){h={}}if(typeof h.withLabel=="undefined"){h.withLabel=true}var a=false;for(var d=0;d<b.length;d++){if(typeof b[d]=="function"||typeof b[d]=="string"){a=true}}if(!a){if((JXG.isNumber(b[0]))&&(JXG.isNumber(b[1]))){e=new JXG.Point(g,b,h.id,h.name,(h.visible==undefined)||g.algebra.str2Bool(h.visible),h.withLabel);if(h.slideObject!=null){e.makeGlider(h.slideObject)}else{e.baseElement=e}}else{if((typeof b[0]=="object")&&(typeof b[1]=="object")){e=new JXG.Point(g,[0,0],h.id,h.name,(h.visible==undefined)||g.algebra.str2Bool(h.visible),h.withLabel);e.addTransform(b[0],b[1])}else{throw new Error("JSXGraph: Can't create point with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}}}else{e=new JXG.Point(g,[0,0],h.id,h.name,(h.visible==undefined)||g.algebra.str2Bool(h.visible),h.withLabel);e.addConstraint(b)}return e};JXG.createGlider=function(d,a,e){var b;if(e==null){e={}}if(typeof e.withLabel=="undefined"){e.withLabel=true}if(a.length==1){b=new JXG.Point(d,[0,0],e.id,e.name,(e.visible==undefined)||d.algebra.str2Bool(e.visible),e.withLabel)}else{b=d.createElement("point",a.slice(0,-1),e)}b.makeGlider(a[a.length-1]);return b};JXG.createIntersectionPoint=function(e,b,a){var d;if(b.length>=3){if(b.length==3){b.push(null)}d=e.createElement("point",[e.intersection(b[0],b[1],b[2],b[3])],a)}b[0].addChild(d);b[1].addChild(d);d.generatePolynomial=function(){var g=b[0].generatePolynomial(d);var h=b[1].generatePolynomial(d);if((g.length==0)||(h.length==0)){return[]}else{return[g[0],h[0]]}};return d};JXG.createOtherIntersectionPoint=function(e,b,a){var d;if(b.length!=3||!JXG.isPoint(b[2])||(b[0].elementClass!=JXG.OBJECT_CLASS_LINE&&b[0].elementClass!=JXG.OBJECT_CLASS_CIRCLE)||(b[1].elementClass!=JXG.OBJECT_CLASS_LINE&&b[1].elementClass!=JXG.OBJECT_CLASS_CIRCLE)){throw new Error("JSXGraph: Can't create 'other intersection point' with parent types '"+(typeof b[0])+"',  '"+(typeof b[1])+"'and  '"+(typeof b[2])+"'.")}else{d=e.createElement("point",[e.otherIntersection(b[0],b[1],b[2])],a)}b[0].addChild(d);b[1].addChild(d);d.generatePolynomial=function(){var g=b[0].generatePolynomial(d);var h=b[1].generatePolynomial(d);if((g.length==0)||(h.length==0)){return[]}else{return[g[0],h[0]]}};return d};JXG.JSXGraph.registerElement("point",JXG.createPoint);JXG.JSXGraph.registerElement("glider",JXG.createGlider);JXG.JSXGraph.registerElement("intersection",JXG.createIntersectionPoint);JXG.JSXGraph.registerElement("otherintersection",JXG.createOtherIntersectionPoint);JXG.Line=function(d,g,e,h,a,b){this.constructor();this.type=JXG.OBJECT_TYPE_LINE;this.elementClass=JXG.OBJECT_CLASS_LINE;this.init(d,h,a);this.point1=JXG.getReference(this.board,g);this.point2=JXG.getReference(this.board,e);this.image=null;this.imageTransformMatrix=[[1,0,0],[0,1,0],[0,0,1]];this.r=this.board.options.precision.hasPoint;this.visProp.fillColor=this.board.options.line.fillColor;this.visProp.highlightFillColor=this.board.options.line.highlightFillColor;this.visProp.strokeColor=this.board.options.line.strokeColor;this.visProp.highlightStrokeColor=this.board.options.line.highlightStrokeColor;this.visProp.straightFirst=this.board.options.line.straightFirst;this.visProp.straightLast=this.board.options.line.straightLast;this.visProp.visible=true;this.visProp.firstArrow=this.board.options.line.firstArrow;this.visProp.lastArrow=this.board.options.line.lastArrow;this.ticks=[];this.defaultTicks=null;this.parentPolygon=null;this.createLabel(b);this.id=this.board.addLine(this);this.point1.addChild(this);this.point2.addChild(this);this.update()};JXG.Line.prototype=new JXG.GeometryElement;JXG.Line.prototype.hasPoint=function(l,h){var g=[],s=[1,l,h],m=[],w,d,k,b,q,u,e,a;g[0]=this.stdform[0]-this.stdform[1]*this.board.origin.scrCoords[1]/this.board.stretchX+this.stdform[2]*this.board.origin.scrCoords[2]/this.board.stretchY;g[1]=this.stdform[1]/this.board.stretchX;g[2]=this.stdform[2]/(-this.board.stretchY);w=this.board.algebra.innerProduct(s,g,3)/this.board.algebra.innerProduct(g,g,3);for(d=0;d<3;d++){m[d]=s[d]-w*g[d]}m[1]/=m[0];m[2]/=m[0];m[0]=1;if((s[0]-m[0])*(s[0]-m[0])+(s[1]-m[1])*(s[1]-m[1])+(s[2]-m[2])*(s[2]-m[2])>this.r*this.r){return false}if(this.visProp.straightFirst&&this.visProp.straightLast){return true}else{b=this.point1.coords.scrCoords;q=this.point2.coords.scrCoords;a=(q[1]-b[1])*(q[1]-b[1])+(q[2]-b[2])*(q[2]-b[2]);u=(m[1]-b[1])*(m[1]-b[1])+(m[2]-b[2])*(m[2]-b[2]);e=(m[1]-q[1])*(m[1]-q[1])+(m[2]-q[2])*(m[2]-q[2]);if((u>a)||(e>a)){if(u<e){if(!this.visProp.straightFirst){return false}}else{if(!this.visProp.straightLast){return false}}}return true}};JXG.Line.prototype.update=function(){var a,b;if(this.constrained){if(typeof this.funps!="undefined"){b=this.funps();this.point1=b[0];this.point2=b[1]}else{this.point1=this.funp1();this.point2=this.funp2()}}if(this.needsUpdate){if(true||!this.board.geonextCompatibilityMode){this.updateStdform()}for(a=0;a<this.ticks.length;a++){if(typeof this.ticks[a]!="undefined"){this.ticks[a].calculateTicksCoordinates()}}}if(this.traced){this.cloneToBackground(true)}};JXG.Line.prototype.updateStdform=function(){var a=this.board.algebra.crossProduct(this.point1.coords.usrCoords,this.point2.coords.usrCoords);this.stdform[0]=a[0];this.stdform[1]=a[1];this.stdform[2]=a[2];this.stdform[3]=0;this.normalize()};JXG.Line.prototype.updateRenderer=function(){var a;if(this.needsUpdate&&this.visProp.visible){a=this.isReal;this.isReal=(isNaN(this.point1.coords.usrCoords[1]+this.point1.coords.usrCoords[2]+this.point2.coords.usrCoords[1]+this.point2.coords.usrCoords[2]))?false:true;if(this.isReal){if(a!=this.isReal){this.board.renderer.show(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}this.board.renderer.updateLine(this)}else{if(a!=this.isReal){this.board.renderer.hide(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}}this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Line.prototype.generatePolynomial=function(g){var e=this.point1.symbolic.x,d=this.point1.symbolic.y,k=this.point2.symbolic.x,h=this.point2.symbolic.y,b=g.symbolic.x,a=g.symbolic.y;return[["(",d,")*(",b,")-(",d,")*(",k,")+(",a,")*(",k,")-(",e,")*(",a,")+(",e,")*(",h,")-(",b,")*(",h,")"].join("")]};JXG.Line.prototype.getRise=function(){if(Math.abs(this.stdform[2])>=JXG.Math.eps){return -this.stdform[0]/this.stdform[2]}else{return Infinity}};JXG.Line.prototype.getSlope=function(){if(Math.abs(this.stdform[2])>=JXG.Math.eps){return -this.stdform[1]/this.stdform[2]}else{return Infinity}};JXG.Line.prototype.setStraight=function(a,b){this.visProp.straightFirst=a;this.visProp.straightLast=b;this.board.renderer.updateLine(this)};JXG.Line.prototype.setArrow=function(b,a){this.visProp.firstArrow=b;this.visProp.lastArrow=a;this.board.renderer.updateLine(this)};JXG.Line.prototype.getTextAnchor=function(){return new JXG.Coords(JXG.COORDS_BY_USER,[0.5*(this.point2.X()-this.point1.X()),0.5*(this.point2.Y()-this.point1.Y())],this.board)};JXG.Line.prototype.getLabelAnchor=function(){var g,d,b,e,a;if(!this.visProp.straightFirst&&!this.visProp.straightLast){return new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.X()-0.5*(this.point2.X()-this.point1.X()),this.point2.Y()-0.5*(this.point2.Y()-this.point1.Y())],this.board)}else{d=new JXG.Coords(JXG.COORDS_BY_USER,this.point1.coords.usrCoords,this.board);b=new JXG.Coords(JXG.COORDS_BY_USER,this.point2.coords.usrCoords,this.board);this.board.renderer.calcStraight(this,d,b);if(this.visProp.straightFirst){g=d}else{g=b}if(this.label.content!=null){e=[0,0];a=this.getSlope();if(g.scrCoords[2]==0){if(a==Infinity){e=[10,-10]}else{if(a>=0){e=[10,-10]}else{e=[-10,-10]}}}else{if(g.scrCoords[2]==this.board.canvasHeight){if(a==Infinity){e=[10,10]}else{if(a>=0){e=[-10,10]}else{e=[10,10]}}}}if(g.scrCoords[1]==0){if(a==Infinity){e=[10,10]}else{if(a>=0){e=[10,-10]}else{e=[10,10]}}}else{if(g.scrCoords[1]==this.board.canvasWidth){if(a==Infinity){e=[-10,10]}else{if(a>=0){e=[-10,10]}else{e=[-10,-10]}}}}this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[e[0]/this.board.stretchX,e[1]/this.board.stretchY],this.board)}return g}};JXG.Line.prototype.cloneToBackground=function(b){var e={},d,a;e.id=this.id+"T"+this.numTraces;this.numTraces++;e.point1=this.point1;e.point2=this.point2;e.stdform=this.stdform;JXG.clearVisPropOld(e);e.board={};e.board.unitX=this.board.unitX;e.board.unitY=this.board.unitY;e.board.zoomX=this.board.zoomX;e.board.zoomY=this.board.zoomY;e.board.stretchX=this.board.stretchX;e.board.stretchY=this.board.stretchY;e.board.origin=this.board.origin;e.board.canvasHeight=this.board.canvasHeight;e.board.canvasWidth=this.board.canvasWidth;e.board.dimension=this.board.dimension;e.board.algebra=this.board.algebra;e.visProp=this.visProp;a=this.getSlope();d=this.getRise();e.getSlope=function(){return a};e.getRise=function(){return d};this.board.renderer.enhancedRendering=true;this.board.renderer.drawLine(e);this.board.renderer.enhancedRendering=false;this.traces[e.id]=document.getElementById(e.id);delete e};JXG.Line.prototype.addTransform=function(a){var d,b;if(JXG.isArray(a)){d=a}else{d=[a]}for(b=0;b<d.length;b++){this.point1.transformations.push(d[b]);this.point2.transformations.push(d[b])}};JXG.Line.prototype.setPosition=function(e,a,d){var b=this.board.createElement("transform",[a,d],{type:"translate"});if(this.point1.transformations.length>0&&this.point1.transformations[this.point1.transformations.length-1].isNumericMatrix){this.point1.transformations[this.point1.transformations.length-1].melt(b)}else{this.point1.addTransform(this.point1,b)}if(this.point2.transformations.length>0&&this.point2.transformations[this.point2.transformations.length-1].isNumericMatrix){this.point2.transformations[this.point2.transformations.length-1].melt(b)}else{this.point2.addTransform(this.point2,b)}};JXG.Line.prototype.X=function(l){var s=this.stdform[1],q=this.stdform[2],m=this.stdform[0],h,g,d,e,k;l*=Math.PI;h=s*Math.cos(l)+q*Math.sin(l);g=m;d=Math.sqrt(h*h+g*g);e=-g/d;k=h/d;if(Math.abs(k)<this.board.algebra.eps){k=1}return e*Math.cos(l)/k};JXG.Line.prototype.Y=function(l){var s=this.stdform[1],q=this.stdform[2],m=this.stdform[0],h,g,d,e,k;l*=Math.PI;h=s*Math.cos(l)+q*Math.sin(l);g=m;d=Math.sqrt(h*h+g*g);e=-g/d;k=h/d;if(Math.abs(k)<this.board.algebra.eps){k=1}return e*Math.sin(l)/k};JXG.Line.prototype.Z=function(k){var g=this.stdform[1],e=this.stdform[2],q=this.stdform[0],d,m,h,l;k*=Math.PI;d=g*Math.cos(k)+e*Math.sin(k);m=q;h=Math.sqrt(d*d+m*m);l=d/h;if(Math.abs(l)>=this.board.algebra.eps){return 1}else{return 0}};JXG.Line.prototype.minX=function(){return 0};JXG.Line.prototype.maxX=function(){return 1};JXG.Line.prototype.addTicks=function(a){if(a.id==""||typeof a.id=="undefined"){a.id=this.id+"_ticks_"+(this.ticks.length+1)}this.board.renderer.drawTicks(a);this.ticks.push(a);this.ticks[this.ticks.length-1].updateRenderer();return a.id};JXG.Line.prototype.removeAllTicks=function(){var a;for(a=this.ticks.length;a>0;a--){this.board.renderer.remove(this.ticks[a-1].rendNode)}this.ticks=new Array()};JXG.Line.prototype.removeTicks=function(d){var b,a;if(this.defaultTicks!=null&&this.defaultTicks==d){this.defaultTicks=null}for(b=this.ticks.length;b>0;b--){if(this.ticks[b-1]==d){this.board.renderer.remove(this.ticks[b-1].rendNode);for(a=0;a<this.ticks[b-1].ticks.length;a++){if(this.ticks[b-1].labels[a]!=null){if(this.ticks[b-1].labels[a].show){this.board.renderer.remove(this.ticks[b-1].labels[a].rendNode)}}}delete (this.ticks[b-1])}}};JXG.createLine=function(h,l,g){var b,q,m,e,k=[];if(g==null){g={}}if(g.withLabel==null||typeof g.withLabel=="undefined"){g.withLabel=false}var d=false;if(l.length==2){if(l[0].length>1){q=h.createElement("point",l[0],{visible:false,fixed:true})}else{if(l[0].elementClass==JXG.OBJECT_CLASS_POINT){q=JXG.getReference(h,l[0])}else{if((typeof l[0]=="function")&&(l[0]().elementClass==JXG.OBJECT_CLASS_POINT)){q=l[0]();d=true}else{throw new Error("JSXGraph: Can't create line with parent types '"+(typeof l[0])+"' and '"+(typeof l[1])+"'.")}}}if(l[1].length>1){m=h.createElement("point",l[1],{visible:false,fixed:true})}else{if(l[1].elementClass==JXG.OBJECT_CLASS_POINT){m=JXG.getReference(h,l[1])}else{if((typeof l[1]=="function")&&(l[1]().elementClass==JXG.OBJECT_CLASS_POINT)){m=l[1]();d=true}else{throw new Error("JSXGraph: Can't create line with parent types '"+(typeof l[0])+"' and '"+(typeof l[1])+"'.")}}}b=new JXG.Line(h,q.id,m.id,g.id,g.name,g.withLabel);if(d){b.constrained=true;b.funp1=l[0];b.funp2=l[1]}}else{if(l.length==3){for(e=0;e<3;e++){if(typeof l[e]=="number"){k[e]=function(s){return function(){return s}}(l[e])}else{if(typeof l[e]=="function"){k[e]=l[e]}else{throw new Error("JSXGraph: Can't create line with parent types '"+(typeof l[0])+"' and '"+(typeof l[1])+"' and '"+(typeof l[2])+"'.");return}}}q=h.createElement("point",[function(){return 0},function(){return k[2]()},function(){return -k[1]()}],{visible:false,name:" "});m=h.createElement("point",[function(){return k[2]()*k[2]()+k[1]()*k[1]()},function(){return -k[1]()*k[0]()+k[2]()},function(){return -k[2]()*k[0]()-k[1]()}],{visible:false,name:" "});b=new JXG.Line(h,q.id,m.id,g.id,g.name,g.withLabel)}else{if((l.length==1)&&(typeof l[0]=="function")&&(l[0]().length==2)&&(l[0]()[0].elementClass==JXG.OBJECT_CLASS_POINT)&&(l[0]()[1].elementClass==JXG.OBJECT_CLASS_POINT)){var a=l[0]();b=new JXG.Line(h,a[0].id,a[1].id,g.id,g.name,g.withLabel);b.constrained=true;b.funps=l[0]}else{throw new Error("JSXGraph: Can't create line with parent types '"+(typeof l[0])+"' and '"+(typeof l[1])+"'.")}}}return b};JXG.JSXGraph.registerElement("line",JXG.createLine);JXG.createSegment=function(d,a,e){var b;if(e==null){e=new Object()}if(e.withLabel==null||typeof e.withLabel=="undefined"){e.withLabel=false}e.straightFirst=false;e.straightLast=false;b=d.createElement("line",a,e);return b};JXG.JSXGraph.registerElement("segment",JXG.createSegment);JXG.createArrow=function(e,b,a){var d;if(a==null){a={}}if(a.withLabel==null||typeof a.withLabel=="undefined"){a.withLabel=false}d=e.createElement("line",b,a);d.setStraight(false,false);d.setArrow(false,true);return d};JXG.JSXGraph.registerElement("arrow",JXG.createArrow);JXG.createAxis=function(g,q,b){var l,k,s,h,d,a,e,m;if((JXG.isArray(q[0])||JXG.isPoint(q[0]))&&(JXG.isArray(q[1])||JXG.isPoint(q[1]))){if(JXG.isPoint(q[0])){l=q[0]}else{l=new JXG.Point(g,q[0],"","",false)}if(JXG.isPoint(q[1])){k=q[1]}else{k=new JXG.Point(g,q[1],"","",false)}l.fixed=true;k.fixed=true;b=b||{};b.lastArrow=b.lastArrow||true;b.straightFirst=b.lastArrow||true;b.straightLast=b.straightLast||true;b.strokeWidth=b.strokeWidth||1;b.withLabel=b.withLabel||false;b.highlightStrokeColor=b.highlightStrokeColor||b.strokeColor||g.options.line.strokeColor;s=g.createElement("line",[l,k],b);s.needsRegularUpdate=false;b.minorTicks=b.minorTicks||4;b.insertTicks=b.insertTicks||"true";if(b.ticksDistance!="undefined"&&b.ticksDistance!=null){h=b.ticksDistance}else{d=new JXG.Coords(JXG.COORDS_BY_USER,[s.point1.coords.usrCoords.slice(1)],g);a=new JXG.Coords(JXG.COORDS_BY_USER,[s.point2.coords.usrCoords.slice(1)],g);g.renderer.calcStraight(s,d,a);e=d.distance(JXG.COORDS_BY_USER,a);h=1}m=g.createElement("ticks",[s,h],b);m.needsRegularUpdate=false;s.defaultTicks=m}else{throw new Error("JSXGraph: Can't create point with parent types '"+(typeof q[0])+"' and '"+(typeof q[1])+"'.")}return s};JXG.JSXGraph.registerElement("axis",JXG.createAxis);JXG.createTangent=function(m,s,e){var a,q,k,l,h,d,b,u,w;if(s.length==1){a=s[0];q=a.slideObject}else{if(s.length==2){if(JXG.isPoint(s[0])){a=s[0];q=s[1]}else{if(JXG.isPoint(s[1])){q=s[0];a=s[1]}else{throw new Error("JSXGraph: Can't create normal with parent types '"+(typeof s[0])+"' and '"+(typeof s[1])+"'.")}}}else{throw new Error("JSXGraph: Can't create normal with parent types '"+(typeof s[0])+"' and '"+(typeof s[1])+"'.")}}if(e==null){e={}}if(e.withLabel==null){e.withLabel=false}if(q.elementClass==JXG.OBJECT_CLASS_LINE){return m.createElement("line",[q.point1,q.point2],e)}else{if(q.elementClass==JXG.OBJECT_CLASS_CURVE){if(q.curveType!="plot"){k=q.X;l=q.Y;return m.createElement("line",[function(){return -a.X()*m.D(l)(a.position)+a.Y()*m.D(k)(a.position)},function(){return m.D(l)(a.position)},function(){return -m.D(k)(a.position)}],e)}else{return m.createElement("line",[function(){h=Math.floor(a.position);if(h==q.numberPoints-1){h--}if(h<0){return 1}return q.Y(h)*q.X(h+1)-q.X(h)*q.Y(h+1)},function(){h=Math.floor(a.position);if(h==q.numberPoints-1){h--}if(h<0){return 0}return q.Y(h+1)-q.Y(h)},function(){h=Math.floor(a.position);if(h==q.numberPoints-1){h--}if(h<0){return 0}return q.X(h)-q.X(h+1)}],e)}}else{if(q.type==JXG.OBJECT_TYPE_TURTLE){return m.createElement("line",[function(){h=Math.floor(a.position);for(d=0;d<q.objects.length;d++){b=q.objects[d];if(b.type==JXG.OBJECT_TYPE_CURVE){if(h<b.numberPoints){break}h-=b.numberPoints}}if(h==b.numberPoints-1){h--}if(h<0){return 1}return b.Y(h)*b.X(h+1)-b.X(h)*b.Y(h+1)},function(){h=Math.floor(a.position);for(d=0;d<q.objects.length;d++){b=q.objects[d];if(b.type==JXG.OBJECT_TYPE_CURVE){if(h<b.numberPoints){break}h-=b.numberPoints}}if(h==b.numberPoints-1){h--}if(h<0){return 0}return b.Y(h+1)-b.Y(h)},function(){h=Math.floor(a.position);for(d=0;d<q.objects.length;d++){b=q.objects[d];if(b.type==JXG.OBJECT_TYPE_CURVE){if(h<b.numberPoints){break}h-=b.numberPoints}}if(h==b.numberPoints-1){h--}if(h<0){return 0}return b.X(h)-b.X(h+1)}],e)}else{if(q.elementClass==JXG.OBJECT_CLASS_CIRCLE){return m.createElement("line",[function(){return JXG.Math.matVecMult(q.quadraticform,a.coords.usrCoords)[0]},function(){return JXG.Math.matVecMult(q.quadraticform,a.coords.usrCoords)[1]},function(){return JXG.Math.matVecMult(q.quadraticform,a.coords.usrCoords)[2]}],e)}}}}};JXG.JSXGraph.registerElement("tangent",JXG.createTangent);JXG.Group=function(g,l,a){var h,e,b,k,d;this.board=g;this.objects={};h=this.board.numObjects;this.board.numObjects++;if((l=="")||(l==null)||(typeof l=="undefined")){this.id=this.board.id+"Group"+h}else{this.id=l}this.type=JXG.OBJECT_TYPE_POINT;this.elementClass=JXG.OBJECT_CLASS_POINT;if((a=="")||(a==null)||(typeof a=="undefined")){this.name="group_"+this.board.generateName(this)}else{this.name=a}delete (this.type);if((arguments.length==4)&&(JXG.isArray(arguments[3]))){e=arguments[3]}else{e=[];for(b=3;b<arguments.length;b++){e.push(arguments[b])}}for(b=0;b<e.length;b++){k=JXG.getReference(this.board,e[b]);if((!k.fixed)&&((k.type==JXG.OBJECT_TYPE_POINT)||(k.type==JXG.OBJECT_TYPE_GLIDER))){if(k.group.length!=0){this.addGroup(k.group[k.group.length-1])}else{this.addPoint(k)}}}for(d in this.objects){this.objects[d].group.push(this)}this.dX=0;this.dY=0};JXG.Group.prototype.ungroup=function(){var a;for(a in this.objects){if(this.objects[a].group[this.objects[a].group.length-1]==this){this.objects[a].group.pop()}delete (this.objects[a])}};JXG.Group.prototype.update=function(a){var d=null,b;for(b in this.objects){d=this.objects[b];if(d.id!=a.id){d.coords=new JXG.Coords(JXG.COORDS_BY_SCREEN,[d.coords.scrCoords[1]+this.dX,d.coords.scrCoords[2]+this.dY],d.board)}}for(b in this.objects){if(this.board.objects[b]!=undefined){this.objects[b].update(false)}else{delete (this.objects[b])}}};JXG.Group.prototype.addPoint=function(a){this.objects[a.id]=a};JXG.Group.prototype.addPoints=function(a){var b;for(b in a){this.objects[b.id]=b}};JXG.Group.prototype.addGroup=function(b){var a;for(a in b.objects){this.addPoint(b.objects[a])}};JXG.createGroup=function(d,b,a){return new JXG.Group(d,a.id,a.name,b)};JXG.JSXGraph.registerElement("group",JXG.createGroup);JXG.Circle=function(g,k,e,b,h,a,d){this.constructor();this.type=JXG.OBJECT_TYPE_CIRCLE;this.elementClass=JXG.OBJECT_CLASS_CIRCLE;this.init(g,h,a);this.method=k;this.midpoint=JXG.getReference(this.board,e);this.midpoint.addChild(this);this.visProp.visible=true;this.visProp.fillColor=this.board.options.circle.fillColor;this.visProp.highlightFillColor=this.board.options.circle.highlightFillColor;this.visProp.strokeColor=this.board.options.circle.strokeColor;this.visProp.highlightStrokeColor=this.board.options.circle.highlightStrokeColor;this.point2=null;this.radius=0;this.line=null;this.circle=null;if(k=="twoPoints"){this.point2=JXG.getReference(g,b);this.point2.addChild(this);this.radius=this.getRadius()}else{if(k=="pointRadius"){this.generateTerm(b);this.updateRadius()}else{if(k=="pointLine"){this.line=JXG.getReference(g,b);this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords)}else{if(k=="pointCircle"){this.circle=JXG.getReference(g,b);this.radius=this.circle.getRadius()}}}}if(d!=null){this.createLabel(d)}if(k=="twoPoints"){this.id=this.board.addCircle(this)}else{if(k=="pointRadius"){this.id=this.board.addCircle(this);this.notifyParents(b)}else{if(k=="pointLine"){this.line.addChild(this);this.id=this.board.addCircle(this)}else{if(k=="pointCircle"){this.circle.addChild(this);this.id=this.board.addCircle(this)}}}}};JXG.Circle.prototype=new JXG.GeometryElement;JXG.Circle.prototype.hasPoint=function(a,k){var b=this.board.options.precision.hasPoint/(this.board.stretchX),e=this.midpoint.coords.usrCoords,g=new JXG.Coords(JXG.COORDS_BY_SCREEN,[a,k],this.board),d=this.getRadius();var h=Math.sqrt((e[1]-g.usrCoords[1])*(e[1]-g.usrCoords[1])+(e[2]-g.usrCoords[2])*(e[2]-g.usrCoords[2]));return(Math.abs(h-d)<b)};JXG.Circle.prototype.generatePolynomial=function(k){var g=this.midpoint.symbolic.x;var e=this.midpoint.symbolic.y;var d=k.symbolic.x;var b=k.symbolic.y;var a=this.generateRadiusSquared();if(a==""){return[]}var h="(("+d+")-("+g+"))^2 + (("+b+")-("+e+"))^2 - ("+a+")";return[h]};JXG.Circle.prototype.generateRadiusSquared=function(){var b="";if(this.method=="twoPoints"){var e=this.midpoint.symbolic.x;var d=this.midpoint.symbolic.y;var h=this.point2.symbolic.x;var g=this.point2.symbolic.y;b="("+h+"-"+e+")^2 + ("+g+"-"+d+")^2"}else{if(this.method=="pointRadius"){if(typeof(this.radius)=="number"){b=""+this.radius*this.radius}}else{if(this.method=="pointLine"){var h=this.line.point1.symbolic.x;var g=this.line.point1.symbolic.y;var a=this.line.point2.symbolic.x;var k=this.line.point2.symbolic.y;b="("+h+"-"+a+")^2 + ("+g+"-"+k+")^2"}else{if(this.method=="pointCircle"){b=this.circle.getRadius()}}}}return b};JXG.Circle.prototype.update=function(){if(this.traced){this.cloneToBackground(true)}if(this.needsUpdate){if(this.method=="pointLine"){this.radius=this.line.point1.coords.distance(JXG.COORDS_BY_USER,this.line.point2.coords)}else{if(this.method=="pointCircle"){this.radius=this.circle.getRadius()}else{if(this.method=="pointRadius"){this.radius=this.updateRadius()}}}if(!this.board.geonextCompatibilityMode){this.updateStdform();this.updateQuadraticform()}}};JXG.Circle.prototype.updateQuadraticform=function(){var a=this.midpoint;this.quadraticform=[[a.X()*a.X()+a.Y()*a.Y()-this.getRadius()*this.getRadius(),-a.X(),-a.Y()],[-a.X(),1,0],[-a.Y(),0,1]]};JXG.Circle.prototype.updateStdform=function(){this.stdform[3]=0.5;this.stdform[4]=this.getRadius();this.stdform[1]=-this.midpoint.coords.usrCoords[1];this.stdform[2]=-this.midpoint.coords.usrCoords[2];this.normalize()};JXG.Circle.prototype.updateRenderer=function(){if(this.needsUpdate&&this.visProp.visible){var a=this.isReal;this.isReal=(isNaN(this.midpoint.coords.usrCoords[1]+this.midpoint.coords.usrCoords[2]+this.getRadius()))?false:true;if(this.isReal){if(a!=this.isReal){this.board.renderer.show(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.show(this.label.content)}}this.board.renderer.updateCircle(this)}else{if(a!=this.isReal){this.board.renderer.hide(this);if(this.hasLabel&&this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}}this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Circle.prototype.generateTerm=function(b){if(typeof b=="string"){var d=this.board.elementsByName;var a=this.board.algebra.geonext2JS(b+"");this.updateRadius=new Function("return "+a+";")}else{if(typeof b=="number"){this.updateRadius=function(){return b}}else{this.updateRadius=b}}};JXG.Circle.prototype.notifyParents=function(b){var a=null;var d=this.board.elementsByName;if(typeof b=="string"){this.board.algebra.findDependencies(this,b+"")}};JXG.Circle.prototype.getRadius=function(){if(this.method=="twoPoints"){return(Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)))}else{if(this.method=="pointLine"||this.method=="pointCircle"){return this.radius}else{if(this.method=="pointRadius"){return this.updateRadius()}}}};JXG.Circle.prototype.getTextAnchor=function(){return this.midpoint.coords};JXG.Circle.prototype.getLabelAnchor=function(){if(this.method=="twoPoints"){var b=this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1];var a=this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2];return new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]+b,this.midpoint.coords.usrCoords[2]+a],this.board)}else{if(this.method=="pointLine"||this.method=="pointCircle"||this.method=="pointRadius"){return new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]-this.getRadius(),this.midpoint.coords.usrCoords[2]],this.board)}}};JXG.Circle.prototype.cloneToBackground=function(a){var d={};d.id=this.id+"T"+this.numTraces;this.numTraces++;d.midpoint={};d.midpoint.coords=this.midpoint.coords;var b=this.getRadius();d.getRadius=function(){return b};d.board={};d.board.unitX=this.board.unitX;d.board.unitY=this.board.unitY;d.board.zoomX=this.board.zoomX;d.board.zoomY=this.board.zoomY;d.board.stretchX=this.board.stretchX;d.board.stretchY=this.board.stretchY;d.visProp=this.visProp;JXG.clearVisPropOld(d);this.board.renderer.drawCircle(d);this.traces[d.id]=document.getElementById(d.id);delete d};JXG.Circle.prototype.addTransform=function(a){var d;if(JXG.isArray(a)){d=a}else{d=[a]}for(var b=0;b<d.length;b++){this.midpoint.transformations.push(d[b]);if(this.method=="twoPoints"){this.point2.transformations.push(d[b])}}};JXG.Circle.prototype.setPosition=function(e,a,d){var b=this.board.createElement("transform",[a,d],{type:"translate"});this.addTransform(b)};JXG.Circle.prototype.X=function(a){a*=2*Math.PI;return this.getRadius()*Math.cos(a)+this.midpoint.coords.usrCoords[1]};JXG.Circle.prototype.Y=function(a){a*=2*Math.PI;return this.getRadius()*Math.sin(a)+this.midpoint.coords.usrCoords[2]};JXG.Circle.prototype.minX=function(){return 0};JXG.Circle.prototype.maxX=function(){return 1};JXG.Circle.prototype.Area=function(){var a=this.getRadius()*this.getRadius()*Math.PI;return a};JXG.createCircle=function(e,k,h){var d,g,b;if(h==null){h={}}if(typeof h.withLabel=="undefined"){h.withLabel=false}g=[];for(b=0;b<k.length;b++){if(JXG.isPoint(k[b])){g[b]=k[b]}else{if(k[b].length>1){g[b]=e.createElement("point",k[b],{visible:false,fixed:true})}else{g[b]=k[b]}}}if(k.length==2&&JXG.isPoint(g[0])&&JXG.isPoint(g[1])){d=new JXG.Circle(e,"twoPoints",g[0],g[1],h.id,h.name,h.withLabel)}else{if((JXG.isNumber(g[0])||JXG.isFunction(g[0])||JXG.isString(g[0]))&&JXG.isPoint(g[1])){d=new JXG.Circle(e,"pointRadius",g[1],g[0],h.id,h.name,h.withLabel)}else{if((JXG.isNumber(g[1])||JXG.isFunction(g[1])||JXG.isString(g[1]))&&JXG.isPoint(g[0])){d=new JXG.Circle(e,"pointRadius",g[0],g[1],h.id,h.name,h.withLabel)}else{if((g[0].type==JXG.OBJECT_TYPE_CIRCLE)&&JXG.isPoint(g[1])){d=new JXG.Circle(e,"pointCircle",g[1],g[0],h.id,h.name,h.withLabel)}else{if((g[1].type==JXG.OBJECT_TYPE_CIRCLE)&&JXG.isPoint(g[0])){d=new JXG.Circle(e,"pointCircle",g[0],g[1],h.id,h.name,h.withLabel)}else{if((g[0].type==JXG.OBJECT_TYPE_LINE)&&JXG.isPoint(g[1])){d=new JXG.Circle(e,"pointLine",g[1],g[0],h.id,h.name,h.withLabel)}else{if((g[1].type==JXG.OBJECT_TYPE_LINE)&&JXG.isPoint(g[0])){d=new JXG.Circle(e,"pointLine",g[0],g[1],h.id,h.name,h.withLabel)}else{if(k.length==3&&JXG.isPoint(g[0])&&JXG.isPoint(g[1])&&JXG.isPoint(g[2])){var a=JXG.createCircumcircle(e,g,h);a[0].setProperty({visible:false});return a[1]}else{throw new Error("JSXGraph: Can't create circle with parent types '"+(typeof k[0])+"' and '"+(typeof k[1])+"'.")}}}}}}}}return d};JXG.JSXGraph.registerElement("circle",JXG.createCircle);JXG.Polygon=function(q,s,u,d,b,e,a,k){this.constructor();this.type=JXG.OBJECT_TYPE_POLYGON;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(q,d,b);if((typeof e=="undefined")||(e==null)){e=true}if((typeof k=="undefined")||(k==null)){k=false}this.withLines=e;this.vertices=[];for(var h=0;h<s.length;h++){var m=JXG.getReference(this.board,s[h]);this.vertices[h]=m}if((typeof u=="undefined")||(u==null)){u=[];for(var h=0;h<s.length-1;h++){u[h]={}}}if(this.vertices[this.vertices.length-1]!=this.vertices[0]){this.vertices.push(this.vertices[0]);u.push({})}this.visProp.fillColor=this.board.options.polygon.fillColor;this.visProp.highlightFillColor=this.board.options.polygon.highlightFillColor;this.visProp.fillOpacity=this.board.options.polygon.fillOpacity;this.visProp.highlightFillOpacity=this.board.options.polygon.highlightFillOpacity;var g;this.borders=[];if(e){for(var h=0;h<this.vertices.length-1;h++){g=new JXG.Line(q,this.vertices[h],this.vertices[h+1],u[h].id,u[h].name,k);g.setStraight(false,false);this.borders[h]=g;g.parentPolygon=this}}for(var h=0;h<this.vertices.length-1;h++){var m=JXG.getReference(this.board,this.vertices[h]);m.addChild(this)}this.createLabel(a,[0,0]);this.id=this.board.addPolygon(this)};JXG.Polygon.prototype=new JXG.GeometryElement;JXG.Polygon.prototype.hasPoint=function(a,b){return false};JXG.Polygon.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updatePolygon(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Polygon.prototype.getTextAnchor=function(){var g=0;var e=0;var d=0;var k=0;g=d=this.vertices[0].X();e=k=this.vertices[0].Y();for(var h=0;h<this.vertices.length;h++){if(this.vertices[h].X()<g){g=this.vertices[h].X()}if(this.vertices[h].X()>d){d=this.vertices[h].X()}if(this.vertices[h].Y()>e){e=this.vertices[h].Y()}if(this.vertices[h].Y()<k){k=this.vertices[h].Y()}}return new JXG.Coords(JXG.COORDS_BY_USER,[(g+d)*0.5,(e+k)*0.5],this.board)};JXG.Polygon.prototype.getLabelAnchor=function(){var g=0;var e=0;var d=0;var k=0;g=d=this.vertices[0].X();e=k=this.vertices[0].Y();for(var h=0;h<this.vertices.length;h++){if(this.vertices[h].X()<g){g=this.vertices[h].X()}if(this.vertices[h].X()>d){d=this.vertices[h].X()}if(this.vertices[h].Y()>e){e=this.vertices[h].Y()}if(this.vertices[h].Y()<k){k=this.vertices[h].Y()}}return new JXG.Coords(JXG.COORDS_BY_USER,[(g+d)*0.5,(e+k)*0.5],this.board)};JXG.Polygon.prototype.cloneToBackground=function(a){var b={};b.id=this.id+"T"+this.numTraces;this.numTraces++;b.vertices=this.vertices;b.visProp=this.visProp;JXG.clearVisPropOld(b);this.board.renderer.drawPolygon(b);this.traces[b.id]=$(b.id);delete b};JXG.createPolygon=function(e,a,g){var d;if(typeof g.withLabel=="undefined"){g.withLabel=false}for(var b=0;b<a.length;b++){a[b]=JXG.getReference(e,a[b]);if(!JXG.isPoint(a[b])){throw new Error("JSXGraph: Can't create polygon with parent types other than 'point'.")}}d=new JXG.Polygon(e,a,g.borders,g.id,g.name,g.withLines,g.withLabel,g.lineLabels);return d};JXG.JSXGraph.registerElement("polygon",JXG.createPolygon);JXG.Polygon.prototype.hideElement=function(){this.visProp.visible=false;this.board.renderer.hide(this);if(this.withLines){for(var a=0;a<this.borders.length;a++){this.borders[a].hideElement()}}if(this.hasLabel&&this.label!=null){this.label.hiddenByParent=true;if(this.label.content.visProp.visible){this.board.renderer.hide(this.label.content)}}};JXG.Polygon.prototype.showElement=function(){this.visProp.visible=true;this.board.renderer.show(this);if(this.withLines){for(var a=0;a<this.borders.length;a++){this.borders[a].showElement()}}};JXG.Polygon.prototype.Area=function(){var b=0,a;for(a=0;a<this.vertices.length-1;a++){b+=(this.vertices[a].X()*this.vertices[a+1].Y()-this.vertices[a+1].X()*this.vertices[a].Y())}b/=2;return Math.abs(b)};JXG.createRegularPolygon=function(k,m,h){var d,g,e,a=[],b,l;if(typeof h.withLabel=="undefined"){h.withLabel=false}if(m.length!=3){throw new Error("JSXGraph: A regular polygon needs two point and a number as input.")}e=m[2];if(!JXG.isNumber(e)||e<3){throw new Error("JSXGraph: The third parameter has to be number greater than 2.")}for(g=0;g<m.length-1;g++){m[g]=JXG.getReference(k,m[g]);if(!JXG.isPoint(m[g])){throw new Error("JSXGraph: Can't create regular polygon if the first two parameters aren't points.")}}a[0]=m[0];a[1]=m[1];for(g=2;g<e;g++){b=k.createElement("transform",[Math.PI*(2-(e-2)/e),a[g-1]],{type:"rotate"});a[g]=k.createElement("point",[a[g-2],b],{name:"",withLabel:false,fixed:true,face:"o",size:1})}d=k.createElement("polygon",a,h);return d};JXG.JSXGraph.registerElement("regularpolygon",JXG.createRegularPolygon);JXG.Curve=function(e,b,g,a,d){this.constructor();this.points=[];this.type=JXG.OBJECT_TYPE_CURVE;this.elementClass=JXG.OBJECT_CLASS_CURVE;this.init(e,g,a);this.doAdvancedPlot=this.board.options.curve.doAdvancedPlot;this.numberPointsHigh=this.board.options.curve.numberPointsHigh;this.numberPointsLow=this.board.options.curve.numberPointsLow;this.numberPoints=this.numberPointsHigh;this.visProp.strokeWidth=this.board.options.curve.strokeWidth;this.visProp.visible=true;this.dataX=null;this.dataY=null;this.r=this.board.options.precision.hasPoint;this.curveType=null;if(b[0]!=null){this.varname=b[0]}else{this.varname="x"}this.xterm=b[1];this.yterm=b[2];this.generateTerm(this.varname,this.xterm,this.yterm,b[3],b[4]);this.updateCurve();this.createLabel(d);this.id=this.board.addCurve(this);if(typeof this.xterm=="string"){this.notifyParents(this.xterm)}if(typeof this.yterm=="string"){this.notifyParents(this.yterm)}};JXG.Curve.prototype=new JXG.GeometryElement;JXG.Curve.prototype.minX=function(){if(this.curveType=="polar"){return 0}else{var a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],this.board);return a.usrCoords[1]}};JXG.Curve.prototype.maxX=function(){var a;if(this.curveType=="polar"){return 2*Math.PI}else{a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[this.board.canvasWidth,0],this.board);return a.usrCoords[1]}};JXG.Curve.prototype.hasPoint=function(w,u){var z,E=Infinity,N,l,G,F,B,A,C,b,O,D,q,K,k,J,g,m,s,I=this.numberPointsLow,L=(this.maxX()-this.minX())/I,a=this.r/(this.board.unitX*this.board.zoomX),e,H,h=true;a=a*a;e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[w,u],this.board);w=e.usrCoords[1];u=e.usrCoords[2];if(this.curveType=="parameter"||this.curveType=="polar"||this.curveType=="functiongraph"){H=this.transformations.length;for(G=0,z=this.minX();G<I;G++){B=this.X(z,h);A=this.Y(z,h);for(F=0;F<H;F++){l=this.transformations[F];l.update();N=JXG.Math.matVecMult(l.matrix,[1,B,A]);B=N[1];A=N[2]}E=(w-B)*(w-B)+(u-A)*(u-A);if(E<a){return true}z+=L}}else{if(this.curveType=="plot"){H=this.numberPoints;for(G=0;G<H-1;G++){C=this.X(G);b=this.X(G+1);O=this.Y(G);D=this.Y(G+1);J=b-C;g=D-O;K=w-C;k=u-O;s=J*J+g*g;if(s>=JXG.Math.eps){m=K*J+k*g;q=m/s;E=K*K+k*k-q*m}else{q=0;E=K*K+k*k}if(q>=0&&q<=1&&E<a){return true}}return false}}return(E<a)};JXG.Curve.prototype.allocatePoints=function(){var b,a;a=this.numberPoints;if(this.points.length<this.numberPoints){for(b=this.points.length;b<a;b++){this.points[b]=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board)}}};JXG.Curve.prototype.update=function(){if(this.needsUpdate){this.updateCurve()}return this};JXG.Curve.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateCurve(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible){this.label.content.update();this.board.renderer.updateText(this.label.content)}return this};JXG.Curve.prototype.updateDataArray=function(){return this};JXG.Curve.prototype.updateCurve=function(){var b,d,k,a,h,e,g=false;this.updateDataArray();d=this.minX();k=this.maxX();if(this.dataX!=null){this.numberPoints=this.dataX.length;b=this.numberPoints;this.allocatePoints();for(e=0;e<b;e++){a=e;if(this.dataY!=null){h=e}else{h=this.X(a)}this.points[e].setCoordinates(JXG.COORDS_BY_USER,[this.X(a,g),this.Y(h,g)],false);this.updateTransform(this.points[e]);g=true}}else{if(this.doAdvancedPlot){this.updateParametricCurve(d,k,b)}else{if(this.board.updateQuality==this.board.BOARD_QUALITY_HIGH){this.numberPoints=this.numberPointsHigh}else{this.numberPoints=this.numberPointsLow}b=this.numberPoints;this.allocatePoints();this.updateParametricCurveNaive(d,k,b)}}this.getLabelAnchor();return this};JXG.Curve.prototype.updateParametricCurveNaive=function(d,k,b){var g,e,h=false,a=(k-d)/b;for(g=0;g<b;g++){e=d+g*a;this.points[g].setCoordinates(JXG.COORDS_BY_USER,[this.X(e,h),this.Y(e,h)],false);this.updateTransform(this.points[g]);h=true}return this};JXG.Curve.prototype.updateParametricCurve=function(G,a,C){var A,m,l,d=false,B=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board),k,h,E,b,q,I,H,u,g,z=[],e=[],F=[],D=[],s=false,w=0;if(this.board.updateQuality==this.board.BOARD_QUALITY_LOW){H=12;u=12;g=12}else{H=20;u=2;g=2}D[0]=a-G;for(A=1;A<H;A++){D[A]=D[A-1]*0.5}A=1;z[0]=1;e[0]=0;m=G;B.setCoordinates(JXG.COORDS_BY_USER,[this.X(m,d),this.Y(m,d)],false);d=true;E=B.scrCoords[1];b=B.scrCoords[2];l=m;m=a;B.setCoordinates(JXG.COORDS_BY_USER,[this.X(m,d),this.Y(m,d)],false);k=B.scrCoords[1];h=B.scrCoords[2];F[0]=[k,h];q=1;I=0;this.points=[];this.points[w++]=new JXG.Coords(JXG.COORDS_BY_SCREEN,[E,b],this.board);do{s=this.isDistOK(E,b,k,h,u,g)||this.isSegmentOutside(E,b,k,h);while(I<H&&(!s||I<3)&&!(!this.isSegmentDefined(E,b,k,h)&&I>8)){z[q]=A;e[q]=I;F[q]=[k,h];q++;A=2*A-1;I++;m=G+A*D[I];B.setCoordinates(JXG.COORDS_BY_USER,[this.X(m,d),this.Y(m,d)],false);k=B.scrCoords[1];h=B.scrCoords[2];s=this.isDistOK(E,b,k,h,u,g)||this.isSegmentOutside(E,b,k,h)}this.points[w]=new JXG.Coords(JXG.COORDS_BY_SCREEN,[k,h],this.board);this.updateTransform(this.points[w]);w++;E=k;b=h;l=m;q--;k=F[q][0];h=F[q][1];I=e[q]+1;A=z[q]*2}while(q!=0);this.numberPoints=this.points.length;return this};JXG.Curve.prototype.isSegmentOutside=function(b,e,a,d){if(e<0&&d<0){return true}else{if(e>this.board.canvasHeight&&d>this.board.canvasHeight){return true}else{if(b<0&&a<0){return true}else{if(b>this.board.canvasWidth&&a>this.board.canvasWidth){return true}}}}return false};JXG.Curve.prototype.isDistOK=function(e,h,d,g,b,a){if(isNaN(e+h+d+g)){return false}return(Math.abs(d-e)<a&&Math.abs(g-h)<a)};JXG.Curve.prototype.isSegmentDefined=function(b,e,a,d){if(isNaN(b+e)&&isNaN(a+d)){return false}return true};JXG.Curve.prototype.updateTransform=function(e){var d,g,b,a=this.transformations.length;if(a==0){return e}for(b=0;b<a;b++){d=this.transformations[b];d.update();g=JXG.Math.matVecMult(d.matrix,e.usrCoords);e.setCoordinates(JXG.COORDS_BY_USER,[g[1],g[2]])}return e};JXG.Curve.prototype.addTransform=function(b){var e,d,a;if(JXG.isArray(b)){e=b}else{e=[b]}a=e.length;for(d=0;d<a;d++){this.transformations.push(e[d])}return this};JXG.Curve.prototype.setPosition=function(e,a,d){var b=this.board.createElement("transform",[a,d],{type:"translate"});if(this.transformations.length>0&&this.transformations[this.transformations.length-1].isNumericMatrix){this.transformations[this.transformations.length-1].melt(b)}else{this.addTransform(b)}return this};JXG.Curve.prototype.generateTerm=function(b,h,d,a,k){var g,e;if(JXG.isArray(h)){this.dataX=h;this.X=function(l){return this.dataX[l]};this.curveType="plot";this.numberPoints=this.dataX.length}else{this.X=JXG.createFunction(h,this.board,b);if(JXG.isString(h)){this.curveType="functiongraph"}else{if(JXG.isFunction(h)||JXG.isNumber(h)){this.curveType="parameter"}}}if(JXG.isArray(d)){this.dataY=d;this.Y=function(l){if(JXG.isFunction(this.dataY[l])){return this.dataY[l]()}else{return this.dataY[l]}}}else{this.Y=JXG.createFunction(d,this.board,b)}if(JXG.isFunction(h)&&JXG.isArray(d)){g=JXG.createFunction(d[0],this.board,"");e=JXG.createFunction(d[1],this.board,"");this.X=function(l){return(h)(l)*Math.cos(l)+g()};this.Y=function(l){return(h)(l)*Math.sin(l)+e()};this.curveType="polar"}if(a!=null){this.minX=JXG.createFunction(a,this.board,"")}if(k!=null){this.maxX=JXG.createFunction(k,this.board,"")}};JXG.Curve.prototype.notifyParents=function(a){this.board.algebra.findDependencies(this,a)};JXG.Curve.prototype.getLabelAnchor=function(){var a=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,this.board.canvasHeight*0.5],this.board);a=this.board.algebra.projectCoordsToCurve(a.usrCoords[1],a.usrCoords[2],0,this)[0];return a};JXG.createCurve=function(d,b,a){if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}return new JXG.Curve(d,["x"].concat(b),a.id,a.name,a.withLabel)};JXG.JSXGraph.registerElement("curve",JXG.createCurve);JXG.createFunctiongraph=function(e,b,a){var d=["x","x"].concat(b);if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}a.curveType="functiongraph";return new JXG.Curve(e,d,a.id,a.name,a.withLabel)};JXG.JSXGraph.registerElement("functiongraph",JXG.createFunctiongraph);JXG.createSpline=function(d,b,a){var e;if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}e=function(){var k,g=[],l=[];var h=function(u,s){var q,m;if(!s){g=[];l=[];if(b.length==2&&JXG.isArray(b[0])&&JXG.isArray(b[1])&&b[0].length==b[1].length){for(q=0;q<b[0].length;q++){if(typeof b[0][q]=="function"){g.push(b[0][q]())}else{g.push(b[0][q])}if(typeof b[1][q]=="function"){l.push(b[1][q]())}else{l.push(b[1][q])}}}else{for(q=0;q<b.length;q++){if(JXG.isPoint(b[q])){g.push(b[q].X());l.push(b[q].Y())}else{if(JXG.isArray(b[q])&&b[q].length==2){for(q=0;q<b.length;q++){if(typeof b[q][0]=="function"){g.push(b[q][0]())}else{g.push(b[q][0])}if(typeof b[q][1]=="function"){l.push(b[q][1]())}else{l.push(b[q][1])}}}}}}k=JXG.Math.Numerics.splineDef(g,l)}return JXG.Math.Numerics.splineEval(u,g,l,k)};return h};return new JXG.Curve(d,["x","x",e()],a.id,a.name,a.withLabel)};JXG.JSXGraph.registerElement("spline",JXG.createSpline);JXG.createRiemannsum=function(g,b,a){var l,e,h,d,k;if(a==null){a={}}if(typeof a.withLabel=="undefined"){a.withLabel=false}a.fillOpacity=a.fillOpacity||0.3;a.fillColor=a.fillColor||"#ffff00";a.curveType="plot";h=b[0];l=JXG.createFunction(b[1],g,"");if(l==null){throw new Error("JSXGraph: JXG.createRiemannsum: argument '2' n has to be number or function.")}e=JXG.createFunction(b[2],g,"",false);if(e==null){throw new Error("JSXGraph: JXG.createRiemannsum: argument 3 'type' has to be string or function.")}d=["x",[0],[0]].concat(b.slice(3));k=new JXG.Curve(g,d,a.id,a.name,a.withLabel);k.updateDataArray=function(){var m=JXG.Math.Numerics.riemann(h,l(),e(),this.minX(),this.maxX());this.dataX=m[0];this.dataY=m[1]};return k};JXG.JSXGraph.registerElement("riemannsum",JXG.createRiemannsum);JXG.Arc=function(d,h,g,e,k,a,b){this.constructor();this.type=JXG.OBJECT_TYPE_ARC;this.elementClass=JXG.OBJECT_CLASS_CIRCLE;this.init(d,k,a);this.midpoint=JXG.getReference(this.board,h);this.point2=JXG.getReference(this.board,g);this.point3=JXG.getReference(this.board,e);this.r=this.board.options.precision.hasPoint;this.visProp.visible=true;this.visProp.firstArrow=this.board.options.arc.firstArrow;this.visProp.lastArrow=this.board.options.arc.lastArrow;this.visProp.fillColor=this.board.options.arc.fillColor;this.visProp.highlightFillColor=this.board.options.arc.highlightFillColor;this.visProp.strokeColor=this.board.options.arc.strokeColor;this.visProp.highlightStrokeColor=this.board.options.arc.highlightStrokeColor;this.createLabel(b,[0,0]);this.id=this.board.addArc(this);this.midpoint.addChild(this);this.point2.addChild(this);this.point3.addChild(this)};JXG.Arc.prototype=new JXG.GeometryElement;JXG.Arc.prototype.hasPoint=function(m,l){var s=this.r/(this.board.stretchX);var h=new JXG.Coords(JXG.COORDS_BY_SCREEN,[m,l],this.board);var a=this.getRadius();var k=Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-h.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-h.usrCoords[2],2));var q=(Math.abs(k-a)<s);if(q){var b={};b.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1],this.board.origin.usrCoords[2]/(this.board.stretchY)],this.board);var g=this.board.algebra.trueAngle(this.point2,this.midpoint,b);var e=this.board.algebra.trueAngle(this.point3,this.midpoint,b);var u={};u.coords=h;var d=this.board.algebra.trueAngle(u,this.midpoint,b);if(g>=e){if(g<d||d<e){q=false}}else{if(d>g){if(d<e){q=false}}}}return q};JXG.Arc.prototype.hasPointSector=function(m,l){var s=this.r/(this.board.stretchX);var h=new JXG.Coords(JXG.COORDS_BY_SCREEN,[m,l],this.board);var a=this.getRadius();var k=Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-h.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-h.usrCoords[2],2));var q=(k<a);if(q){var b={};b.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1],this.board.origin.usrCoords[2]/(this.board.stretchY)],this.board);var g=this.board.algebra.trueAngle(this.point2,this.midpoint,b);var e=this.board.algebra.trueAngle(this.point3,this.midpoint,b);var u={};u.coords=h;var d=this.board.algebra.trueAngle(u,this.midpoint,b);if(g>=e){if(g<d||d<e){q=false}}else{if(d>g){if(d<e){q=false}}}}return q};JXG.Arc.prototype.getRadius=function(){return(Math.sqrt(Math.pow(this.midpoint.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.midpoint.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)))};JXG.Arc.prototype.getTextAnchor=function(){return this.midpoint.coords};JXG.Arc.prototype.getLabelAnchor=function(){var d=this.board.algebra.trueAngle(this.point2,this.midpoint,this.point3);var q=10/(this.board.stretchX);var l=10/(this.board.stretchY);var b=this.point2.coords.usrCoords[1]-this.midpoint.coords.usrCoords[1];var m=this.point2.coords.usrCoords[2]-this.midpoint.coords.usrCoords[2];if(this.label.content!=null){this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[0/(this.board.stretchX),0/(this.board.stretchY)],this.board)}var h=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]+Math.cos(d*Math.PI/(2*180))*b-Math.sin(d*Math.PI/(2*180))*m,this.midpoint.coords.usrCoords[2]+Math.sin(d*Math.PI/(2*180))*b+Math.cos(d*Math.PI/(2*180))*m],this.board);var g=h.usrCoords[1]-this.midpoint.coords.usrCoords[1];var e=h.usrCoords[2]-this.midpoint.coords.usrCoords[2];var a=Math.sqrt(g*g+e*e);g=g*(a+q)/a;e=e*(a+l)/a;var k=new JXG.Coords(JXG.COORDS_BY_USER,[this.midpoint.coords.usrCoords[1]+g,this.midpoint.coords.usrCoords[2]+e],this.board);return k};JXG.Arc.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateArc(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Arc.prototype.setArrow=function(b,a){this.visProp.firstArrow=b;this.visProp.lastArrow=a;this.board.renderer.updateArc(this);if(this.hasLabel&&this.label.content.visProp.visible){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.createArc=function(e,b,a){var d;if(typeof a.withLabel=="undefined"){a.withLabel=false}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){d=new JXG.Arc(e,b[0],b[1],b[2],a.id,a.name,a.withLabel)}else{throw new Error("JSXGraph: Can't create Arc with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return d};JXG.JSXGraph.registerElement("arc",JXG.createArc);JXG.createSemicircle=function(e,b,a){var d,h,g;if(typeof a.withLabel=="undefined"){a.withLabel=false}if(a.id!=null){g=a.id+"_mp"}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))){h=e.createElement("midpoint",[b[0],b[1]],{id:g,withLabel:false,visible:false});d=new JXG.Arc(e,h,b[1],b[0],a.id,a.name,a.withLabel)}else{throw new Error("JSXGraph: Can't create Semicircle with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}return d};JXG.JSXGraph.registerElement("semicircle",JXG.createSemicircle);JXG.createCircumcircleArc=function(g,b,a){var e,k,h,d;if(typeof a.withLabel=="undefined"){a.withLabel=false}if(a.id!=null){h=a.id+"_mp"}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){k=g.createElement("circumcirclemidpoint",[b[0],b[1],b[2]],{id:h,withLabel:false,visible:false});d=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(d<0){e=new JXG.Arc(g,k,b[0],b[2],a.id,a.name,a.withLabel)}else{e=new JXG.Arc(g,k,b[2],b[0],a.id,a.name,a.withLabel)}e.update=function(){var l;if(this.traced){this.cloneToBackground(true)}l=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(l<0){this.point2=b[0];this.point3=b[2]}else{this.point2=b[2];this.point3=b[0]}}}else{throw new Error("JSXGraph: create Circumcircle Arc with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return e};JXG.JSXGraph.registerElement("circumcirclearc",JXG.createCircumcircleArc);JXG.Sector=function(m,A,z,w,b,q,g){this.constructor();this.type=JXG.OBJECT_TYPE_SECTOR;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(m,g,"");if(!JXG.isArray(b)){b=[null,null,null,null]}if(!JXG.isArray(q)){q=[null,null,null,null]}this.point1=JXG.getReference(this.board,A);this.point2=JXG.getReference(this.board,z);this.point3=JXG.getReference(this.board,w);this.r=this.board.options.precision.hasPoint;this.visProp.visible=true;var d={};d.midpoint=this.point1;var l=this.getRadius();d.getRadius=function(){return l};var u=this.board.algebra.projectPointToCircle(this.point3,d);var e=new JXG.Point(m,[u.usrCoords[1],u.usrCoords[2]],b[1],q[1],true);e.fixed=true;this.addChild(e);e.update=function(){var B={};B.midpoint=JXG.getReference(this.board,A);var a=(Math.sqrt(Math.pow(JXG.getReference(this.board,A).coords.usrCoords[1]-JXG.getReference(this.board,z).coords.usrCoords[1],2)+Math.pow(JXG.getReference(this.board,A).coords.usrCoords[2]-JXG.getReference(this.board,z).coords.usrCoords[2],2)));B.getRadius=function(){return a};u=this.board.algebra.projectPointToCircle(JXG.getReference(this.board,w),B);this.coords=u;this.board.renderer.updatePoint(this);if(this.label.content.visProp.visible){this.label.content.update()}};var k=new JXG.Line(m,A,z,b[2],q[2]);var h=new JXG.Line(m,A,e.id,b[3],q[3]);k.setStraight(false,false);h.setStraight(false,false);var s=new JXG.Arc(m,A,z,w,b[0],q[0]);s.visProp.fillColor=this.board.options.sector.fillColor;s.visProp.highlightFillColor=this.board.options.sector.highlightFillColor;s.visProp.fillOpacity=this.board.options.sector.fillOpacity;s.visProp.highlightFillOpacity=this.board.options.sector.highlightFillOpacity;this.point4=e;this.lines=[k,h];this.arc=s;this.id=this.board.addSector(this);this.point1.addChild(this);this.point2.addChild(this);this.point3.addChild(this)};JXG.Sector.prototype=new JXG.GeometryElement;JXG.Sector.prototype.hasPoint=function(a,b){return false};JXG.Sector.prototype.getRadius=function(){return(Math.sqrt(Math.pow(this.point1.coords.usrCoords[1]-this.point2.coords.usrCoords[1],2)+Math.pow(this.point1.coords.usrCoords[2]-this.point2.coords.usrCoords[2],2)))};JXG.Sector.prototype.updateRenderer=function(){};JXG.createSector=function(b,e,d){var a;if((JXG.isPoint(e[0]))&&(JXG.isPoint(e[1]))&&(JXG.isPoint(e[2]))){a=new JXG.Sector(b,e[0],e[1],e[2],d.ids,d.names,d.id)}else{throw new Error("JSXGraph: Can't create sector with parent types '"+(typeof e[0])+"' and '"+(typeof e[1])+"' and '"+(typeof e[2])+"'.")}return a};JXG.JSXGraph.registerElement("sector",JXG.createSector);JXG.createCircumcircleSector=function(g,b,a){var e,k,h,d;if(typeof a.withLabel=="undefined"){a.withLabel=false}if(a.id!=null){h=a.id+"_mp"}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){k=g.createElement("circumcirclemidpoint",[b[0],b[1],b[2]],{id:h,withLabel:false,visible:false});d=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(d<0){e=new JXG.Sector(g,k,b[0],b[2],a.id,a.name,a.withLabel)}else{e=new JXG.Sector(g,k,b[2],b[0],a.id,a.name,a.withLabel)}e.arc.update=function(){var l;if(this.traced){this.cloneToBackground(true)}l=(b[0].coords.usrCoords[1]-b[2].coords.usrCoords[1])*(b[0].coords.usrCoords[2]-b[1].coords.usrCoords[2])-(b[0].coords.usrCoords[2]-b[2].coords.usrCoords[2])*(b[0].coords.usrCoords[1]-b[1].coords.usrCoords[1]);if(l<0){this.point2=b[0];this.point3=b[2]}else{this.point2=b[2];this.point3=b[0]}};e.point4.setProperty({visible:false})}else{throw new Error("JSXGraph: Can't create circumcircle sector with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return e};JXG.JSXGraph.registerElement("circumcirclesector",JXG.createCircumcircleSector);JXG.Angle=function(l,e,d,a,k,s,w,D,b){this.constructor();this.type=JXG.OBJECT_TYPE_ANGLE;this.elementClass=JXG.OBJECT_CLASS_AREA;this.init(l,w,D);this.point1=JXG.getReference(this.board,e);this.point2=JXG.getReference(this.board,d);this.point3=JXG.getReference(this.board,a);this.radius=this.board.options.angle.radius;if(k!=undefined&&k!=null){this.radius=k}this.visProp.fillColor=this.board.options.angle.fillColor;this.visProp.highlightFillColor=this.board.options.angle.highlightFillColor;this.visProp.fillOpacity=this.board.options.angle.fillOpacity;this.visProp.highlightFillOpacity=this.board.options.angle.highlightFillOpacity;this.visProp.strokeColor=this.board.options.angle.strokeColor;if(s==""){var h=["&alpha;","&beta;","&gamma;","&delta;","&epsilon;","&zeta;","&eta","&theta;","&iota;","&kappa;","&lambda;","&mu;","&nu;","&xi;","&omicron;","&pi;","&rho;","&sigmaf;","&sigma;","&tau;","&upsilon;","&phi;","&chi;","&psi;","&omega;"],B=0,z,m,g,u,A,q;while(B<h.length){z=B;m=h[B];for(g in l.objects){if(l.objects[g].type==JXG.OBJECT_TYPE_ANGLE){if(l.objects[g].text==m){B++;break}}}if(B==z){s=m;B=h.length+1}}if(B==h.length){u="&alpha;_{";A="}";q=false;z=0;while(!q){for(g in l.objects){if(l.objects[g].type==JXG.OBJECT_TYPE_ANGLE){if(l.objects[g].text==(u+z+A)){q=true;break}}}if(q){q=false}else{q=true;s=(u+z+A)}}}}this.text=s;var C=this.name;this.name=this.text;this.createLabel(b);this.name=C;this.id=this.board.addAngle(this);this.point1.addChild(this);this.point2.addChild(this);this.point3.addChild(this)};JXG.Angle.prototype=new JXG.GeometryElement;JXG.Angle.prototype.hasPoint=function(a,b){return false};JXG.Angle.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateAngle(this);this.needsUpdate=false}if(this.hasLabel&&this.label.content.visProp.visible&&this.isReal){this.label.content.update();this.board.renderer.updateText(this.label.content)}};JXG.Angle.prototype.getLabelAnchor=function(){var e=this.board.algebra.trueAngle(this.point1,this.point2,this.point3);var d=this.point1.coords.distance(JXG.COORDS_BY_USER,this.point2.coords);var b=(this.point1.coords.usrCoords[1]-this.point2.coords.usrCoords[1])*(this.radius/2)/d;var a=(this.point1.coords.usrCoords[2]-this.point2.coords.usrCoords[2])*(this.radius/2)/d;var g=new JXG.Coords(JXG.COORDS_BY_USER,[this.point2.coords.usrCoords[1]+Math.cos(e*Math.PI/(2*160))*b-Math.sin(e*Math.PI/(2*160))*a,this.point2.coords.usrCoords[2]+Math.sin(e*Math.PI/(2*160))*b+Math.cos(e*Math.PI/(2*160))*a],this.board);if(this.label.content!=null){this.label.content.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[0/(this.board.stretchX),0/(this.board.stretchY)],this.board)}return g};JXG.createAngle=function(e,b,a){var d;if(a.withLabel==null||typeof a.withLabel=="undefined"){a.withLabel=true}if(a.text==null||typeof a.text=="text"){a.text=""}if((JXG.isPoint(b[0]))&&(JXG.isPoint(b[1]))&&(JXG.isPoint(b[2]))){d=new JXG.Angle(e,b[0],b[1],b[2],a.radius,a.text,a.id,a.name,a.withLabel)}else{throw new Error("JSXGraph: Can't create angle with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return d};JXG.JSXGraph.registerElement("angle",JXG.createAngle);JXG.Algebra=function(a){this.board=a;this.eps=JXG.Math.eps};JXG.Algebra.prototype.angle=function(g,e,d){var l=[],k=[],h=[],q,m,z,w;if(g.coords==null){l[0]=g[0];l[1]=g[1]}else{l[0]=g.coords.usrCoords[1];l[1]=g.coords.usrCoords[2]}if(e.coords==null){k[0]=e[0];k[1]=e[1]}else{k[0]=e.coords.usrCoords[1];k[1]=e.coords.usrCoords[2]}if(d.coords==null){h[0]=d[0];h[1]=d[1]}else{h[0]=d.coords.usrCoords[1];h[1]=d.coords.usrCoords[2]}q=l[0]-k[0];m=l[1]-k[1];z=h[0]-k[0];w=h[1]-k[1];return Math.atan((q*w-m*z)/(q*z+m*w))};JXG.Algebra.prototype.trueAngle=function(a,d,b){return this.rad(a,d,b)*57.29577951308232};JXG.Algebra.prototype.rad=function(w,u,s){var l,g,H,G,d,b,k,h,q,m,e,E,D,I,z,F,a=0;if(w.coords==null){l=w[0];g=w[1]}else{l=w.coords.usrCoords[1];g=w.coords.usrCoords[2]}if(u.coords==null){H=u[0];G=u[1]}else{H=u.coords.usrCoords[1];G=u.coords.usrCoords[2]}if(s.coords==null){d=s[0];b=s[1]}else{d=s.coords.usrCoords[1];b=s.coords.usrCoords[2]}q=d-H;m=b-G;k=l-H;h=g-G;F=q*k+m*h;e=k*m-h*q;E=Math.sqrt(k*k+h*h);D=Math.sqrt(q*q+m*m);I=F/(E*D);if(I>1){I=1}else{if(I<-1){I=-1}}z=Math.acos(I);if((Math.sin(z)*e)<0){a=6.283185307179586-z}else{a=z}return a};JXG.Algebra.prototype.angleBisector=function(h,g,b){var e=h.coords.usrCoords,q=g.coords.usrCoords,k=b.coords.usrCoords,u=e[1]-q[1],s=e[2]-q[2],m=Math.sqrt(u*u+s*s),a,w,l;u/=m;s/=m;a=Math.acos(u);if(s<0){a*=-1}if(a<0){a+=2*Math.PI}u=k[1]-q[1];s=k[2]-q[2];m=Math.sqrt(u*u+s*s);u/=m;s/=m;w=Math.acos(u);if(s<0){w*=-1}if(w<0){w+=2*Math.PI}l=(a+w)*0.5;if(a>w){l+=Math.PI}u=Math.cos(l)+q[1];s=Math.sin(l)+q[2];return new JXG.Coords(JXG.COORDS_BY_USER,[u,s],this.board)};JXG.Algebra.prototype.midpoint=function(a,b){return new JXG.Coords(JXG.COORDS_BY_USER,[(a.coords.usrCoords[0]+b.coords.usrCoords[0])*0.5,(a.coords.usrCoords[1]+b.coords.usrCoords[1])*0.5,(a.coords.usrCoords[2]+b.coords.usrCoords[2])*0.5],this.board)};JXG.Algebra.prototype.parallel=function(g,b,l){var d=1,h=l.coords.usrCoords,m=g.coords.usrCoords,a=b.coords.usrCoords,k=h[1]+d*(a[1]-m[1]),e=h[2]+d*(a[2]-m[2]);return new JXG.Coords(JXG.COORDS_BY_USER,[k,e],this.board)};JXG.Algebra.prototype.reflection=function(s,l){var e=l.coords.usrCoords,u=s.point1.coords.usrCoords,d=s.point2.coords.usrCoords,b,k,a,g,m,h,q;m=d[1]-u[1];h=d[2]-u[2];b=e[1]-u[1];k=e[2]-u[2];q=(m*k-h*b)/(m*m+h*h);a=e[1]+2*q*h;g=e[2]-2*q*m;return new JXG.Coords(JXG.COORDS_BY_USER,[a,g],this.board)};JXG.Algebra.prototype.rotation=function(a,q,g){var k=q.coords.usrCoords,b=a.coords.usrCoords,e,m,h,u,d,l;e=k[1]-b[1];m=k[2]-b[2];h=Math.cos(g);u=Math.sin(g);d=e*h-m*u+b[1];l=e*u+m*h+b[2];return new JXG.Coords(JXG.COORDS_BY_USER,[d,l],this.board)};JXG.Algebra.prototype.perpendicular=function(w,s){var g=w.point1.coords.usrCoords,e=w.point2.coords.usrCoords,b=s.coords.usrCoords,m,k,l,u,h,d,a,q;if(s==w.point1){m=g[1]+e[2]-g[2];k=g[2]-e[1]+g[1];l=true}else{if(s==w.point2){m=e[1]+g[2]-e[2];k=e[2]-g[1]+e[1];l=false}else{if(((Math.abs(g[1]-e[1])>this.eps)&&(Math.abs(b[2]-(g[2]-e[2])*(b[1]-g[1])/(g[1]-e[1])-g[2])<this.eps))||((Math.abs(g[1]-e[1])<=this.eps)&&(Math.abs(g[1]-b[1])<this.eps))){m=b[1]+e[2]-b[2];k=b[2]-e[1]+b[1];l=true;if(Math.abs(m-b[1])<this.eps&&Math.abs(k-b[2])<this.eps){m=b[1]+g[2]-b[2];k=b[2]-g[1]+b[1];l=false}}else{u=g[2]-e[2];h=g[1]-e[1];d=e[1]*u-e[2]*h;a=b[1]*h+b[2]*u;q=u*u+h*h;if(Math.abs(q)<this.eps){q=this.eps}m=(d*u+a*h)/q;k=(a*u-d*h)/q;l=true}}}return[new JXG.Coords(JXG.COORDS_BY_USER,[m,k],this.board),l]};JXG.Algebra.prototype.circumcenterMidpoint=function(k,g,e){var d=k.coords.usrCoords,b=g.coords.usrCoords,a=e.coords.usrCoords,s,q,m,l,h;s=((d[1]-b[1])*(d[1]+b[1])+(d[2]-b[2])*(d[2]+b[2]))*0.5;q=((b[1]-a[1])*(b[1]+a[1])+(b[2]-a[2])*(b[2]+a[2]))*0.5;m=(d[1]-b[1])*(b[2]-a[2])-(b[1]-a[1])*(d[2]-b[2]);if(Math.abs(m)<this.eps){m=this.eps}l=(s*(b[2]-a[2])-q*(d[2]-b[2]))/m;h=(q*(d[1]-b[1])-s*(b[1]-a[1]))/m;return new JXG.Coords(JXG.COORDS_BY_USER,[l,h],this.board)};JXG.Algebra.prototype.intersectLineLine=function(s,q){var h=s.point1.coords.usrCoords,e=s.point2.coords.usrCoords,b=q.point1.coords.usrCoords,a=q.point2.coords.usrCoords,g,d,m,l,k;g=h[1]*e[2]-h[2]*e[1];d=b[1]*a[2]-b[2]*a[1];m=(e[2]-h[2])*(b[1]-a[1])-(h[1]-e[1])*(a[2]-b[2]);if(Math.abs(m)<this.eps){m=this.eps}l=(g*(b[1]-a[1])-d*(h[1]-e[1]))/m;k=(d*(e[2]-h[2])-g*(a[2]-b[2]))/m;return new JXG.Coords(JXG.COORDS_BY_USER,[l,k],this.board)};JXG.Algebra.prototype.intersectCircleLine=function(q,D){var Q=D.point1.coords.usrCoords,O=D.point2.coords.usrCoords,g=q.midpoint.coords.usrCoords,H,a,P,N,F,K,I,u,G,E,m,k,J,B,z,e,C,A,L;H=D.point1.Dist(D.point2);if(H>0){a=q.midpoint.Dist(D.point1);P=q.midpoint.Dist(D.point2);N=((a*a)+(H*H)-(P*P))/(2*H);F=(a*a)-(N*N);F=(F<0)?0:F;K=Math.sqrt(F);I=q.getRadius();u=Math.sqrt((I*I)-K*K);G=O[1]-Q[1];E=O[2]-Q[2];m=g[1]+(K/H)*E;k=g[2]-(K/H)*G;a=(O[1]*E)-(O[2]*G);P=(m*G)+(k*E);J=(E*E)+(G*G);if(Math.abs(J)<this.eps){J=this.eps}B=((a*E)+(P*G))/J;z=((P*E)-(a*G))/J;e=u/H;C=new JXG.Coords(JXG.COORDS_BY_USER,[B+e*G,z+e*E],this.board);A=new JXG.Coords(JXG.COORDS_BY_USER,[B-e*G,z-e*E],this.board);L=q.midpoint.coords.distance(JXG.COORDS_BY_USER,C);if((I<(L-1))||isNaN(L)){return[0]}else{return[2,C,A]}}return[0]};JXG.Algebra.prototype.intersectCircleCircle=function(q,m){var d={},k=q.getRadius(),g=m.getRadius(),e=q.midpoint.coords.usrCoords,b=m.midpoint.coords.usrCoords,z,l,C,B,A,w,u;z=k+g;l=Math.abs(k-g);C=q.midpoint.coords.distance(JXG.COORDS_BY_USER,m.midpoint.coords);if(C>z){return[0]}else{if(C<l){return[0]}else{if(C!=0){d[0]=1;B=b[1]-e[1];A=b[2]-e[2];w=(C*C-g*g+k*k)/(2*C);u=Math.sqrt(k*k-w*w);d[1]=new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+(w/C)*B+(u/C)*A,e[2]+(w/C)*A-(u/C)*B],this.board);d[2]=new JXG.Coords(JXG.COORDS_BY_USER,[e[1]+(w/C)*B-(u/C)*A,e[2]+(w/C)*A+(u/C)*B],this.board)}else{return[0]}return d}}};JXG.Algebra.prototype.projectPointToCircle=function(b,g){var h=b.coords.distance(JXG.COORDS_BY_USER,g.midpoint.coords),e=b.coords.usrCoords,l=g.midpoint.coords.usrCoords,a,k,d;if(Math.abs(h)<this.eps){h=this.eps}d=g.getRadius()/h;a=l[1]+d*(e[1]-l[1]);k=l[2]+d*(e[2]-l[2]);return new JXG.Coords(JXG.COORDS_BY_USER,[a,k],this.board)};JXG.Algebra.prototype.projectPointToLine=function(a,d){var b=this.innerProduct(a.coords.usrCoords,d.stdform,3)/this.innerProduct(d.stdform,d.stdform,3),g,e=[];for(g=0;g<3;g++){e[g]=a.coords.usrCoords[g]-b*d.stdform[g]}return new JXG.Coords(JXG.COORDS_BY_USER,e,this.board)};JXG.Algebra.prototype.projectPointToCurve=function(d,g){var b=d.X(),h=d.Y(),e=d.position||0,a=this.projectCoordsToCurve(b,h,e,g);d.position=a[1];return a[0]};JXG.Algebra.prototype.projectCoordsToCurve=function(s,m,A,e){var z,d,w,b,q,u,g,h,k,a,l=1000000;if(e.curveType=="parameter"||e.curveType=="polar"){A=JXG.Math.Numerics.root(JXG.Math.Numerics.D(function(B){return(s-e.X(B))*(s-e.X(B))+(m-e.Y(B))*(m-e.Y(B))}),A);if(A<e.minX()){A=e.maxX()+A-e.minX()}if(A>e.maxX()){A=e.minX()+A-e.maxX()}z=new JXG.Coords(JXG.COORDS_BY_USER,[e.X(A),e.Y(A)],this.board)}else{if(e.curveType=="plot"){h=l;for(g=0;g<e.numberPoints;g++){d=s-e.X(g);w=m-e.Y(g);k=Math.sqrt(d*d+w*w);if(k<h){h=k;A=g}if(g==e.numberPoints-1){continue}b=e.X(g+1)-e.X(g);q=e.Y(g+1)-e.Y(g);u=b*b+q*q;if(u>=JXG.Math.eps){a=(d*b+w*q)/u;k=Math.sqrt(d*d+w*w-a*(d*b+w*q))}else{a=0;k=Math.sqrt(d*d+w*w)}if(a>=0&&a<=1&&k<h){A=g+a;h=k}}g=Math.floor(A);a=A-g;if(g<e.numberPoints-1){s=a*e.X(g+1)+(1-a)*e.X(g);m=a*e.Y(g+1)+(1-a)*e.Y(g)}else{s=e.X(g);m=e.Y(g)}z=new JXG.Coords(JXG.COORDS_BY_USER,[s,m],this.board)}else{A=s;s=A;m=e.Y(A);z=new JXG.Coords(JXG.COORDS_BY_USER,[s,m],this.board)}}return[e.updateTransform(z),A]};JXG.Algebra.prototype.projectPointToTurtle=function(q,w){var u,z,m,l,d,s=0,h=0,e=1000000,k,a,b,g=w.objects.length;for(d=0;d<g;d++){a=w.objects[d];if(a.type==JXG.OBJECT_TYPE_CURVE){u=this.projectPointToCurve(q,a);k=this.distance(u.usrCoords,q.coords.usrCoords);if(k<e){m=u.usrCoords[1];l=u.usrCoords[2];z=q.position;e=k;b=a;h=s}s+=a.numberPoints}}u=new JXG.Coords(JXG.COORDS_BY_USER,[m,l],this.board);q.position=z+h;return b.updateTransform(u)};JXG.Algebra.prototype.replacePow=function(d){var k,q,l,h,m,e,a,b,g,u,s;g=d.indexOf("^");while(g>=0){b=d.slice(0,g);if(b.charAt(b.length-1)==")"){k=1;q=b.length-2;while(q>=0&&k>0){l=b.charAt(q);if(l==")"){k++}else{if(l=="("){k--}}q--}if(k==0){h="";e=b.substring(0,q+1);a=q;while(a>=0&&e.substr(a,1).match(/(\w+)/)){h=RegExp.$1+h;a--}h+=b.substring(q+1,b.length);h=h.replace(/([\(\)\+\*\%\^\-\/\]\[])/g,"\\$1")}}else{h="\\w+"}u=d.slice(g+1);if(u.match(/^([\w\.]*\()/)){k=1;q=RegExp.$1.length;while(q<u.length&&k>0){l=u.charAt(q);if(l==")"){k--}else{if(l=="("){k++}}q++}if(k==0){m=u.substring(0,q);m=m.replace(/([\(\)\+\*\%\^\-\/\[\]])/g,"\\$1")}}else{m="[\\w\\.]+"}s=new RegExp("("+h+")\\^("+m+")");d=d.replace(s,"this.board.algebra.pow($1,$2)");g=d.indexOf("^")}return d};JXG.Algebra.prototype.replaceIf=function(b){var A="",d,z,g=null,a=null,l=null,e,w,h,m,k,q,u;e=b.indexOf("If(");if(e<0){return b}b=b.replace(/""/g,"0");while(e>=0){d=b.slice(0,e);z=b.slice(e+3);h=1;w=0;m=-1;k=-1;while(w<z.length&&h>0){q=z.charAt(w);if(q==")"){h--}else{if(q=="("){h++}else{if(q==","&&h==1){if(m<0){m=w}else{k=w}}}}w++}u=z.slice(0,w-1);z=z.slice(w);if(m<0){return""}if(k<0){return""}g=u.slice(0,m);a=u.slice(m+1,k);l=u.slice(k+1);g=this.replaceIf(g);a=this.replaceIf(a);l=this.replaceIf(l);A+=d+"(("+g+")?("+a+"):("+l+"))";b=z;g=null;a=null;e=b.indexOf("If(")}A+=z;return A};JXG.Algebra.prototype.replaceSub=function(d){if(d.indexOf){}else{return d}var b=d.indexOf("_{"),a;while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/_\{/,"<sub>");a=d.substr(b).indexOf("}");if(a>=0){d=d.substr(0,a)+d.substr(a).replace(/\}/,"</sub>")}b=d.indexOf("_{")}b=d.indexOf("_");while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/_(.?)/,"<sub>$1</sub>");b=d.indexOf("_")}return d};JXG.Algebra.prototype.replaceSup=function(d){if(d.indexOf){}else{return d}var b=d.indexOf("^{"),a;while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/\^\{/,"<sup>");a=d.substr(b).indexOf("}");if(a>=0){d=d.substr(0,a)+d.substr(a).replace(/\}/,"</sup>")}b=d.indexOf("^{")}b=d.indexOf("^");while(b>=0){d=d.substr(0,b)+d.substr(b).replace(/\^(.?)/,"<sup>$1</sup>");b=d.indexOf("^")}return d};JXG.Algebra.prototype.replaceNameById=function(b){var g=0,a,e,d;g=b.indexOf("X(");while(g>=0){if(g>=0){a=b.indexOf(")",g+2);if(a>=0){e=b.slice(g+2,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+2)+d.id+b.slice(a)}}a=b.indexOf(")",g+2);g=b.indexOf("X(",a)}g=b.indexOf("Y(");while(g>=0){if(g>=0){a=b.indexOf(")",g+2);if(a>=0){e=b.slice(g+2,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+2)+d.id+b.slice(a)}}a=b.indexOf(")",g+2);g=b.indexOf("Y(",a)}g=b.indexOf("L(");while(g>=0){if(g>=0){a=b.indexOf(")",g+2);if(a>=0){e=b.slice(g+2,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+2)+d.id+b.slice(a)}}a=b.indexOf(")",g+2);g=b.indexOf("L(",a)}g=b.indexOf("Dist(");while(g>=0){if(g>=0){a=b.indexOf(",",g+5);if(a>=0){e=b.slice(g+5,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+5)+d.id+b.slice(a)}}a=b.indexOf(",",g+5);g=b.indexOf(",",a);a=b.indexOf(")",g+1);if(a>=0){e=b.slice(g+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+1)+d.id+b.slice(a)}a=b.indexOf(")",g+1);g=b.indexOf("Dist(",a)}g=b.indexOf("Deg(");while(g>=0){if(g>=0){a=b.indexOf(",",g+4);if(a>=0){e=b.slice(g+4,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+4)+d.id+b.slice(a)}}a=b.indexOf(",",g+4);g=b.indexOf(",",a);a=b.indexOf(",",g+1);if(a>=0){e=b.slice(g+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+1)+d.id+b.slice(a)}a=b.indexOf(",",g+1);g=b.indexOf(",",a);a=b.indexOf(")",g+1);if(a>=0){e=b.slice(g+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+1)+d.id+b.slice(a)}a=b.indexOf(")",g+1);g=b.indexOf("Deg(",a)}g=b.indexOf("Rad(");while(g>=0){if(g>=0){a=b.indexOf(",",g+4);if(a>=0){e=b.slice(g+4,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+4)+d.id+b.slice(a)}}a=b.indexOf(",",g+4);g=b.indexOf(",",a);a=b.indexOf(",",g+1);if(a>=0){e=b.slice(g+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+1)+d.id+b.slice(a)}a=b.indexOf(",",g+1);g=b.indexOf(",",a);a=b.indexOf(")",g+1);if(a>=0){e=b.slice(g+1,a);e=e.replace(/\\(['"])?/g,"$1");d=this.board.elementsByName[e];b=b.slice(0,g+1)+d.id+b.slice(a)}a=b.indexOf(")",g+1);g=b.indexOf("Rad(",a)}return b};JXG.Algebra.prototype.replaceIdByObj=function(a){var b=/(X|Y|L)\(([\w_]+)\)/g;a=a.replace(b,'this.board.objects["$2"].$1()');b=/(Dist)\(([\w_]+),([\w_]+)\)/g;a=a.replace(b,'this.board.objects["$2"].Dist(this.board.objects["$3"])');b=/(Deg)\(([\w_]+),([ \w\[\w_]+),([\w_]+)\)/g;a=a.replace(b,'this.board.algebra.trueAngle(this.board.objects["$2"],this.board.objects["$3"],this.board.objects["$4"])');b=/Rad\(([\w_]+),([\w_]+),([\w_]+)\)/g;a=a.replace(b,'this.board.algebra.rad(this.board.objects["$1"],this.board.objects["$2"],this.board.objects["$3"])');return a};JXG.Algebra.prototype.geonext2JS=function(b){var e,d,a,h=["Abs","ACos","ASin","ATan","Ceil","Cos","Exp","Floor","Log","Max","Min","Pow","Random","Round","Sin","Sqrt","Tan","Trunc"],g=["Math.abs","Math.acos","Math.asin","Math.atan","Math.ceil","Math.cos","Math.exp","Math.floor","Math.log","Math.max","Math.min","Math.pow","Math.random","this.board.round","Math.sin","Math.sqrt","Math.tan","Math.ceil"];b=b.replace(/&lt;/g,"<");b=b.replace(/&gt;/g,">");b=b.replace(/&amp;/g,"&");d=b;d=this.replaceNameById(d);d=this.replaceIf(d);d=this.replacePow(d);d=this.replaceIdByObj(d);for(a=0;a<h.length;a++){e=new RegExp(h[a],"g");d=d.replace(e,g[a])}d=d.replace(/True/g,"true");d=d.replace(/False/g,"false");d=d.replace(/fasle/g,"false");d=d.replace(/Pi/g,"Math.PI");return d};JXG.Algebra.prototype.findDependencies=function(e,b){var g=this.board.elementsByName,d,h,a;for(d in g){if(d!=e.name){if(g[d].type==JXG.OBJECT_TYPE_TEXT){if(!g[d].isLabel){a=d.replace(/\[/g,"\\[");a=a.replace(/\]/g,"\\]");h=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+a+")(,[\\w\\[\\]'_ ]+)*\\)","g");if(b.search(h)>=0){g[d].addChild(e)}}}else{a=d.replace(/\[/g,"\\[");a=a.replace(/\]/g,"\\]");h=new RegExp("\\(([\\w\\[\\]'_ ]+,)*("+a+")(,[\\w\\[\\]'_ ]+)*\\)","g");if(b.search(h)>=0){g[d].addChild(e)}}}}};JXG.Algebra.prototype.distance=function(g,e){var d=0,b,a;if(g.length!=e.length){return}a=g.length;for(b=0;b<a;b++){d+=(g[b]-e[b])*(g[b]-e[b])}return Math.sqrt(d)};JXG.Algebra.prototype.affineDistance=function(b,a){var e;if(b.length!=a.length){return}e=this.distance(b,a);if(e>this.eps&&(Math.abs(b[0])<this.eps||Math.abs(a[0])<this.eps)){return Infinity}else{return e}};JXG.Algebra.prototype.str2Bool=function(a){if(a==undefined||a==null){return true}if(typeof a=="boolean"){return a}if(a.toLowerCase()!="true"){return false}else{return true}};JXG.Algebra.prototype.pow=function(e,d){if(e==0||d==0){return 1}if(Math.floor(d)==d){return Math.pow(e,d)}else{if(e>0){return Math.exp(d*Math.log(Math.abs(e)))}else{return NaN}}};JXG.Algebra.prototype.crossProduct=function(b,a){return[b[1]*a[2]-b[2]*a[1],b[2]*a[0]-b[0]*a[2],b[0]*a[1]-b[1]*a[0]]};JXG.Algebra.prototype.innerProduct=function(e,d,k){var g,h=0;if(typeof k=="undefined"){k=e.length}for(g=0;g<k;g++){h+=e[g]*d[g]}return h};JXG.Algebra.prototype.meet=function(e,b,d){var a=this.eps;if(Math.abs(e[3])<a&&Math.abs(b[3])<a){return this.meetLineLine(e,b,d)}else{if(Math.abs(e[3])>=a&&Math.abs(b[3])<a){return this.meetLineCircle(b,e,d)}else{if(Math.abs(e[3])<a&&Math.abs(b[3])>=a){return this.meetLineCircle(e,b,d)}else{return this.meetCircleCircle(e,b,d)}}}};JXG.Algebra.prototype.meetLineLine=function(b,a,d){var e=this.crossProduct(b,a);if(Math.abs(e[0])>this.eps){e[1]/=e[0];e[2]/=e[0];e[0]=1}return new JXG.Coords(JXG.COORDS_BY_USER,e,this.board)};JXG.Algebra.prototype.meetLineCircle=function(m,e,u){var E,D,z,w,q,l,h,g,s,F;if(e[4]<this.eps){return new JXG.Coords(JXG.COORDS_BY_USER,e.slice(1,3),this.board)}z=e[0];D=e.slice(1,3);E=e[3];w=m[0];q=m.slice(1,3);l=E;h=(D[0]*q[1]-D[1]*q[0]);g=E*w*w-(D[0]*q[0]+D[1]*q[1])*w+z;s=h*h-4*l*g;if(s>=0){s=Math.sqrt(s);F=[(-h+s)/(2*l),(-h-s)/(2*l)];return((u==0)?new JXG.Coords(JXG.COORDS_BY_USER,[-F[0]*(-q[1])-w*q[0],-F[0]*q[0]-w*q[1]],this.board):new JXG.Coords(JXG.COORDS_BY_USER,[-F[1]*(-q[1])-w*q[0],-F[1]*q[0]-w*q[1]],this.board))}else{return new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)}};JXG.Algebra.prototype.meetCircleCircle=function(d,a,b){var e;if(d[4]<this.eps){if(this.distance(d.slice(1,3),a.slice(1,3))==a[4]){return new JXG.Coords(JXG.COORDS_BY_USER,d.slice(1,3),this.board)}else{return new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)}}if(a[4]<this.eps){if(this.distance(a.slice(1,3),d.slice(1,3))==d[4]){return new JXG.Coords(JXG.COORDS_BY_USER,a.slice(1,3),this.board)}else{return new JXG.Coords(JXG.COORDS_BY_USER,[NaN,NaN],this.board)}}e=[a[3]*d[0]-d[3]*a[0],a[3]*d[1]-d[3]*a[1],a[3]*d[2]-d[3]*a[2],0,1,Infinity,Infinity,Infinity];e=this.normalize(e);return this.meetLineCircle(e,d,b)};JXG.Algebra.prototype.normalize=function(d){var a=2*d[3],e=d[4]/(a),g,b;d[5]=e;d[6]=-d[1]/a;d[7]=-d[2]/a;if(e==Infinity||isNaN(e)){g=Math.sqrt(d[1]*d[1]+d[2]*d[2]);d[0]/=g;d[1]/=g;d[2]/=g;d[3]=0;d[4]=1}else{if(Math.abs(e)>=1){d[0]=(d[6]*d[6]+d[7]*d[7]-e*e)/(2*e);d[1]=-d[6]/e;d[2]=-d[7]/e;d[3]=1/(2*e);d[4]=1}else{b=(e<=0)?(-1):(1);d[0]=b*(d[6]*d[6]+d[7]*d[7]-e*e)*0.5;d[1]=-b*d[6];d[2]=-b*d[7];d[3]=b/2;d[4]=b*e}}return d};JXG.Algebra.prototype.meetCurveCurve=function(A,z,h,m){var q=0,u,s,J,H,E,D,g,C,B,w,I,G,l,k;if(arguments.callee.t1memo){u=arguments.callee.t1memo;s=arguments.callee.t2memo}else{u=h;s=m}if(u>A.maxX()){u=A.maxX()}if(u<A.minX()){u=A.minX()}if(s>z.maxX()){s=z.maxX()}if(s<z.minX()){s=z.minX()}C=A.X(u)-z.X(s);B=A.Y(u)-z.Y(s);w=C*C+B*B;I=A.board.D(A.X,A);G=z.board.D(z.X,z);l=A.board.D(A.Y,A);k=z.board.D(z.Y,z);while(w>JXG.Math.eps&&q<10){J=I(u);H=-G(s);E=l(u);D=-k(s);g=J*D-H*E;u-=(D*C-H*B)/g;s-=(J*B-E*C)/g;C=A.X(u)-z.X(s);B=A.Y(u)-z.Y(s);w=C*C+B*B;q++}arguments.callee.t1memo=u;arguments.callee.t2memo=s;if(Math.abs(u)<Math.abs(s)){return(new JXG.Coords(JXG.COORDS_BY_USER,[A.X(u),A.Y(u)],this.board))}else{return(new JXG.Coords(JXG.COORDS_BY_USER,[z.X(s),z.Y(s)],this.board))}};JXG.Intersection=function(g,b,e,d,k,h,s,q){this.constructor();this.board=g;this.id=b;this.name=this.id;this.visProp={};this.visProp.visible=true;this.show=true;this.real=true;this.notExistingParents={};this.intersect1=JXG.getReference(this.board,e);this.intersect2=JXG.getReference(this.board,d);this.type=JXG.OBJECT_TYPE_INTERSECTION;if(((this.intersect1=="")||(this.intersect1==undefined))&&((this.intersect2=="")||(this.intersect2==undefined))){return}if(((this.intersect1.type==this.intersect2.type)&&(this.intersect1.type==JXG.OBJECT_TYPE_LINE||this.intersect1.type==JXG.OBJECT_TYPE_ARROW))||((this.intersect1.type==JXG.OBJECT_TYPE_LINE)&&(this.intersect2.type==JXG.OBJECT_TYPE_ARROW))||((this.intersect2.type==JXG.OBJECT_TYPE_LINE)&&(this.intersect1.type==JXG.OBJECT_TYPE_ARROW))){var l=this.board.algebra.intersectLineLine(this.intersect1,this.intersect2).usrCoords.slice(1);this.p=new JXG.Point(this.board,l,k,s,true);this.p.fixed=true;this.addChild(this.p);this.real=true;this.update=function(){if(this.needsUpdate){this.p.coords=this.board.algebra.intersectLineLine(this.intersect1,this.intersect2);this.needsUpdate=false}};this.hideElement=function(){this.visProp.visible=false;this.p.hideElement()};this.showElement=function(){this.visProp.visible=true;this.p.showElement()};this.hideChild=function(w){this.notExistingParents[w]=this.board.objects[w];for(var u in this.descendants){if(this.descendants[u].visProp.visible&&this.descendants[u].type!=JXG.OBJECT_TYPE_INTERSECTION){if(this.descendants[u].type!=JXG.OBJECT_TYPE_TEXT){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}else{if(!this.descendants[u].isLabel){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}}}this.descendants[u].notExistingParents[w]=this.board.objects[w]}};this.showChild=function(w){for(var u in this.board.objects){delete (this.board.objects[u].notExistingParents[w]);if(this.board.objects[u].visProp.visible&&JXG.keys(this.board.objects[u].notExistingParents).length==0){if(this.board.objects[u].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[u].showElement()}}}}}else{if(((e.type==d.type)&&(e.type==JXG.OBJECT_TYPE_CIRCLE||e.type==JXG.OBJECT_TYPE_ARC))||(e.type==JXG.OBJECT_TYPE_CIRCLE&&d.type==JXG.OBJECT_TYPE_ARC)||(d.type==JXG.OBJECT_TYPE_CIRCLE&&e.type==JXG.OBJECT_TYPE_ARC)){this.p1=new JXG.Point(this.board,[0,0],k,s,false);this.p1.fixed=true;this.p1.label.content.visProp.visible=true;this.p2=new JXG.Point(this.board,[0,0],h,q,false);this.p2.fixed=true;this.p2.label.content.visProp.visible=true;this.addChild(this.p1);this.addChild(this.p2);var m=this.board.algebra.intersectCircleCircle(this.intersect1,this.intersect2);if(m[0]==1){this.p1.coords=m[1];this.p1.showElement();this.p1.updateRenderer();this.p2.coords=m[2];this.p2.showElement();this.p2.updateRenderer();this.real=true}else{this.real=false}this.update=function(){if(!this.needsUpdate){return}var z=this.board.algebra.intersectCircleCircle(this.intersect1,this.intersect2);var w=this.p1.visProp.visible;var u=this.p2.visProp.visible;if(z[0]==0){if(this.real){this.hideChild(this.id);this.p1.visProp.visible=w;this.p2.visProp.visible=u;this.real=false}}else{this.p1.coords=z[1];this.p2.coords=z[2];if(!this.real){this.showChild(this.id);this.real=true}}this.needsUpdate=false};this.hideElement=function(){this.visProp.visible=false;this.p1.hideElement();this.p2.hideElement()};this.showElement=function(){this.visProp.visible=true;this.p1.showElement();this.p2.showElement()};this.hideChild=function(w){this.notExistingParents[w]=this.board.objects[w];for(var u in this.descendants){if(this.descendants[u].visProp.visible&&this.descendants[u].type!=JXG.OBJECT_TYPE_INTERSECTION){if(this.descendants[u].type!=JXG.OBJECT_TYPE_TEXT){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}else{if(!this.descendants[u].isLabel){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}}}this.descendants[u].notExistingParents[w]=this.board.objects[w]}};this.showChild=function(u){for(el in this.board.objects){delete (this.board.objects[el].notExistingParents[u]);if(this.board.objects[el].visProp.visible&&JXG.keys(this.board.objects[el].notExistingParents).length==0){if(this.board.objects[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[el].showElement()}}}}}else{this.p1=new JXG.Point(this.board,[0,0],k,s,false);this.p1.fixed=true;this.p1.label.content.visProp.visible=true;this.p2=new JXG.Point(this.board,[0,0],h,q,false);this.p2.fixed=true;this.p2.label.content.visProp.visible=true;this.addChild(this.p1);this.addChild(this.p2);if(this.intersect1.type==JXG.OBJECT_TYPE_LINE||this.intersect1.type==JXG.OBJECT_TYPE_ARROW){var a=this.intersect1;this.intersect1=this.intersect2;this.intersect2=a}var m=this.board.algebra.intersectCircleLine(this.intersect1,this.intersect2);if(m[0]==1){this.p1.coords=m[1];this.p1.showElement();this.p1.update()}else{if(m[0]==2){this.p1.coords=m[1];this.p1.showElement();this.p2.coords=m[2];this.p2.showElement();this.p1.updateRenderer();this.p2.updateRenderer();this.real=true}else{this.real=false}}this.update=function(){if(!this.needsUpdate){return}var z=this.board.algebra.intersectCircleLine(this.intersect1,this.intersect2);var w=this.p1.visProp.visible;var u=this.p2.visProp.visible;if(z[0]==0){if(this.real){this.hideChild(this.id);this.p1.visProp.visible=w;this.p2.visProp.visible=u;this.real=false}}else{if(z[0]==2){this.p1.coords=z[1];this.p2.coords=z[2];if(!this.real){this.showChild(this.id);this.real=true}}}this.needsUpdate=false};this.hideElement=function(){this.visProp.visible=false;this.p1.hideElement();this.p2.hideElement()};this.showElement=function(){this.visProp.visible=true;this.p1.showElement();this.p2.showElement()};this.hideChild=function(w){this.notExistingParents[w]=this.board.objects[w];for(var u in this.descendants){if(this.descendants[u].visProp.visible&&this.descendants[u].type!=JXG.OBJECT_TYPE_INTERSECTION){if(this.descendants[u].type!=JXG.OBJECT_TYPE_TEXT){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}else{if(!this.descendants[u].isLabel){this.descendants[u].hideElement();this.descendants[u].visProp.visible=true}}}this.descendants[u].notExistingParents[w]=this.board.objects[w]}};this.showChild=function(u){for(el in this.board.objects){delete (this.board.objects[el].notExistingParents[u]);if(this.board.objects[el].visProp.visible&&JXG.keys(this.board.objects[el].notExistingParents).length==0){if(this.board.objects[el].type!=JXG.OBJECT_TYPE_INTERSECTION){this.board.objects[el].showElement()}}}}}}this.id=this.board.addIntersection(this)};JXG.Intersection.prototype=new JXG.GeometryElement();JXG.Intersection.prototype.update=function(){return};JXG.Intersection.prototype.hasPoint=function(a,b){return false};JXG.Intersection.prototype.hideChild=function(a){};JXG.Intersection.prototype.showChild=function(a){};JXG.Intersection.prototype.remove=function(){if(this.p!=undefined){this.board.removeObject(this.p)}if(this.p1!=undefined){this.board.removeObject(this.p1)}if(this.p2!=undefined){this.board.removeObject(this.p2)}return};JXG.Intersection.prototype.updateRenderer=function(){};JXG.createPerpendicularPoint=function(d,h,g){var a,e,b;if(JXG.isPoint(h[0])&&h[1].type==JXG.OBJECT_TYPE_LINE){e=h[0];a=h[1]}else{if(JXG.isPoint(h[1])&&h[0].type==JXG.OBJECT_TYPE_LINE){e=h[1];a=h[0]}else{throw new Error("JSXGraph: Can't create perpendicular point with parent types '"+(typeof h[0])+"' and '"+(typeof h[1])+"'.")}}b=JXG.createPoint(d,[function(){return d.algebra.perpendicular(a,e)[0]}],{fixed:true,name:g.name,id:g.id});e.addChild(b);a.addChild(b);b.update();b.generatePolynomial=function(){var l=a.point1.symbolic.x;var k=a.point1.symbolic.y;var z=a.point2.symbolic.x;var w=a.point2.symbolic.y;var B=e.symbolic.x;var A=e.symbolic.y;var s=b.symbolic.x;var m=b.symbolic.y;var u="("+k+")*("+s+")-("+k+")*("+z+")+("+m+")*("+z+")-("+l+")*("+m+")+("+l+")*("+w+")-("+s+")*("+w+")";var q="("+A+")*("+k+")-("+A+")*("+w+")-("+m+")*("+k+")+("+m+")*("+w+")+("+B+")*("+l+")-("+B+")*("+z+")-("+s+")*("+l+")+("+s+")*("+z+")";return[u,q]};return b};JXG.createPerpendicular=function(e,k,h){var g,a,b,d;k[0]=JXG.getReference(e,k[0]);k[1]=JXG.getReference(e,k[1]);if(JXG.isPoint(k[0])&&k[1].elementClass==JXG.OBJECT_CLASS_LINE){a=k[1];g=k[0]}else{if(JXG.isPoint(k[1])&&k[0].elementClass==JXG.OBJECT_CLASS_LINE){a=k[0];g=k[1]}else{throw new Error("JSXGraph: Can't create perpendicular with parent types '"+(typeof k[0])+"' and '"+(typeof k[1])+"'.")}}if(!JXG.isArray(h.id)){h.id=["",""]}if(!JXG.isArray(h.name)){h.name=["",""]}d=JXG.createPerpendicularPoint(e,[a,g],{fixed:true,name:h.name[1],id:h.id[1],visible:false});b=JXG.createSegment(e,[function(){return(e.algebra.perpendicular(a,g)[1]?[d,g]:[g,d])}],{name:h.name[0],id:h.id[0]});return[b,d]};JXG.createMidpoint=function(h,l,k){var e,d,g;if(l.length==2&&JXG.isPoint(l[0])&&JXG.isPoint(l[1])){e=l[0];d=l[1]}else{if(l.length==1&&l[0].elementClass==JXG.OBJECT_CLASS_LINE){e=l[0].point1;d=l[0].point2}else{throw new Error("JSXGraph: Can't create midpoint.")}}if(k){k.fixed=true}else{k={fixed:true}}g=h.createElement("point",[function(){return(e.coords.usrCoords[1]+d.coords.usrCoords[1])/2},function(){return(e.coords.usrCoords[2]+d.coords.usrCoords[2])/2}],k);e.addChild(g);d.addChild(g);g.update();g.generatePolynomial=function(){var m=e.symbolic.x;var b=e.symbolic.y;var s=d.symbolic.x;var q=d.symbolic.y;var w=g.symbolic.x;var u=g.symbolic.y;var a="("+b+")*("+w+")-("+b+")*("+s+")+("+u+")*("+s+")-("+m+")*("+u+")+("+m+")*("+q+")-("+w+")*("+q+")";var z="("+m+")^2 - 2*("+m+")*("+w+")+("+b+")^2-2*("+b+")*("+u+")-("+s+")^2+2*("+s+")*("+w+")-("+q+")^2+2*("+q+")*("+u+")";return[a,z]};if(JXG.nullAtts){k=null}return g};JXG.createParallelPoint=function(g,m,l){var e,d,k,h;if(m.length==3&&m[0].elementClass==JXG.OBJECT_CLASS_POINT&&m[1].elementClass==JXG.OBJECT_CLASS_POINT&&m[2].elementClass==JXG.OBJECT_CLASS_POINT){e=m[0];d=m[1];k=m[2]}else{if(m[0].elementClass==JXG.OBJECT_CLASS_POINT&&m[1].elementClass==JXG.OBJECT_CLASS_LINE){k=m[0];e=m[1].point1;d=m[1].point2}else{if(m[1].elementClass==JXG.OBJECT_CLASS_POINT&&m[0].elementClass==JXG.OBJECT_CLASS_LINE){k=m[1];e=m[0].point1;d=m[0].point2}else{throw new Error("JSXGraph: Can't create parallel point with parent types '"+(typeof m[0])+"', '"+(typeof m[1])+"' and '"+(typeof m[2])+"'.")}}}h=g.createElement("point",[function(){return k.coords.usrCoords[1]+d.coords.usrCoords[1]-e.coords.usrCoords[1]},function(){return k.coords.usrCoords[2]+d.coords.usrCoords[2]-e.coords.usrCoords[2]}],l);k.addChild(h);h.update();h.generatePolynomial=function(){var b=e.symbolic.x;var a=e.symbolic.y;var C=d.symbolic.x;var B=d.symbolic.y;var s=k.symbolic.x;var q=k.symbolic.y;var z=h.symbolic.x;var u=h.symbolic.y;var A="("+B+")*("+z+")-("+B+")*("+s+")-("+a+")*("+z+")+("+a+")*("+s+")-("+u+")*("+C+")+("+u+")*("+b+")+("+q+")*("+C+")-("+q+")*("+b+")";var w="("+u+")*("+b+")-("+u+")*("+s+")-("+B+")*("+b+")+("+B+")*("+s+")-("+z+")*("+a+")+("+z+")*("+q+")+("+C+")*("+a+")-("+C+")*("+q+")";return[A,w]};return h};JXG.createParallel=function(g,b,m){var l,a,d,h;h={name:null,id:null,fixed:true,visible:false};if(JXG.isArray(m.name)&&m.name.length==2){h.name=m.name[1];m.name=m.name[0]}else{h.name=m.name+"p2"}if(JXG.isArray(m.id)&&m.id.length==2){h.id=m.id[1];m.id=m.id[0]}else{h.id=m.id+"p2"}if(m){h=JXG.cloneAndCopy(m,h)}try{a=JXG.createParallelPoint(g,b,h)}catch(k){throw new Error("JSXGraph: Can't create parallel with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}l=null;if(b.length==3){l=b[2]}else{if(b[0].elementClass==JXG.OBJECT_CLASS_POINT){l=b[0]}else{if(b[1].elementClass==JXG.OBJECT_CLASS_POINT){l=b[1]}}}d=g.createElement("line",[l,a],m);return d};JXG.createArrowParallel=function(d,b,k){var a,g;try{a=JXG.createParallel(d,b,k)}catch(h){throw new Error("JSXGraph: Can't create arrowparallel with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}a.setStraight(false,false);a.setArrow(false,true);return a};JXG.createNormal=function(d,b,a){var k;var l;if(b.length==1){k=b[0];l=k.slideObject}else{if(b.length==2){if(JXG.isPoint(b[0])){k=b[0];l=b[1]}else{if(JXG.isPoint(b[1])){l=b[0];k=b[1]}else{throw new Error("JSXGraph: Can't create normal with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}}}else{throw new Error("JSXGraph: Can't create normal with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}}if(l.elementClass==JXG.OBJECT_CLASS_LINE){return d.createElement("line",[function(){return l.stdform[1]*k.Y()-l.stdform[2]*k.X()},function(){return l.stdform[2]*k.Z()},function(){return -l.stdform[1]*k.Z()}],a)}else{if(l.elementClass==JXG.OBJECT_CLASS_CIRCLE){return d.createElement("line",[l.midpoint,k],a)}else{if(l.elementClass==JXG.OBJECT_CLASS_CURVE){if(l.curveType!="plot"){var e=l.X;var h=l.Y;return d.createElement("line",[function(){return -k.X()*d.D(e)(k.position)-k.Y()*d.D(h)(k.position)},function(){return d.D(e)(k.position)},function(){return d.D(h)(k.position)}],a)}else{return d.createElement("line",[function(){var m=Math.floor(k.position);var g=k.position-m;if(m==l.numberPoints-1){m--;g=1}if(m<0){return 1}return(l.Y(m)+g*(l.Y(m+1)-l.Y(m)))*(l.Y(m)-l.Y(m+1))-(l.X(m)+g*(l.X(m+1)-l.X(m)))*(l.X(m+1)-l.X(m))},function(){var g=Math.floor(k.position);if(g==l.numberPoints-1){g--}if(g<0){return 0}return l.X(g+1)-l.X(g)},function(){var g=Math.floor(k.position);if(g==l.numberPoints-1){g--}if(g<0){return 0}return l.Y(g+1)-l.Y(g)}],a)}}else{if(l.type==JXG.OBJECT_TYPE_TURTLE){return d.createElement("line",[function(){var q=Math.floor(k.position);var g=k.position-q;var s,m;for(m=0;m<l.objects.length;m++){s=l.objects[m];if(s.type==JXG.OBJECT_TYPE_CURVE){if(q<s.numberPoints){break}q-=s.numberPoints}}if(q==s.numberPoints-1){q--;g=1}if(q<0){return 1}return(s.Y(q)+g*(s.Y(q+1)-s.Y(q)))*(s.Y(q)-s.Y(q+1))-(s.X(q)+g*(s.X(q+1)-s.X(q)))*(s.X(q+1)-s.X(q))},function(){var m=Math.floor(k.position);var q,g;for(g=0;g<l.objects.length;g++){q=l.objects[g];if(q.type==JXG.OBJECT_TYPE_CURVE){if(m<q.numberPoints){break}m-=q.numberPoints}}if(m==q.numberPoints-1){m--}if(m<0){return 0}return q.X(m+1)-q.X(m)},function(){var m=Math.floor(k.position);var q,g;for(g=0;g<l.objects.length;g++){q=l.objects[g];if(q.type==JXG.OBJECT_TYPE_CURVE){if(m<q.numberPoints){break}m-=q.numberPoints}}if(m==q.numberPoints-1){m--}if(m<0){return 0}return q.Y(m+1)-q.Y(m)}],a)}else{throw new Error("JSXGraph: Can't create normal with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"'.")}}}}};JXG.createBisector=function(d,k,h){var g,a,e,b;if(k[0].elementClass==JXG.OBJECT_CLASS_POINT&&k[1].elementClass==JXG.OBJECT_CLASS_POINT&&k[2].elementClass==JXG.OBJECT_CLASS_POINT){e={name:"",id:null,fixed:true,visible:false};if(h){e=JXG.cloneAndCopy(h,e)}g=d.createElement("point",[function(){return d.algebra.angleBisector(k[0],k[1],k[2])}],e);for(b=0;b<3;b++){k[b].addChild(g)}if(typeof h.straightFirst=="undefined"){h.straightFirst=false}if(typeof h.straightLast=="undefined"){h.straightLast=true}a=JXG.createLine(d,[k[1],g],h);return a}else{throw new Error("JSXGraph: Can't create angle bisector with parent types '"+(typeof k[0])+"' and '"+(typeof k[1])+"'.")}};JXG.createAngularBisectorsOfTwoLines=function(h,l,e){var d=JXG.getReference(h,l[0]);var b=JXG.getReference(h,l[1]);var q="";var m="";var k="";var g="";if(e==null){e={}}if(e.id!=null){if(JXG.isArray(e.id)){q=e.id[0];m=e.id[1]}else{q=e.id;m=e.id}}if(e.name!=null){if(JXG.isArray(e.name)){k=e.name[0];g=e.name[1]}else{k=e.name;g=e.name}}e.id=q;e.name=k;var a=h.createElement("line",[function(){var w=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[0]/w-b.stdform[0]/u},function(){var w=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[1]/w-b.stdform[1]/u},function(){var w=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[2]/w-b.stdform[2]/u}],e);e.id=m;e.name=g;var s=h.createElement("line",[function(){var w=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[0]/w+b.stdform[0]/u},function(){var w=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[1]/w+b.stdform[1]/u},function(){var w=Math.sqrt(d.stdform[1]*d.stdform[1]+d.stdform[2]*d.stdform[2]);var u=Math.sqrt(b.stdform[1]*b.stdform[1]+b.stdform[2]*b.stdform[2]);return d.stdform[2]/w+b.stdform[2]/u}],e);return[a,s]};JXG.createCircumcircleMidpoint=function(b,g,e){var d,a;if(g[0].elementClass==JXG.OBJECT_CLASS_POINT&&g[1].elementClass==JXG.OBJECT_CLASS_POINT&&g[2].elementClass==JXG.OBJECT_CLASS_POINT){e.fixed=e.fixed||true;d=JXG.createPoint(b,[function(){return b.algebra.circumcenterMidpoint(g[0],g[1],g[2])}],e);for(a=0;a<3;a++){g[a].addChild(d)}return d}else{throw new Error("JSXGraph: Can't create circumcircle midpoint with parent types '"+(typeof g[0])+"', '"+(typeof g[1])+"' and '"+(typeof g[2])+"'.")}};JXG.createCircumcircle=function(a,l,k){var g,h,b;b=JXG.clone(k);if(k.name&&JXG.isArray(k.name)){b.name=k.name[0];k.name=k.name[1]}if(k.id&&JXG.isArray(k.id)){b.id=k.id[0];k.id=k.id[1]}try{g=JXG.createCircumcircleMidpoint(a,l,b);h=JXG.createCircle(a,[g,l[0]],k)}catch(d){throw new Error("JSXGraph: Can't create circumcircle with parent types '"+(typeof l[0])+"', '"+(typeof l[1])+"' and '"+(typeof l[2])+"'.")}return[g,h]};JXG.createReflection=function(b,h,g){var a,e,d;if(h[0].elementClass==JXG.OBJECT_CLASS_POINT&&h[1].elementClass==JXG.OBJECT_CLASS_LINE){e=h[0];a=h[1]}else{if(h[1].elementClass==JXG.OBJECT_CLASS_POINT&&h[0].elementClass==JXG.OBJECT_CLASS_LINE){e=h[1];a=h[0]}else{throw new Error("JSXGraph: Can't create reflection point with parent types '"+(typeof h[0])+"' and '"+(typeof h[1])+"'.")}}g.fixed=true;d=JXG.createPoint(b,[function(){return b.algebra.reflection(a,e)}],g);e.addChild(d);a.addChild(d);d.update();return d};JXG.createMirrorPoint=function(a,e,d){var b;if(JXG.isPoint(e[0])&&JXG.isPoint(e[1])){d.fixed=d.fixed||true;b=JXG.createPoint(a,[function(){return a.algebra.rotation(e[0],e[1],Math.PI)}],d);for(i=0;i<2;i++){e[i].addChild(b)}}else{throw new Error("JSXGraph: Can't create mirror point with parent types '"+(typeof e[0])+"' and '"+(typeof e[1])+"'.")}b.update();return b};JXG.createIntegral=function(a,d,b){if(!JXG.isArray(b.id)||(b.id.length!=5)){b.id=["","","","",""]}if(!JXG.isArray(b.name)||(b.name.length!=5)){b.name=["","","","",""]}if(JXG.isArray(d[0])&&d[1].type==JXG.OBJECT_TYPE_CURVE){return a.addIntegral(d[0],d[1],b.id,b.name,b)}else{if(JXG.isArray(d[1])&&d[0].type==JXG.OBJECT_TYPE_CURVE){return a.addIntegral(d[1],d[0],b.id,b.name,b)}else{throw new Error("JSXGraph: Can't create integral with parent types '"+(typeof d[0])+"' and '"+(typeof d[1])+"'.")}}};JXG.createLocus=function(d,b,a){var g,e;if(JXG.isArray(b)&&b.length==1&&b[0].elementClass==JXG.OBJECT_CLASS_POINT){e=b[0]}else{throw new Error("JSXGraph: Can't create locus with parent of type other than point.")}g=d.createElement("curve",[[null],[null]],a);g.dontCallServer=false;g.updateDataArray=function(){cb=function(k,l,h){g.dataX=k;g.dataY=l;d.update()};if(d.mode==d.BOARD_MODE_NONE&&!this.dontCallServer){JXG.Math.Symbolic.geometricLocusByGroebnerBase(d,e,cb);this.dontCallServer=true}else{this.dontCallServer=false}};return g};JXG.JSXGraph.registerElement("arrowparallel",JXG.createArrowParallel);JXG.JSXGraph.registerElement("bisector",JXG.createBisector);JXG.JSXGraph.registerElement("bisectorlines",JXG.createAngularBisectorsOfTwoLines);JXG.JSXGraph.registerElement("circumcircle",JXG.createCircumcircle);JXG.JSXGraph.registerElement("circumcirclemidpoint",JXG.createCircumcircleMidpoint);JXG.JSXGraph.registerElement("integral",JXG.createIntegral);JXG.JSXGraph.registerElement("midpoint",JXG.createMidpoint);JXG.JSXGraph.registerElement("mirrorpoint",JXG.createMirrorPoint);JXG.JSXGraph.registerElement("normal",JXG.createNormal);JXG.JSXGraph.registerElement("parallel",JXG.createParallel);JXG.JSXGraph.registerElement("parallelpoint",JXG.createParallelPoint);JXG.JSXGraph.registerElement("perpendicular",JXG.createPerpendicular);JXG.JSXGraph.registerElement("perpendicularpoint",JXG.createPerpendicularPoint);JXG.JSXGraph.registerElement("reflection",JXG.createReflection);JXG.JSXGraph.registerElement("locus",JXG.createLocus);JXG.Text=function(l,u,h,s,d,a,e,q,m){this.constructor();this.type=JXG.OBJECT_TYPE_TEXT;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.init(l,d,a);this.contentStr=u;this.plaintextStr="";this.display=m||"html";if((typeof q!="undefined")&&(q!=null)){this.isLabel=q}else{this.isLabel=false}this.visProp.strokeColor=this.board.options.text.strokeColor;this.visProp.visible=true;if(e!=null){this.digits=e}else{this.digits=2}if((this.element=this.board.objects[h])){var g;this.relativeCoords=new JXG.Coords(JXG.COORDS_BY_USER,[parseFloat(s[0]),parseFloat(s[1])],this.board);if(!this.isLabel){g=this.element.getTextAnchor()}else{g=this.element.getLabelAnchor()}this.element.addChild(this);this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.relativeCoords.usrCoords[1]+g.usrCoords[1],this.relativeCoords.usrCoords[2]+g.usrCoords[2]],this.board)}else{this.X=JXG.createFunction(s[0],this.board,"");this.Y=JXG.createFunction(s[1],this.board,"");this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[this.X(),this.Y()],this.board);var k="this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.X(),this.Y()]);";this.updateCoords=new Function("",k)}if(typeof this.contentStr=="function"){this.updateText=function(){this.plaintextStr=this.contentStr()}}else{var b;if(typeof this.contentStr=="number"){b=(this.contentStr).toFixed(this.digits)}else{if(this.board.options.text.useASCIIMathML){b="'"+this.contentStr+"'"}else{b=this.generateTerm(this.contentStr)}}this.updateText=new Function("this.plaintextStr = "+b+";")}if(!this.isLabel){this.id=this.board.addText(this)}if(typeof this.contentStr=="string"){this.notifyParents(this.contentStr)}};JXG.Text.prototype=new JXG.GeometryElement();JXG.Text.prototype.hasPoint=function(a,b){return false};JXG.Text.prototype.setText=function(b){var a;if(typeof b=="number"){a=(b).toFixed(this.digits)}else{a=this.generateTerm(b)}this.updateText=new Function("this.plaintextStr = "+a+";");this.updateText();return this};JXG.Text.prototype.setCoords=function(a,b){this.X=function(){return a};this.Y=function(){return b};this.coords=new JXG.Coords(JXG.COORDS_BY_USER,[a,b],this.board);return this};JXG.Text.prototype.update=function(){if(this.needsUpdate){if(this.relativeCoords){var a;if(!this.isLabel){a=this.element.getTextAnchor()}else{a=this.element.getLabelAnchor()}this.coords.setCoordinates(JXG.COORDS_BY_USER,[this.relativeCoords.usrCoords[1]+a.usrCoords[1],this.relativeCoords.usrCoords[2]+a.usrCoords[2]])}else{this.updateCoords()}this.updateText()}return this};JXG.Text.prototype.updateRenderer=function(){if(this.needsUpdate){this.board.renderer.updateText(this);this.needsUpdate=false}return this};JXG.Text.prototype.generateTerm=function(g){var e=null;var k=this.board.elementsByName;var h='""';g=g.replace(/\r/g,"");g=g.replace(/\n/g,"");g=g.replace(/\"/g,'\\"');g=g.replace(/\'/g,"\\'");g=g.replace(/&amp;arc;/g,"&ang;");g=g.replace(/<arc\s*\/>/g,"&ang;");g=g.replace(/<sqrt\s*\/>/g,"&radic;");var d;d=g.indexOf("<value>");var a=g.indexOf("</value>");if(d>=0){while(d>=0){h+=' + "'+this.board.algebra.replaceSub(this.board.algebra.replaceSup(g.slice(0,d)))+'"';var b=g.slice(d+7,a);var e=this.board.algebra.geonext2JS(b);e=e.replace(/\\"/g,'"');e=e.replace(/\\'/g,"'");if(e.indexOf("toFixed")<0){h+="+("+e+").toFixed("+(this.digits)+")"}else{h+="+("+e+")"}g=g.slice(a+8);d=g.indexOf("<value>");a=g.indexOf("</value>")}}h+=' + "'+this.board.algebra.replaceSub(this.board.algebra.replaceSup(g))+'"';h=h.replace(/<overline>/g,"<span style=text-decoration:overline>");h=h.replace(/<\/overline>/g,"</span>");h=h.replace(/<arrow>/g,"<span style=text-decoration:overline>");h=h.replace(/<\/arrow>/g,"</span>");h=h.replace(/&amp;/g,"&");return h};JXG.Text.prototype.notifyParents=function(d){var b=null;var e=this.board.elementsByName;do{var a=/<value>([\w\s\*\/\^\-\+\(\)\[\],<>=!]+)<\/value>/;b=a.exec(d);if(b!=null){this.board.algebra.findDependencies(this,b[1]);d=d.substr(b.index);d=d.replace(a,"")}}while(b!=null);return this};JXG.createText=function(a,d,b){if(b==null){b={}}if(typeof b.display=="undefined"){b.display=a.options.text.defaultDisplay}return new JXG.Text(a,d[d.length-1],null,d,b.id,b.name,b.digits,false,b.display)};JXG.JSXGraph.registerElement("text",JXG.createText);JXG.Image=function(g,b,k,d,h,l,a,e){this.type=JXG.OBJECT_TYPE_IMAGE;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.transformations=[];this.init(g,l,a);this.coords=new JXG.Coords(JXG.COORDS_BY_USER,k,this.board);this.initialCoords=new JXG.Coords(JXG.COORDS_BY_USER,k,this.board);this.size=[d[0]*g.stretchX,d[1]*g.stretchY];this.url=b;this.displayLevel=h;this.parent=e;this.visProp.visible=true;this.id=this.board.addImage(this)};JXG.Image.prototype=new JXG.GeometryElement;JXG.Image.prototype.hasPoint=function(a,b){return false};JXG.Image.prototype.updateRenderer=function(){this.updateTransform();this.board.renderer.updateImage(this)};JXG.Image.prototype.updateTransform=function(){if(this.transformations.length==0){return}for(var a=0;a<this.transformations.length;a++){this.transformations[a].update()}};JXG.Image.prototype.addTransform=function(a){if(JXG.isArray(a)){for(var b=0;b<a.length;b++){this.transformations.push(a[b])}}else{this.transformations.push(a)}};JXG.createImage=function(d,b,e){var a;a=e.imageString;return new JXG.Image(d,b[0],b[1],b[2],"images",false,false,undefined)};JXG.JSXGraph.registerElement("image",JXG.createImage);JXG.createSlider=function(q,D,A){var k,h,E,l,F,s,d,b,C,G,m,g,e,a,B,z,u,w;k=D[0];h=D[1];E=D[2][0];l=D[2][1];F=D[2][2];s=F-E;if(A==null){A={}}if(A.strokeColor==null||typeof A.strokeColor=="undefined"){A.strokeColor="#000000"}if(A.fillColor==null||typeof A.fillColor=="undefined"){A.fillColor="#ffffff"}d=q.createElement("point",k,{visible:false,fixed:true,name:"",withLabel:false});b=q.createElement("point",h,{visible:false,fixed:true,name:"",withLabel:false});C=q.createElement("line",[d,b],{straightFirst:false,straightLast:false,strokewidth:1,name:"",withLabel:false,strokeColor:A.strokeColor});G=2;m=q.createElement("ticks",[C,b.Dist(d)/G],{insertTicks:true,drawLabels:false,drawZero:true});d.needsRegularUpdate=false;b.needsRegularUpdate=false;C.needsRegularUpdate=false;g=k[0]+(h[0]-k[0])*(l-E)/(F-E);e=k[1]+(h[1]-k[1])*(l-E)/(F-E);if(A.snapWidth!=null){w=A.snapWidth}if(A.snapwidth!=null){w=A.snapwidth}a=q.createElement("glider",[g,e,C],{style:6,strokeColor:A.strokeColor,fillColor:A.fillColor,showInfobox:false,name:A.name,snapWidth:w});B=q.createElement("line",[d,a],{straightFirst:false,straightLast:false,strokewidth:3,strokeColor:A.strokeColor,name:"",withLabel:false});a.Value=function(){return this.position*s+E};a._smax=F;a._smin=E;if(A.name&&A.name!=""){z=A.name+" = "}else{z=""}u=q.createElement("text",[((h[0]-k[0])*0.05+h[0]),((h[1]-k[1])*0.05+h[1]),function(){return z+(a.Value()).toFixed(2)}],{name:""});return a};JXG.JSXGraph.registerElement("slider",JXG.createSlider);JXG.Chart=function(k,q,e){this.constructor();if(q.length==0){return}this.elements=[];var d=e.id||"";var b=e.name||"";this.init(k,d,b);var s,m,g;if(q.length>0&&(typeof q[0]=="number")){m=q;s=[];for(g=0;g<m.length;g++){s[g]=g+1}}else{if(q.length==1){m=q[0];s=[];var h;if(JXG.isFunction(m)){h=m().length}else{h=m.length}for(g=0;g<h;g++){s[g]=g+1}}if(q.length==2){s=q[0];m=q[1]}}if(e==undefined){e={}}var a=e.chartStyle||"line";a=a.replace(/ /g,"");a=a.split(",");var l;for(g=0;g<a.length;g++){switch(a[g]){case"bar":l=this.drawBar(k,[s,m],e);break;case"line":l=this.drawLine(k,[s,m],e);break;case"fit":l=this.drawFit(k,[s,m],e);break;case"spline":l=this.drawSpline(k,[s,m],e);break;case"pie":l=this.drawPie(k,[m],e);break;case"point":l=this.drawPoints(k,[s,m],e);break}this.elements.push(l)}this.id=this.board.addChart(this);return this.elements};JXG.Chart.prototype=new JXG.GeometryElement;JXG.Chart.prototype.drawLine=function(g,e,b){var d=e[0],a=e[1];b.fillColor="none";b.highlightFillColor="none";var h=g.createElement("curve",[d,a],b);this.rendNode=h.rendNode;return h};JXG.Chart.prototype.drawSpline=function(g,d,b){var a=d[0],k=d[1],e;b.fillColor="none";b.highlightFillColor="none";var h=g.createElement("spline",[a,k],b);this.rendNode=h.rendNode;return h};JXG.Chart.prototype.drawFit=function(g,e,d){var a=e[0],l=e[1],h=(((typeof d.degree=="undefined")||(parseInt(d.degree)==NaN)||(parseInt(d.degree)<1))?1:parseInt(d.degree));d.fillColor="none";d.highlightFillColor="none";var b=JXG.Math.Numerics.regressionPolynomial(h,a,l);var k=g.createElement("functiongraph",[b],d);this.rendNode=k.rendNode;return k};JXG.Chart.prototype.drawBar=function(l,q,h){var k,g=[],s=q[0],m=q[1],u,d,C,B,b,a,z,e=[],A;if(h.fillOpacity==undefined){h.fillOpacity=0.6}if(h&&h.width){u=h.width}else{if(s.length<=1){u=1}else{u=s[1]-s[0];for(k=1;k<s.length-1;k++){u=(s[k+1]-s[k]<u)?(s[k+1]-s[k]):u}}u*=0.8}A=h.fillColor;for(k=0;k<s.length;k++){if(JXG.isFunction(s[k])){d=function(){return s[k]()-u*0.5};C=function(){return s[k]()};B=function(){return s[k]()+u*0.5}}else{d=s[k]-u*0.5;C=s[k];B=s[k]+u*0.5}if(JXG.isFunction(m[k])){a=b}else{a=m[k]+0.2}b=m[k];if(h.dir=="horizontal"){e[0]=l.createElement("point",[0,d],{name:"",fixed:true,visible:false});e[1]=l.createElement("point",[b,d],{name:"",fixed:true,visible:false});e[2]=l.createElement("point",[b,B],{name:"",fixed:true,visible:false});e[3]=l.createElement("point",[0,B],{name:"",fixed:true,visible:false});if(h.labels&&h.labels[k]){l.createElement("text",[b,B,h.labels[k]],h)}}else{e[0]=l.createElement("point",[d,0],{name:"",fixed:true,visible:false});e[1]=l.createElement("point",[d,b],{name:"",fixed:true,visible:false});e[2]=l.createElement("point",[B,b],{name:"",fixed:true,visible:false});e[3]=l.createElement("point",[B,0],{name:"",fixed:true,visible:false});if(h.labels&&h.labels[k]){l.createElement("text",[B,b,h.labels[k]],h)}}h.withLines=false;if(typeof A=="undefined"&&A==null){z=h.colorArray||["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"];h.fillColor=z[k%z.length]}g[k]=l.createElement("polygon",e,h)}this.rendNode=g[0].rendNode;return g};JXG.Chart.prototype.drawPoints=function(h,d,b){var e;var g=[];b.fixed=true;b.name="";var a=d[0];var k=d[1];for(e=0;e<a.length;e++){g[e]=h.createElement("point",[a[e],k[e]],b)}this.rendNode=g[0].rendNode;return g};JXG.Chart.prototype.drawPie=function(e,E,h){var k=E[0];if(k.length<=0){return}if(typeof k[0]=="function"){return}var D;var A=[];var m=[];var g=[];var q=e.mathStatistics.sum(k);var d=h.colorArray||["#B02B2C","#3F4C6B","#C79810","#D15600","#FFFF88","#C3D9FF","#4096EE","#008C00"];var H=h.highlightColorArray||["#FF7400"];var B=new Array(k.length);for(D=0;D<k.length;D++){B[D]=""}var u=h.labelArray||B;var b=h.radius||4;var G={};if(typeof h.highlightOnSector=="undefined"){h.highlightOnSector=false}G.name=h.name;G.id=h.id;G.strokeWidth=h.strokeWidth||1;G.strokeColor=h.strokeColor||"none";G.straightFirst=false;G.straightLast=false;G.fillColor=h.fillColor||"#FFFF88";G.fillOpacity=h.fillOpacity||0.6;G.highlightFillColor=h.highlightFillColor||"#FF7400";G.highlightStrokeColor=h.highlightStrokeColor||"#FFFFFF";G.gradient=h.gradient||"none";var z=h.center||[0,0];var C=z[0];var a=z[1];var F=e.createElement("point",[C,a],{name:"",fixed:true,visible:false});A[0]=e.createElement("point",[b+C,0+a],{name:"",fixed:true,visible:false});var I=0;for(D=0;D<k.length;D++){I+=(q!=0)?(2*Math.PI*k[D]/q):0;var l=b*Math.cos(I)+C;var w=b*Math.sin(I)+a;A[D+1]=e.createElement("point",[l,w],{name:"",fixed:true,visible:false,withLabel:false});m[D]=e.createElement("line",[F,A[D]],{strokeColor:G.strokeColor,straightFirst:false,straightLast:false,strokeWidth:G.strokeWidth,strokeOpacity:1,withLabel:false,highlightStrokeColor:G.highlightStrokeColor});G.fillColor=d[D%d.length];G.name=u[D];if(G.name!=""){G.withLabel=true}else{G.withLabel=false}G.labelColor=d[D%d.length];G.highlightfillColor=H[D%H.length];g[D]=e.createElement("arc",[F,A[D],A[D+1]],G);if(h.highlightOnSector){g[D].hasPoint=g[D].hasPointSector}}for(D=0;D<k.length;D++){g[D].additionalLines=[m[D],m[(D+1)%k.length]]}this.rendNode=g[0].rendNode;return{arcs:g,lines:m,points:A,midpoint:F}};JXG.Chart.prototype.updateRenderer=function(){};JXG.Chart.prototype.update=function(){if(this.needsUpdate){this.updateDataArray()}};JXG.Chart.prototype.updateDataArray=function(){};JXG.createChart=function(g,C,h){if((C.length==1)&&(typeof C[0]=="string")){var B=document.getElementById(C[0]),G,e,u,s,d,a,A=[],l,k,F,E,H,m,b,q,D,z;if(typeof B!="undefined"){if(h.withHeader){}else{h.withHeader=true}B=(new JXG.DataSource()).loadFromTable(C[0],h.withHeader,h.withHeader);G=B.data;d=B.columnHeader;e=B.rowHeader;E=h.width;H=h.name;m=h.strokeColor;b=h.fillColor;q=h.highlightStrokeColor;D=h.highlightFillColor;g.suspendUpdate();z=G.length;F=[];if(h.rows&&JXG.isArray(h.rows)){for(u=0;u<z;u++){for(s=0;s<h.rows.length;s++){if((h.rows[s]==u)||(h.withHeaders&&h.rows[s]==e[u])){F.push(G[u]);break}}}}else{F=G}z=F.length;for(u=0;u<z;u++){k=[];if(h.chartStyle&&h.chartStyle.indexOf("bar")!=-1){if(E){l=E}else{l=0.8}k.push(1-l/2+(u+0.5)*l/(1*z));for(s=1;s<F[u].length;s++){k.push(k[s-1]+1)}h.width=l/(1*z)}if(H&&H.length==z){h.name=H[u]}else{if(h.withHeaders){h.name=d[u]}}if(m&&m.length==z){h.strokeColor=m[u]}else{h.strokeColor=JXG.hsv2rgb(((u+1)/(1*z))*360,0.9,0.6)}if(b&&b.length==z){h.fillColor=b[u]}else{h.fillColor=JXG.hsv2rgb(((u+1)/(1*z))*360,0.9,1)}if(q&&q.length==z){h.highlightStrokeColor=q[u]}else{h.highlightStrokeColor=JXG.hsv2rgb(((u+1)/(1*z))*360,0.9,1)}if(D&&D.length==z){h.highlightFillColor=D[u]}else{h.highlightFillColor=JXG.hsv2rgb(((u+1)/(1*z))*360,0.9,0.6)}if(h.chartStyle&&h.chartStyle.indexOf("bar")!=-1){A.push(new JXG.Chart(g,[k,F[u]],h))}else{A.push(new JXG.Chart(g,[F[u]],h))}}g.unsuspendUpdate()}return A}else{return new JXG.Chart(g,C,h)}};JXG.JSXGraph.registerElement("chart",JXG.createChart);JXG.Transformation=function(b,a,d){this.elementClass=JXG.OBJECT_CLASS_OTHER;this.matrix=[[1,0,0],[0,1,0],[0,0,1]];this.board=b;this.isNumericMatrix=false;this.setMatrix(b,a,d)};JXG.Transformation.prototype={};JXG.Transformation.prototype.update=function(){};JXG.Transformation.prototype.setMatrix=function(d,b,e){var a;this.isNumericMatrix=true;for(a=0;a<e.length;a++){if(typeof e[a]!="number"){this.isNumericMatrix=false;break}}if(b=="translate"){this.evalParam=JXG.createEvalFunction(d,e,2);this.update=function(){this.matrix[1][0]=this.evalParam(0);this.matrix[2][0]=this.evalParam(1)}}else{if(b=="scale"){this.evalParam=JXG.createEvalFunction(d,e,2);this.update=function(){this.matrix[1][1]=this.evalParam(0);this.matrix[2][2]=this.evalParam(1)}}else{if(b=="reflect"){if(e.length<4){e[0]=JXG.getReference(d,e[0])}if(e.length==2){e[1]=JXG.getReference(d,e[1])}if(e.length==4){this.evalParam=JXG.createEvalFunction(d,e,4)}this.update=function(){var g,m,h,l,k;if(e.length==1){g=e[0].point2.X()-e[0].point1.X();m=e[0].point2.Y()-e[0].point1.Y();h=e[0].point1.X();l=e[0].point1.Y()}else{if(e.length==2){g=e[1].X()-e[0].X();m=e[1].Y()-e[0].Y();h=e[0].X();l=e[0].Y()}else{if(e.length==4){g=this.evalParam(2)-this.evalParam(0);m=this.evalParam(3)-this.evalParam(1);h=this.evalParam(0);l=this.evalParam(1)}}}k=g*g+m*m;this.matrix[1][1]=(g*g-m*m)/k;this.matrix[1][2]=2*g*m/k;this.matrix[2][1]=2*g*m/k;this.matrix[2][2]=(-g*g+m*m)/k;this.matrix[1][0]=h*(1-this.matrix[1][1])-l*this.matrix[1][2];this.matrix[2][0]=l*(1-this.matrix[2][2])-h*this.matrix[2][1]}}else{if(b=="rotate"){if(e.length==3){this.evalParam=JXG.createEvalFunction(d,e,3)}else{if(e.length<=2){this.evalParam=JXG.createEvalFunction(d,e,1);if(e.length==2){e[1]=JXG.getReference(d,e[1])}}}this.update=function(){var h=this.evalParam(0),g,k;this.matrix[1][1]=Math.cos(h);this.matrix[1][2]=-Math.sin(h);this.matrix[2][1]=Math.sin(h);this.matrix[2][2]=Math.cos(h);if(e.length>1){if(e.length==3){g=this.evalParam(1);k=this.evalParam(2)}else{g=e[1].X();k=e[1].Y()}this.matrix[1][0]=g*(1-Math.cos(h))+k*Math.sin(h);this.matrix[2][0]=k*(1-Math.cos(h))-g*Math.sin(h)}}}else{if(b=="shear"){this.evalParam=JXG.createEvalFunction(d,e,1);this.update=function(){var g=this.evalParam(0);this.matrix[1][1]=Math.tan(g)}}else{if(b=="generic"){this.evalParam=JXG.createEvalFunction(d,e,9);this.update=function(){this.matrix[0][0]=this.evalParam(0);this.matrix[0][1]=this.evalParam(1);this.matrix[0][2]=this.evalParam(2);this.matrix[1][0]=this.evalParam(3);this.matrix[1][1]=this.evalParam(4);this.matrix[1][2]=this.evalParam(5);this.matrix[2][0]=this.evalParam(6);this.matrix[2][1]=this.evalParam(7);this.matrix[2][2]=this.evalParam(8)}}}}}}}};JXG.Transformation.prototype.apply=function(a){this.update();if(arguments[1]!=null){return JXG.Math.matVecMult(this.matrix,a.initialCoords.usrCoords)}else{return JXG.Math.matVecMult(this.matrix,a.coords.usrCoords)}};JXG.Transformation.prototype.applyOnce=function(d){var e,a,b;if(!JXG.isArray(d)){this.update();e=JXG.Math.matVecMult(this.matrix,d.coords.usrCoords);d.coords.setCoordinates(JXG.COORDS_BY_USER,[e[1],e[2]])}else{a=d.length;for(b=0;b<a;b++){this.update();e=JXG.Math.matVecMult(this.matrix,d[b].coords.usrCoords);d[b].coords.setCoordinates(JXG.COORDS_BY_USER,[e[1],e[2]])}}};JXG.Transformation.prototype.bindTo=function(d){var b,a;if(JXG.isArray(d)){a=d.length;for(b=0;b<a;b++){d[b].transformations.push(this)}}else{d.transformations.push(this)}};JXG.Transformation.prototype.setProperty=function(a){};JXG.Transformation.prototype.melt=function(l){var h=[],g,a,e,b,m,d;a=l.matrix.length;e=this.matrix[0].length;for(g=0;g<a;g++){h[g]=[]}this.update();l.update();for(g=0;g<a;g++){for(d=0;d<e;d++){m=0;for(b=0;b<a;b++){m+=l.matrix[g][b]*this.matrix[b][d]}h[g][d]=m}}this.update=function(){var k=this.matrix.length,q=this.matrix[0].length;for(g=0;g<k;g++){for(d=0;d<q;d++){this.matrix[g][d]=h[g][d]}}};return true};JXG.createTransform=function(a,d,b){return new JXG.Transformation(a,b.type,d)};JXG.JSXGraph.registerElement("transform",JXG.createTransform);JXG.Turtle=function(g,e,b){var a,h,d;this.type=JXG.OBJECT_TYPE_TURTLE;this.turtleIsHidden=false;this.board=g;if(b==null){this.attributes={}}else{this.attributes=b}this.attributes.straightFirst=false;this.attributes.straightLast=false;this.attributes.withLabel=false;a=0;h=0;d=90;if(e.length!=0){if(e.length==3){a=e[0];h=e[1];d=e[2]}else{if(e.length==2){if(JXG.isArray(e[0])){a=e[0][0];h=e[0][1];d=e[1]}else{a=e[0];h=e[1]}}else{a=e[0][0];h=e[0][1]}}}this.init(a,h,d);return this};JXG.Turtle.prototype=new JXG.GeometryElement;JXG.Turtle.prototype.init=function(a,e,d){this.arrowLen=20/Math.sqrt(this.board.unitX*this.board.unitX+this.board.unitY*this.board.unitY);this.pos=[a,e];this.isPenDown=true;this.dir=90;this.stack=[];this.objects=[];this.attributes.curveType="plot";this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);this.turtle=this.board.createElement("point",this.pos,{fixed:true,name:" ",visible:false,withLabel:false});this.objects.push(this.turtle);this.turtle2=this.board.createElement("point",[this.pos[0],this.pos[1]+this.arrowLen],{fixed:true,name:" ",visible:false,withLabel:false});this.objects.push(this.turtle2);var b=this.attributes.strokeWidth||this.attributes.strokewidth||2;this.arrow=this.board.createElement("line",[this.turtle,this.turtle2],{lastArrow:true,strokeColor:"#ff0000",straightFirst:false,straightLast:false,strokeWidth:b,withLabel:false});this.objects.push(this.arrow);this.right(90-d);this.board.update()};JXG.Turtle.prototype.forward=function(a){if(a==0){return}var d=a*Math.cos(this.dir*Math.PI/180);var b=a*Math.sin(this.dir*Math.PI/180);if(!this.turtleIsHidden){var e=this.board.createElement("transform",[d,b],{type:"translate"});e.applyOnce(this.turtle);e.applyOnce(this.turtle2)}if(this.isPenDown){if(this.curve.dataX.length>=8192){this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve)}}this.pos[0]+=d;this.pos[1]+=b;if(this.isPenDown){this.curve.dataX.push(this.pos[0]);this.curve.dataY.push(this.pos[1])}this.board.update();return this};JXG.Turtle.prototype.back=function(a){return this.forward(-a)};JXG.Turtle.prototype.right=function(b){this.dir-=b;this.dir%=360;if(!this.turtleIsHidden){var a=this.board.createElement("transform",[-b*Math.PI/180,this.turtle],{type:"rotate"});a.applyOnce(this.turtle2)}this.board.update();return this};JXG.Turtle.prototype.left=function(a){return this.right(-a)};JXG.Turtle.prototype.penUp=function(){this.isPenDown=false;return this};JXG.Turtle.prototype.penDown=function(){this.isPenDown=true;this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);return this};JXG.Turtle.prototype.clean=function(){for(var a=0;a<this.objects.length;a++){var b=this.objects[a];if(b.type==JXG.OBJECT_TYPE_CURVE){this.board.removeObject(b.id);this.objects.splice(a,1)}}this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);this.board.update();return this};JXG.Turtle.prototype.clearScreen=function(){for(var a=0;a<this.objects.length;a++){var b=this.objects[a];this.board.removeObject(b.id)}this.init(0,0,90);return this};JXG.Turtle.prototype.setPos=function(a,d){if(JXG.isArray(a)){this.pos=a}else{this.pos=[a,d]}if(!this.turtleIsHidden){this.turtle.setPositionDirectly(JXG.COORDS_BY_USER,a,d);this.turtle2.setPositionDirectly(JXG.COORDS_BY_USER,a,d+this.arrowLen);var b=this.board.createElement("transform",[-(this.dir-90)*Math.PI/180,this.turtle],{type:"rotate"});b.applyOnce(this.turtle2)}this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);this.board.update();return this};JXG.Turtle.prototype.setPenSize=function(a){this.attributes.strokeWidth=a;this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);return this};JXG.Turtle.prototype.setPenColor=function(a){this.attributes.strokeColor=a;this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);return this};JXG.Turtle.prototype.setHighlightPenColor=function(a){this.attributes.highlightStrokeColor=a;this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve);return this};JXG.Turtle.prototype.setProperty=function(){var g;var a;var d,e;var b;for(d=0;d<arguments.length;d++){a=arguments[d];if(typeof a=="string"){g=a.split(":")}else{if(!JXG.isArray(a)){for(var b in a){this.setProperty([b,a[b]])}return this}else{g=a}}this.attributes[g[0]]=g[1]}for(d=0;d<this.objects.length;d++){e=this.objects[d];if(e.type==JXG.OBJECT_TYPE_CURVE){e.setProperty(this.attributes)}}return this};JXG.Turtle.prototype.showTurtle=function(){this.turtleIsHidden=false;this.arrow.setProperty("visible:true");this.setPos(this.pos[0],this.pos[1]);this.board.update();return this};JXG.Turtle.prototype.hideTurtle=function(){this.turtleIsHidden=true;this.arrow.setProperty("visible:false");this.setPos(this.pos[0],this.pos[1]);this.board.update();return this};JXG.Turtle.prototype.home=function(){this.pos=[0,0];this.setPos(this.pos[0],this.pos[1]);return this};JXG.Turtle.prototype.pushTurtle=function(){this.stack.push([this.pos[0],this.pos[1],this.dir]);return this};JXG.Turtle.prototype.popTurtle=function(){var a=this.stack.pop();this.pos[0]=a[0];this.pos[1]=a[1];this.dir=a[2];this.setPos(this.pos[0],this.pos[1]);return this};JXG.Turtle.prototype.lookTo=function(g){if(JXG.isArray(g)){var b=this.pos[0];var a=this.pos[1];var k=g[0];var e=g[1];var d;var h=(k-b>0)?1:-1;if(Math.abs(k-b)>1e-7){d=Math.atan((e-a)/(k-b))+((h<0)?Math.PI:0)}else{d=((e-a>0)?0.5:-0.5)*Math.PI}this.right(this.dir-(d*180/Math.PI))}else{if(JXG.isNumber(g)){this.right(this.dir-(g))}}return this};JXG.Turtle.prototype.moveTo=function(e){if(JXG.isArray(e)){var b=e[0]-this.pos[0];var a=e[1]-this.pos[1];if(!this.turtleIsHidden){var d=this.board.createElement("transform",[b,a],{type:"translate"});d.applyOnce(this.turtle);d.applyOnce(this.turtle2)}if(this.isPenDown){if(this.curve.dataX.length>=8192){this.curve=this.board.createElement("curve",[[this.pos[0]],[this.pos[1]]],this.attributes);this.objects.push(this.curve)}}this.pos[0]=e[0];this.pos[1]=e[1];if(this.isPenDown){this.curve.dataX.push(this.pos[0]);this.curve.dataY.push(this.pos[1])}this.board.update()}return this};JXG.Turtle.prototype.fd=function(a){return this.forward(a)};JXG.Turtle.prototype.bk=function(a){return this.back(a)};JXG.Turtle.prototype.lt=function(a){return this.left(a)};JXG.Turtle.prototype.rt=function(a){return this.right(a)};JXG.Turtle.prototype.pu=function(){return this.penUp()};JXG.Turtle.prototype.pd=function(){return this.penDown()};JXG.Turtle.prototype.ht=function(){return this.hideTurtle()};JXG.Turtle.prototype.st=function(){return this.showTurtle()};JXG.Turtle.prototype.cs=function(){return this.clearScreen()};JXG.Turtle.prototype.push=function(){return this.pushTurtle()};JXG.Turtle.prototype.pop=function(){return this.popTurtle()};JXG.Turtle.prototype.X=function(a){return this.pos[0]};JXG.Turtle.prototype.Y=function(a){return this.pos[1]};JXG.Turtle.prototype.hasPoint=function(a,e){var b,d;for(b=0;b<this.objects.length;b++){d=this.objects[b];if(d.type==JXG.OBJECT_TYPE_CURVE){if(d.hasPoint(a,e)){return true}}}return false};JXG.createTurtle=function(d,b,a){if(b==null){var b=[]}return new JXG.Turtle(d,b,a)};JXG.JSXGraph.registerElement("turtle",JXG.createTurtle);JXG.rgbParser=function(){if(arguments.length==0){return}if(arguments.length>=3){arguments[0]=[arguments[0],arguments[1],arguments[2]];arguments.length=1}var q=arguments[0];if(JXG.isArray(q)){var d=false,k;for(k=0;k<3;k++){d|=/\./.test(arguments[0][k].toString())}for(k=0;k<3;k++){d&=(arguments[0][k]>=0)&(arguments[0][k]<=1)}if(d){return[Math.ceil(arguments[0][0]*255),Math.ceil(arguments[0][1]*255),Math.ceil(arguments[0][2]*255)]}else{arguments[0].length=3;return arguments[0]}}else{if(typeof arguments[0]=="string"){q=arguments[0]}}var a,l,s;if(q.charAt(0)=="#"){q=q.substr(1,6)}q=q.replace(/ /g,"");q=q.toLowerCase();var h={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};for(var u in h){if(q==u){q=h[u]}}var m=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(b){return[parseInt(b[1]),parseInt(b[2]),parseInt(b[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(b){return[parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(b){return[parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16)]}}];for(var k=0;k<m.length;k++){var z=m[k].re;var e=m[k].process;var w=z.exec(q);if(w){channels=e(w);a=channels[0];l=channels[1];s=channels[2]}}a=(a<0||isNaN(a))?0:((a>255)?255:a);l=(l<0||isNaN(l))?0:((l>255)?255:l);s=(s<0||isNaN(s))?0:((s>255)?255:s);return[a,l,s]};JXG.rgb2css=function(){var e,d,a;e=JXG.rgbParser.apply(JXG.rgbParser,arguments);d=e[1];a=e[2];e=e[0];return"rgb("+e+", "+d+", "+a+")"};JXG.rgb2hex=function(){var e,d,a;e=JXG.rgbParser.apply(JXG.rgbParser,arguments);d=e[1];a=e[2];e=e[0];e=e.toString(16);d=d.toString(16);a=a.toString(16);if(e.length==1){e="0"+e}if(d.length==1){d="0"+d}if(a.length==1){a="0"+a}return"#"+e+d+a};JXG.hsv2rgb=function(s,h,g){var k,u,d,m,l,e,b,a,w;s=((s%360)+360)%360;if(h==0){if(isNaN(s)||s<JXG.Math.eps){k=g;u=g;d=g}else{return"#ffffff"}}else{if(s>=360){e=0}else{e=s}e=e/60;l=Math.floor(e);m=e-l;b=g*(1-h);a=g*(1-(h*m));w=g*(1-(h*(1-m)));switch(l){case 0:k=g;u=w;d=b;break;case 1:k=a;u=g;d=b;break;case 2:k=b;u=g;d=w;break;case 3:k=b;u=a;d=g;break;case 4:k=w;u=b;d=g;break;case 5:k=g;u=b;d=a;break}}k=Math.round(k*255).toString(16);k=(k.length==2)?k:((k.length==1)?"0"+k:"00");u=Math.round(u*255).toString(16);u=(u.length==2)?u:((u.length==1)?"0"+u:"00");d=Math.round(d*255).toString(16);d=(d.length==2)?d:((d.length==1)?"0"+d:"00");return["#",k,u,d].join("")};JXG.rgb2hsv=function(){var a,l,m;a=JXG.rgbParser.apply(JXG.rgbParser,arguments);l=a[1];m=a[2];a=a[0];var k,w,u,q,d,e=new JXG.MathStatistics();fr=a/255;fg=l/255;fb=m/255;q=e.max([a,l,m]);d=e.min([a,l,m]);fmax=q/255;fmin=d/255;u=fmax;w=0;if(u>0){w=(u-fmin)/(u*1)}k=1/(fmax-fmin);if(w>0){if(q==a){k=(fg-fb)*k}else{if(q==l){k=2+(fb-fr)*k}else{k=4+(fr-fg)*k}}}k*=60;if(k<0){k+=360}if(q==d){k=0}return[k,w,u]};JXG.Board.prototype.angle=function(a,d,b){return this.algebra.angle(a,d,b)};JXG.Board.prototype.rad=function(a,d,b){return this.algebra.rad(a,d,b)};JXG.Board.prototype.distance=function(b,a){return this.algebra.distance(b,a)};JXG.Board.prototype.pow=function(e,d){return this.algebra.pow(e,d)};JXG.Board.prototype.round=function(a,b){return(a).toFixed(b)};JXG.Board.prototype.cosh=function(a){return JXG.Math.Numerics.cosh(a)};JXG.Board.prototype.sinh=function(a){return JXG.Math.Numerics.sinh(a)};JXG.Board.prototype.sgn=function(a){return(a==0?0:a/(Math.abs(a)))};JXG.Board.prototype.D=function(a,b){return JXG.Math.Numerics.D(a,b)};JXG.Board.prototype.I=function(a,b){return JXG.Math.Numerics.I(a,b)};JXG.Board.prototype.root=function(b,a,d){return JXG.Math.Numerics.root(b,a,d)};JXG.Board.prototype.lagrangePolynomial=function(a){return JXG.Math.Numerics.lagrangePolynomial(a)};JXG.Board.prototype.neville=function(a){return JXG.Math.Numerics.neville(a)};JXG.Board.prototype.riemannsum=function(d,g,b,e,a){return JXG.Math.Numerics.riemannsum(d,g,b,e,a)};JXG.Board.prototype.abs=Math.abs;JXG.Board.prototype.acos=Math.acos;JXG.Board.prototype.asin=Math.asin;JXG.Board.prototype.atan=Math.atan;JXG.Board.prototype.ceil=Math.ceil;JXG.Board.prototype.cos=Math.cos;JXG.Board.prototype.exp=Math.exp;JXG.Board.prototype.floor=Math.floor;JXG.Board.prototype.log=Math.log;JXG.Board.prototype.max=Math.max;JXG.Board.prototype.min=Math.min;JXG.Board.prototype.random=Math.random;JXG.Board.prototype.sin=Math.sin;JXG.Board.prototype.sqrt=Math.sqrt;JXG.Board.prototype.tan=Math.tan;JXG.Board.prototype.trunc=Math.ceil;JXG.Board.prototype.factorial=function(a){return JXG.Math.factorial(a)};JXG.Board.prototype.binomial=function(b,a){return JXG.Math.binomial(b,a)};JXG.Point.prototype.setPositionX=function(d,a){var b=(d==JXG.COORDS_BY_USER)?this.coords.usrCoords[2]:this.coords.scrCoords[2];this.setPosition(d,a,b)};JXG.Point.prototype.setPositionY=function(d,b){var a=(d==JXG.COORDS_BY_USER)?this.coords.usrCoords[1]:this.coords.scrCoords[1];this.setPosition(d,a,b)};JXG.Board.prototype.getElement=function(a){return JXG.getReference(this,a)};JXG.Board.prototype.intersectionOptions=["point",[[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_LINE,JXG.OBJECT_CLASS_CIRCLE],[JXG.OBJECT_CLASS_CIRCLE,JXG.OBJECT_CLASS_CIRCLE]]];JXG.Board.prototype.intersection=function(e,b,d,a){e=JXG.getReference(this,e);b=JXG.getReference(this,b);if(e.elementClass==JXG.OBJECT_CLASS_CURVE||b.elementClass==JXG.OBJECT_CLASS_CURVE){return function(){return e.board.algebra.meetCurveCurve(e,b,d,a)}}else{return function(){return e.board.algebra.meet(e.stdform,b.stdform,d)}}};JXG.Board.prototype.intersectionFunc=function(e,b,d,a){return this.intersection(e,b,d,a)};JXG.Board.prototype.otherIntersection=function(b,a,d){b=JXG.getReference(this,b);a=JXG.getReference(this,a);return function(){var e=b.board.algebra.meet(b.stdform,a.stdform,0);if(Math.abs(d.X()-e.usrCoords[1])>JXG.Math.eps||Math.abs(d.Y()-e.usrCoords[2])>JXG.Math.eps||Math.abs(d.Z()-e.usrCoords[0])>JXG.Math.eps){return e}else{return b.board.algebra.meet(b.stdform,a.stdform,1)}}};JXG.Board.prototype.pointFunc=function(){return[null]};JXG.Board.prototype.pointOptions=["point",[[JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.lineFunc=function(){return arguments};JXG.Board.prototype.lineOptions=["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.linesegmentFunc=function(){return arguments};JXG.Board.prototype.linesegmentOptions=["line",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.linesegmentAtts={straightFirst:false,straightLast:false};JXG.Board.prototype.arrowFunc=function(){return arguments};JXG.Board.prototype.arrowOptions=["arrow",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circleFunc=function(){return arguments};JXG.Board.prototype.circleOptions=["circle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE],[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_CIRCLE]]];JXG.Board.prototype.arrowparallelOptions=["arrowparallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.arrowparallelFunc=function(){return arguments};JXG.Board.prototype.bisectorOptions=["bisector",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.bisectorFunc=function(){return arguments};JXG.Board.prototype.circumcircleOptions=["circumcircle",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circumcircleFunc=function(){return arguments};JXG.Board.prototype.circumcirclemidpointOptions=["circumcirclemidpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.circumcirclemidpointFunc=function(){return arguments};JXG.Board.prototype.integralOptions=["integral",[[]]];JXG.Board.prototype.integralFunc=function(){return arguments};JXG.Board.prototype.midpointOptions=["midpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT],[JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.midpointFunc=function(){return arguments};JXG.Board.prototype.mirrorpointOptions=["mirrorpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.mirrorpointFunc=function(){return arguments};JXG.Board.prototype.normalOptions=["normal",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.normalFunc=function(){return arguments};JXG.Board.prototype.parallelOptions=["parallel",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.parallelFunc=function(){return arguments};JXG.Board.prototype.parallelpointOptions=["parallelpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_POINT]]];JXG.Board.prototype.parallelpointFunc=function(){return arguments};JXG.Board.prototype.perpendicularOptions=["perpendicular",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.perpendicularFunc=function(){return arguments};JXG.Board.prototype.perpendicularpointOptions=["perpendicularpoint",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.perpendicularpointFunc=function(){return arguments};JXG.Board.prototype.reflectionOptions=["reflection",[[JXG.OBJECT_CLASS_POINT,JXG.OBJECT_CLASS_LINE]]];JXG.Board.prototype.reflectionFunc=function(){return arguments};JXG.Board.prototype.pstricks={};JXG.Board.prototype.pstricks.givePsTricksToDiv=function(a,b){JXG.PsTricks.givePsTricksToDiv(a,b)};JXG.Ticks=function(a,g,e,h,b,k,d){this.constructor();this.type=JXG.OBJECT_TYPE_TICKS;this.elementClass=JXG.OBJECT_CLASS_OTHER;this.line=a;this.board=this.line.board;this.ticksFunction=null;this.fixedTicks=null;this.equidistant=false;if(JXG.isFunction(g)){this.ticksFunction=g}else{if(JXG.isArray(g)){this.fixedTicks=g}else{if(Math.abs(g)<JXG.Math.eps){g=this.board.options.line.ticks.defaultDistance}this.ticksFunction=function(l){return g};this.equidistant=true}}this.minorTicks=((e==null)||(e==0)?this.board.options.line.ticks.minorTicks:e);if(this.minorTicks<0){this.minorTicks=-this.minorTicks}this.majorHeight=((h==null)||(h==0)?this.board.options.line.ticks.majorHeight:h);if(this.majorHeight<0){this.majorHeight=-this.majorHeight}this.minorHeight=((b==null)||(b==0)?this.board.options.line.ticks.minorHeight:b);if(this.minorHeight<0){this.minorHeight=-this.minorHeight}this.minTicksDistance=this.board.options.line.ticks.minTicksDistance;this.maxTicksDistance=this.board.options.line.ticks.maxTicksDistance;this.insertTicks=this.board.options.line.ticks.insertTicks;this.drawZero=this.board.options.line.ticks.drawZero;this.drawLabels=this.board.options.line.ticks.drawLabels;this.init(this.board,k,d);this.visProp.visible=true;this.visProp.fillColor=this.line.visProp.fillColor;this.visProp.highlightFillColor=this.line.visProp.highlightFillColor;this.visProp.strokeColor=this.line.visProp.strokeColor;this.visProp.highlightStrokeColor=this.line.visProp.highlightStrokeColor;this.visProp.strokeWidth=this.line.visProp.strokeWidth;this.id=this.line.addTicks(this)};JXG.Ticks.prototype=new JXG.GeometryElement;JXG.Ticks.prototype.hasPoint=function(a,b){return false};JXG.Ticks.prototype.makeTicks=function(h,d,O,K){var F=h.usrCoords[1]-d.usrCoords[1];var D=h.usrCoords[2]-d.usrCoords[2];var N=0;var k=Math.sqrt(F*F+D*D);if(k<=JXG.Math.eps){return}var C=h.usrCoords[1];var B=h.usrCoords[2];var L=O/Math.abs(O);N=Math.abs(this.ticksFunction(L));var Q=(N*F)/(k);var P=(N*D)/(k);var I=0;if(this.equidistant){var b=Q;var G=P;var a=N;var E=new JXG.Coords(JXG.COORDS_BY_USER,[0,0],this.board);var J=new JXG.Coords(JXG.COORDS_BY_USER,[Q,P],this.board);I=(J.scrCoords[1]-E.scrCoords[1])*(J.scrCoords[1]-E.scrCoords[1])+(J.scrCoords[2]-E.scrCoords[2])*(J.scrCoords[2]-E.scrCoords[2]);N=Math.pow(10,Math.floor(Math.log(N)/Math.LN10));Q=(N*F)/(k);P=(N*D)/(k);while(I>8*this.minTicksDistance*this.minTicksDistance){N/=10;Q=(N*F)/(k);P=(N*D)/(k);J=new JXG.Coords(JXG.COORDS_BY_USER,[Q,P],this.board);I=(J.scrCoords[1]-E.scrCoords[1])*(J.scrCoords[1]-E.scrCoords[1])+(J.scrCoords[2]-E.scrCoords[2])*(J.scrCoords[2]-E.scrCoords[2])}var H=5;while(I<this.minTicksDistance*this.minTicksDistance){N*=H;if(H==5){H=2}else{H=5}Q=(N*F)/(k);P=(N*D)/(k);J=new JXG.Coords(JXG.COORDS_BY_USER,[Q,P],this.board);I=(J.scrCoords[1]-E.scrCoords[1])*(J.scrCoords[1]-E.scrCoords[1])+(J.scrCoords[2]-E.scrCoords[2])*(J.scrCoords[2]-E.scrCoords[2])}}var R=O*N;var w=new JXG.Coords(JXG.COORDS_BY_USER,[C,B],this.board);var g=null;var e=null;var s="";var u=null;var q=true;var m=C;var l=B;while(q||(this.board.sgn(Q)*(C-K*Q)>=this.board.sgn(Q)*d.usrCoords[1]&&this.board.sgn(P)*(B-K*P)>=this.board.sgn(P)*d.usrCoords[2])){q=false;C=C-Q;B=B-P;g=new JXG.Coords(JXG.COORDS_BY_USER,[C,B],this.board);if(!this.equidistant){I=(w.scrCoords[1]-g.scrCoords[1])*(w.scrCoords[1]-g.scrCoords[1])+(w.scrCoords[2]-g.scrCoords[2])*(w.scrCoords[2]-g.scrCoords[2])}if(this.insertTicks&&this.equidistant&&(I>this.maxTicksDistance*this.maxTicksDistance)){while(I>this.maxTicksDistance*this.maxTicksDistance){Q*=0.5;P*=0.5;N*=0.5;C+=Q;B+=P;R=R-O*N;g=new JXG.Coords(JXG.COORDS_BY_USER,[C,B],this.board);I=(w.scrCoords[1]-g.scrCoords[1])*(w.scrCoords[1]-g.scrCoords[1])+(w.scrCoords[2]-g.scrCoords[2])*(w.scrCoords[2]-g.scrCoords[2])}}if(this.equidistant){for(var A=1;A<this.minorTicks+1;A++){e=new JXG.Coords(JXG.COORDS_BY_USER,[m-(Q*A)/(this.minorTicks+1),l-(P*A)/(this.minorTicks+1)],this.board);e.major=false;this.ticks.push(e);this.labels.push(null)}}if(this.equidistant||(I>this.minTicksDistance*this.minTicksDistance)){g.major=true;this.ticks.push(g);s=R.toString();if(s.length>5){s=R.toPrecision(3).toString()}u=new JXG.Text(this.board,s,null,[g.usrCoords[1],g.usrCoords[2]],this.id+L+"Label",null,null,true,this.board.options.text.defaultType);u.distanceX=0;u.distanceY=-10;u.setCoords(g.usrCoords[1]*1+u.distanceX/(this.board.stretchX),g.usrCoords[2]*1+u.distanceY/(this.board.stretchY));if(this.drawLabels){u.visProp.visible=true}else{u.visProp.visible=false}this.labels.push(u);m=C;l=B;w=g}L=L+O*1;if(!this.equidistant){N=Math.abs(this.ticksFunction(L))}R=R+O*N;if(!this.equidistant){Q=(N*F)/(k);P=(N*D)/(k)}}};JXG.Ticks.prototype.calculateTicksCoordinates=function(){var F=1;var z=2;var A=F+z;var G=new JXG.Coords(JXG.COORDS_BY_USER,[this.line.point1.coords.usrCoords[1],this.line.point1.coords.usrCoords[2]],this.board);var E=new JXG.Coords(JXG.COORDS_BY_USER,[this.line.point2.coords.usrCoords[1],this.line.point2.coords.usrCoords[2]],this.board);this.board.renderer.calcStraight(this.line,G,E);var b=this.line.point1.coords;if(this.board.renderer.isSameDirection(b,G,E)){if(this.board.renderer.isSameDirection(b,this.line.point2.coords,G)){A=z;if(b.distance(JXG.COORDS_BY_USER,G)>b.distance(JXG.COORDS_BY_USER,E)){E=G}}else{A=F;if(b.distance(JXG.COORDS_BY_USER,G)<b.distance(JXG.COORDS_BY_USER,E)){G=E}}}else{if(this.board.renderer.isSameDirection(b,this.line.point2.coords,G)){var h=G;G=E;E=h}}if(this.ticks!=null){for(var I=0;I<this.ticks.length;I++){if(this.labels[I]!=null){if(this.labels[I].visProp.visible){this.board.renderer.remove(this.labels[I].rendNode)}}}}this.ticks=new Array();this.labels=new Array();var q=null;var l="";var g=null;if(this.ticksFunction!=null){if(this.drawZero){g=new JXG.Coords(JXG.COORDS_BY_USER,[b.usrCoords[1],b.usrCoords[2]],this.board);this.ticks.push(g);q=new JXG.Text(this.board,"0",null,[b.usrCoords[1],b.usrCoords[2]],this.id+"0Label",null,null,true,this.board.options.text.defaultType);if(this.drawLabels){q.visProp.visible=true}else{q.visProp.visible=false}this.labels.push(q);this.ticks[0].major=true}if(F==(A&F)){if(this.line.visProp.straightFirst){this.makeTicks(b,G,-1,0)}}if(z==(A&z)){if(this.line.visProp.straightLast){this.makeTicks(b,E,+1,0)}else{this.makeTicks(b,this.line.point2.coords,+1,1)}}}else{if(!this.line.visProp.straightFirst){G=b}var s=b.usrCoords[1]-G.usrCoords[1];var m=b.usrCoords[2]-G.usrCoords[2];var O=Math.sqrt(s*s+m*m);if(!this.line.visProp.straightLast){E=this.line.point2.coords}var k=b.usrCoords[1]-E.usrCoords[1];var u=b.usrCoords[2]-E.usrCoords[2];var d=Math.sqrt(k*k+u*u);var L=0;var K=0;for(var J=0;J<this.fixedTicks.length;J++){if((-O<=this.fixedTicks[J])&&(this.fixedTicks[J]<=d)){if(this.fixedTicks[J]<0){L=Math.abs(s)*this.fixedTicks[J]/O;K=Math.abs(m)*this.fixedTicks[J]/O}else{L=Math.abs(k)*this.fixedTicks[J]/d;K=Math.abs(u)*this.fixedTicks[J]/d}g=new JXG.Coords(JXG.COORDS_BY_USER,[b.usrCoords[1]+L,b.usrCoords[2]+K],this.board);this.ticks.push(g);this.ticks[this.ticks.length-1].major=true;l=this.fixedTicks[J].toString();if(l.length>5){l=this.fixedTicks[J].toFixed(3).toString()}q=new JXG.Text(this.board,l,null,[b.usrCoords[1]+L,b.usrCoords[2]+K],this.id+J+"Label",null,null,true,this.board.options.text.defaultType);q.distanceX=0;q.distanceY=-10;q.setCoords(g.usrCoords[1]*1+q.distanceX/(this.board.stretchX),g.usrCoords[2]*1+q.distanceY/(this.board.stretchY));if(this.drawLabels){q.visProp.visible=true}else{q.visProp.visible=false}this.labels.push(q)}}}var C=JXG.Math.eps;var w=-this.line.getSlope();var B=this.majorHeight/2;var e=this.minorHeight/2;var N=0;var a=0;var D=0;var H=0;if(Math.abs(w)<C){N=0;a=B;D=0;H=e}else{if((Math.abs(w)>1/C)||(isNaN(w))){N=B;a=0;D=e;H=0}else{N=B/Math.sqrt(1/(w*w)+1);a=-N/w;D=e/Math.sqrt(1/(w*w)+1);H=-D/w}}this.board.renderer.updateTicks(this,N,a,D,H)};JXG.Ticks.prototype.updateRenderer=function(){if(this.needsUpdate){this.calculateTicksCoordinates();this.needsUpdate=false}};JXG.createTicks=function(e,b,a){var d;if((b[0].elementClass==JXG.OBJECT_CLASS_LINE)&&(JXG.isFunction(b[1])||JXG.isArray(b[1])||JXG.isNumber(b[1]))){d=new JXG.Ticks(b[0],b[1],a.minorTicks,a.majHeight,a.minHeight,a.id,a.name)}else{throw new Error("JSXGraph: Can't create Ticks with parent types '"+(typeof b[0])+"' and '"+(typeof b[1])+"' and '"+(typeof b[2])+"'.")}return d};JXG.JSXGraph.registerElement("ticks",JXG.createTicks);JXG.Util={};JXG.Util.Unzip=function(ad){var w=[],Q="",O=false,K,R=0,aa=[],C,l=new Array(32768),ai=0,V=false,af,S,ah=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255],al=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],ac=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99],W=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],J=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=ad,b=0,k=0,am=1,a=0,ak=256,h=[],q;function e(){var ao=G.length;a+=8;if(b<ao){if(O){document.write(b+": "+G[b]+"<br>")}return G[b++]}else{return -1}}function A(){am=1}function ag(){var ao;a++;ao=(am&1);am>>=1;if(am==0){am=e();ao=(am&1);am=(am>>1)|128}return ao}function ae(ao){var aq=0,ap=ao;while(ap--){aq=(aq<<1)|ag()}if(ao){aq=ah[aq]>>(8-ao)}return aq}function d(){ai=0}function H(ao){S++;l[ai++]=ao;w.push(String.fromCharCode(ao));if(ai==32768){ai=0}}function u(){this.b0=0;this.b1=0;this.jump=null;this.jumppos=-1}var g=288;var F=new Array(g);var Y=new Array(32);var T=0;var aj=null;var B=null;var X=new Array(64);var U=new Array(64);var I=0;var N=new Array(17);N[0]=0;var Z;var E;function m(){while(1){if(N[I]>=E){return -1}if(Z[N[I]]==I){return N[I]++}N[I]++}}function P(){var ap=aj[T];var ao;if(O){document.write("<br>len:"+I+" treepos:"+T)}if(I==17){return -1}T++;I++;ao=m();if(O){document.write("<br>IsPat "+ao)}if(ao>=0){ap.b0=ao;if(O){document.write("<br>b0 "+ap.b0)}}else{ap.b0=32768;if(O){document.write("<br>b0 "+ap.b0)}if(P()){return -1}}ao=m();if(ao>=0){ap.b1=ao;if(O){document.write("<br>b1 "+ap.b1)}ap.jump=null}else{ap.b1=32768;if(O){document.write("<br>b1 "+ap.b1)}ap.jump=aj[T];ap.jumppos=T;if(P()){return -1}}I--;return 0}function s(at,aq,au,ap){var ar;if(O){document.write("currentTree "+at+" numval "+aq+" lengths "+au+" show "+ap)}aj=at;T=0;Z=au;E=aq;for(ar=0;ar<17;ar++){N[ar]=0}I=0;if(P()){if(O){alert("invalid huffman tree\n")}return -1}if(O){document.write("<br>Tree: "+aj.length);for(var ao=0;ao<32;ao++){document.write("Places["+ao+"].b0="+aj[ao].b0+"<br>");document.write("Places["+ao+"].b1="+aj[ao].b1+"<br>")}}return 0}function L(ar){var ap,aq,au=0,at=ar[au],ao;while(1){ao=ag();if(O){document.write("b="+ao)}if(ao){if(!(at.b1&32768)){if(O){document.write("ret1")}return at.b1}at=at.jump;ap=ar.length;for(aq=0;aq<ap;aq++){if(ar[aq]===at){au=aq;break}}}else{if(!(at.b0&32768)){if(O){document.write("ret2")}return at.b0}au++;at=ar[au]}}if(O){document.write("ret3")}return -1}function an(){var at,aF,ap,aD,aE;do{at=ag();ap=ae(2);switch(ap){case 0:if(O){alert("Stored\n")}break;case 1:if(O){alert("Fixed Huffman codes\n")}break;case 2:if(O){alert("Dynamic Huffman codes\n")}break;case 3:if(O){alert("Reserved block type!!\n")}break;default:if(O){alert("Unexpected value %d!\n",ap)}break}if(ap==0){var aB,ao;A();aB=e();aB|=(e()<<8);ao=e();ao|=(e()<<8);if(((aB^~ao)&65535)){document.write("BlockLen checksum mismatch\n")}while(aB--){aF=e();H(aF)}}else{if(ap==1){var aC;while(1){aC=(ah[ae(7)]>>1);if(aC>23){aC=(aC<<1)|ag();if(aC>199){aC-=128;aC=(aC<<1)|ag()}else{aC-=48;if(aC>143){aC=aC+136}}}else{aC+=256}if(aC<256){H(aC)}else{if(aC==256){break}else{var aE,ay;aC-=256+1;aE=ae(ac[aC])+al[aC];aC=ah[ae(5)]>>3;if(J[aC]>8){ay=ae(8);ay|=(ae(J[aC]-8)<<8)}else{ay=ae(J[aC])}ay+=W[aC];for(aC=0;aC<aE;aC++){var aF=l[(ai-ay)&32767];H(aF)}}}}}else{if(ap==2){var aC,az,aq,aw,ax;var av=new Array(288+32);aq=257+ae(5);aw=1+ae(5);ax=4+ae(4);for(aC=0;aC<19;aC++){av[aC]=0}for(aC=0;aC<ax;aC++){av[z[aC]]=ae(3)}aE=Y.length;for(aD=0;aD<aE;aD++){Y[aD]=new u()}if(s(Y,19,av,0)){d();return 1}if(O){document.write("<br>distanceTree");for(var aG=0;aG<Y.length;aG++){document.write("<br>"+Y[aG].b0+" "+Y[aG].b1+" "+Y[aG].jump+" "+Y[aG].jumppos)}}az=aq+aw;aD=0;var ar=-1;if(O){document.write("<br>n="+az+" bits: "+a+"<br>")}while(aD<az){ar++;aC=L(Y);if(O){document.write("<br>"+ar+" i:"+aD+" decode: "+aC+"    bits "+a+"<br>")}if(aC<16){av[aD++]=aC}else{if(aC==16){var aA;aC=3+ae(2);if(aD+aC>az){d();return 1}aA=aD?av[aD-1]:0;while(aC--){av[aD++]=aA}}else{if(aC==17){aC=3+ae(3)}else{aC=11+ae(7)}if(aD+aC>az){d();return 1}while(aC--){av[aD++]=0}}}}aE=F.length;for(aD=0;aD<aE;aD++){F[aD]=new u()}if(s(F,aq,av,0)){d();return 1}aE=F.length;for(aD=0;aD<aE;aD++){Y[aD]=new u()}var au=new Array();for(aD=aq;aD<av.length;aD++){au[aD-aq]=av[aD]}if(s(Y,aw,au,0)){d();return 1}if(O){document.write("<br>literalTree")}while(1){aC=L(F);if(aC>=256){var aE,ay;aC-=256;if(aC==0){break}aC--;aE=ae(ac[aC])+al[aC];aC=L(Y);if(J[aC]>8){ay=ae(8);ay|=(ae(J[aC]-8)<<8)}else{ay=ae(J[aC])}ay+=W[aC];while(aE--){var aF=l[(ai-ay)&32767];H(aF)}}else{H(aC)}}}}}}while(!at);d();A();return 0}JXG.Util.Unzip.prototype.unzipFile=function(ao){var ap;this.unzip();for(ap=0;ap<aa.length;ap++){if(aa[ap][1]==ao){return aa[ap][0]}}};JXG.Util.Unzip.prototype.unzip=function(){if(O){alert(G)}D();return aa};function D(){if(O){alert("NEXTFILE")}w=[];var at=[];V=false;at[0]=e();at[1]=e();if(O){alert("type: "+at[0]+" "+at[1])}if(at[0]==parseInt("78",16)&&at[1]==parseInt("da",16)){if(O){alert("GEONExT-GZIP")}an();if(O){alert(w.join(""))}aa[R]=new Array(2);aa[R][0]=w.join("");aa[R][1]="geonext.gxt";R++}if(at[0]==parseInt("50",16)&&at[1]==parseInt("4b",16)){V=true;at[2]=e();at[3]=e();if(at[2]==parseInt("3",16)&&at[3]==parseInt("4",16)){at[0]=e();at[1]=e();if(O){alert("ZIP-Version: "+at[1]+" "+at[0]/10+"."+at[0]%10)}K=e();K|=(e()<<8);if(O){alert("gpflags: "+K)}var ao=e();ao|=(e()<<8);if(O){alert("method: "+ao)}e();e();e();e();var au=e();au|=(e()<<8);au|=(e()<<16);au|=(e()<<24);var ar=e();ar|=(e()<<8);ar|=(e()<<16);ar|=(e()<<24);var ax=e();ax|=(e()<<8);ax|=(e()<<16);ax|=(e()<<24);if(O){alert("local CRC: "+au+"\nlocal Size: "+ax+"\nlocal CompSize: "+ar)}var ap=e();ap|=(e()<<8);var aw=e();aw|=(e()<<8);if(O){alert("filelen "+ap)}aq=0;h=[];while(ap--){var av=e();if(av=="/"|av==":"){aq=0}else{if(aq<ak-1){h[aq++]=String.fromCharCode(av)}}}if(O){alert("nameBuf: "+h)}if(!q){q=h}var aq=0;while(aq<aw){av=e();aq++}af=4294967295;S=0;if(ax=0&&fileOut.charAt(q.length-1)=="/"){if(O){alert("skipdir")}}if(ao==8){an();if(O){alert(w.join(""))}aa[R]=new Array(2);aa[R][0]=w.join("");aa[R][1]=h.join("");R++}ab()}}}function ab(){var au,aq=[],ar,ap,at,ao,av;if((K&8)){aq[0]=e();aq[1]=e();aq[2]=e();aq[3]=e();if(aq[0]==parseInt("50",16)&&aq[1]==parseInt("4b",16)&&aq[2]==parseInt("07",16)&&aq[3]==parseInt("08",16)){au=e();au|=(e()<<8);au|=(e()<<16);au|=(e()<<24)}else{au=aq[0]|(aq[1]<<8)|(aq[2]<<16)|(aq[3]<<24)}ar=e();ar|=(e()<<8);ar|=(e()<<16);ar|=(e()<<24);ap=e();ap|=(e()<<8);ap|=(e()<<16);ap|=(e()<<24);if(O){alert("CRC:")}}if(V){D()}aq[0]=e();if(aq[0]!=8){if(O){alert("Unknown compression method!")}return 0}K=e();if(O){if((K&~(parseInt("1f",16)))){alert("Unknown flags set!")}}e();e();e();e();e();at=e();if((K&4)){aq[0]=e();aq[2]=e();I=aq[0]+256*aq[1];if(O){alert("Extra field size: "+I)}for(ao=0;ao<I;ao++){e()}}if((K&8)){ao=0;h=[];while(av=e()){if(av=="7"||av==":"){ao=0}if(ao<ak-1){h[ao++]=av}}if(O){alert("original file name: "+h)}}if((K&16)){while(av=e()){}}if((K&2)){e();e()}an();au=e();au|=(e()<<8);au|=(e()<<16);au|=(e()<<24);ap=e();ap|=(e()<<8);ap|=(e()<<16);ap|=(e()<<24);D()}};JXG.Util.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(d){var a=[],q,l,h,m,k,g,e,b=0;d=JXG.Util.Base64._utf8_encode(d);while(b<d.length){q=d.charCodeAt(b++);l=d.charCodeAt(b++);h=d.charCodeAt(b++);m=q>>2;k=((q&3)<<4)|(l>>4);g=((l&15)<<2)|(h>>6);e=h&63;if(isNaN(l)){g=e=64}else{if(isNaN(h)){e=64}}a.push([this._keyStr.charAt(m),this._keyStr.charAt(k),this._keyStr.charAt(g),this._keyStr.charAt(e)].join(""))}return a.join("")},decode:function(e,d){var a=[],s,m,k,q,l,h,g,b=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(b<e.length){q=this._keyStr.indexOf(e.charAt(b++));l=this._keyStr.indexOf(e.charAt(b++));h=this._keyStr.indexOf(e.charAt(b++));g=this._keyStr.indexOf(e.charAt(b++));s=(q<<2)|(l>>4);m=((l&15)<<4)|(h>>2);k=((h&3)<<6)|g;a.push(String.fromCharCode(s));if(h!=64){a.push(String.fromCharCode(m))}if(g!=64){a.push(String.fromCharCode(k))}}a=a.join("");if(d){a=JXG.Util.Base64._utf8_decode(a)}return a},_utf8_encode:function(b){b=b.replace(/\r\n/g,"\n");var a="";for(var e=0;e<b.length;e++){var d=b.charCodeAt(e);if(d<128){a+=String.fromCharCode(d)}else{if((d>127)&&(d<2048)){a+=String.fromCharCode((d>>6)|192);a+=String.fromCharCode((d&63)|128)}else{a+=String.fromCharCode((d>>12)|224);a+=String.fromCharCode(((d>>6)&63)|128);a+=String.fromCharCode((d&63)|128)}}}return a},_utf8_decode:function(a){var d=[],g=0,h=0,e=0,b=0;while(g<a.length){h=a.charCodeAt(g);if(h<128){d.push(String.fromCharCode(h));g++}else{if((h>191)&&(h<224)){e=a.charCodeAt(g+1);d.push(String.fromCharCode(((h&31)<<6)|(e&63)));g+=2}else{e=a.charCodeAt(g+1);b=a.charCodeAt(g+2);d.push(String.fromCharCode(((h&15)<<12)|((e&63)<<6)|(b&63)));g+=3}}}return d.join("")},_destrip:function(h,e){var b=[],g,d,a=[];if(e==null){e=76}h.replace(/ /g,"");g=h.length/e;for(d=0;d<g;d++){b[d]=h.substr(d*e,e)}if(g!=h.length/e){b[b.length]=h.substr(g*e,h.length-(g*e))}for(d=0;d<b.length;d++){a.push(b[d])}return a.join("\n")},decodeAsArray:function(b){var e=this.decode(b),a=[],d;for(d=0;d<e.length;d++){a[d]=e.charCodeAt(d)}return a},decodeGEONExT:function(a){return decodeAsArray(destrip(a),false)}};JXG.Util.asciiCharCodeAt=function(b,a){var d=b.charCodeAt(a);if(d>255){switch(d){case 8364:d=128;break;case 8218:d=130;break;case 402:d=131;break;case 8222:d=132;break;case 8230:d=133;break;case 8224:d=134;break;case 8225:d=135;break;case 710:d=136;break;case 8240:d=137;break;case 352:d=138;break;case 8249:d=139;break;case 338:d=140;break;case 381:d=142;break;case 8216:d=145;break;case 8217:d=146;break;case 8220:d=147;break;case 8221:d=148;break;case 8226:d=149;break;case 8211:d=150;break;case 8212:d=151;break;case 732:d=152;break;case 8482:d=153;break;case 353:d=154;break;case 8250:d=155;break;case 339:d=156;break;case 382:d=158;break;case 376:d=159;break;default:break}}return d};JXG.PsTricks=new function(){this.psTricksString=""};JXG.PsTricks.convertBoardToPsTricks=function(b){var e=new JXG.Coords(JXG.COORDS_BY_SCREEN,[b.canvasWidth,b.canvasHeight],b);var d=new JXG.Coords(JXG.COORDS_BY_SCREEN,[0,0],b);this.psTricksString="\\begin{pspicture*}("+d.usrCoords[1]+","+e.usrCoords[2]+")("+e.usrCoords[1]+","+d.usrCoords[2]+")\n";for(var a in b.objects){var g=b.objects[a];if(g.type==JXG.OBJECT_TYPE_ARC){if(g.visProp.visible){this.addSector(g)}}}for(var a in b.objects){var g=b.objects[a];if(g.type==JXG.OBJECT_TYPE_POLYGON){if(g.visProp.visible){this.addPolygon(g)}}}for(var a in b.objects){var g=b.objects[a];if(g.type==JXG.OBJECT_TYPE_ANGLE){if(g.visProp.visible){this.addAngle(g)}}}for(var a in b.objects){var g=b.objects[a];if(g.type==JXG.OBJECT_TYPE_CIRCLE){if(g.visProp.visible){this.addCircle(g)}}}for(var a in b.objects){var g=b.objects[a];if(g.type==JXG.OBJECT_TYPE_ARC){if(g.visProp.visible){this.addArc(g)}}}for(var a in b.objects){var g=b.objects[a];if(g.type==JXG.OBJECT_TYPE_LINE){if(g.visProp.visible){this.addLine(g)}}}for(var a in b.objects){var g=b.objects[a];if(g.type==JXG.OBJECT_TYPE_POINT){if(g.visProp.visible){this.addPoint(g)}}}this.psTricksString+="\\end{pspicture*}"};JXG.PsTricks.givePsTricksToDiv=function(a,b){this.convertBoardToPsTricks(b);document.getElementById(a).innerHTML=this.psTricksString};JXG.PsTricks.addPoint=function(a){this.psTricksString+="\\psdot";this.psTricksString+="[linecolor="+this.parseColor(a.visProp.strokeColor)+",";this.psTricksString+="dotstyle=";if(a.visProp.face=="cross"){this.psTricksString+="x, dotsize=";if(a.visProp.size==2){this.psTricksString+="2pt 2"}else{if(a.visProp.size==3){this.psTricksString+="5pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="5pt 3"}}}}else{if(a.visProp.face=="circle"){this.psTricksString+="*, dotsize=";if(a.visProp.size==1){this.psTricksString+="2pt 2"}else{if(a.visProp.size==2){this.psTricksString+="4pt 2"}else{if(a.visProp.size==3){this.psTricksString+="6pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="6pt 3"}}}}}else{if(a.visProp.face=="square"){this.psTricksString+="square*, dotsize=";if(a.visProp.size==2){this.psTricksString+="2pt 2"}else{if(a.visProp.size==3){this.psTricksString+="5pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="5pt 3"}}}}else{if(a.visProp.face=="plus"){this.psTricksString+="+, dotsize=";if(a.visProp.size==2){this.psTricksString+="2pt 2"}else{if(a.visProp.size==3){this.psTricksString+="5pt 2"}else{if(a.visProp.size>=4){this.psTricksString+="5pt 3"}}}}}}}this.psTricksString+="]";this.psTricksString+="("+a.coords.usrCoords[1]+","+a.coords.usrCoords[2]+")\n";this.psTricksString+="\\rput("+(a.coords.usrCoords[1]+15/a.board.stretchY)+","+(a.coords.usrCoords[2]+15/a.board.stretchY)+"){\\small $"+a.name+"$}\n"};JXG.PsTricks.addLine=function(d){var b=new JXG.Coords(JXG.COORDS_BY_USER,d.point1.coords.usrCoords,d.board);var a=new JXG.Coords(JXG.COORDS_BY_USER,d.point2.coords.usrCoords,d.board);if(d.visProp.straightFirst||d.visProp.straightLast){d.board.renderer.calcStraight(d,b,a)}this.psTricksString+="\\psline";this.psTricksString+="[linecolor="+this.parseColor(d.visProp.strokeColor)+", linewidth="+d.visProp.strokeWidth+"px";this.psTricksString+="]";if(d.visProp.firstArrow){if(d.visProp.lastArrow){this.psTricksString+="{<->}"}else{this.psTricksString+="{<-}"}}else{if(d.visProp.lastArrow){this.psTricksString+="{->}"}}this.psTricksString+="("+b.usrCoords[1]+","+b.usrCoords[2]+")("+a.usrCoords[1]+","+a.usrCoords[2]+")\n"};JXG.PsTricks.addCircle=function(b){var a=b.getRadius();this.psTricksString+="\\pscircle";this.psTricksString+="[linecolor="+this.parseColor(b.visProp.strokeColor)+", linewidth="+b.visProp.strokeWidth+"px";if(b.visProp.fillColor!="none"&&b.visProp.fillOpacity!=0){this.psTricksString+=", fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)}this.psTricksString+="]";this.psTricksString+="("+b.midpoint.coords.usrCoords[1]+","+b.midpoint.coords.usrCoords[2]+"){"+a+"}\n"};JXG.PsTricks.addPolygon=function(b){this.psTricksString+="\\pspolygon";this.psTricksString+="[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)+"]";for(var a=0;a<b.vertices.length;a++){this.psTricksString+="("+b.vertices[a].coords.usrCoords[1]+","+b.vertices[a].coords.usrCoords[2]+")"}this.psTricksString+="\n"};JXG.PsTricks.addArc=function(b){var a=b.getRadius();var e={};e.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.board.canvasWidth/(b.board.stretchY),b.midpoint.coords.usrCoords[2]],b.board);var d=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point2),4);var g=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point3),4);this.psTricksString+="\\psarc";this.psTricksString+="[linecolor="+this.parseColor(b.visProp.strokeColor)+", linewidth="+b.visProp.strokeWidth+"px";this.psTricksString+="]";if(b.visProp.lastArrow){if(b.visProp.firstArrow){this.psTricksString+="{<->}"}else{this.psTricksString+="{<-}"}}else{if(b.visProp.firstArrow){this.psTricksString+="{->}"}}this.psTricksString+="("+b.midpoint.coords.usrCoords[1]+","+b.midpoint.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+g+"}\n"};JXG.PsTricks.addSector=function(b){var a=b.getRadius();var e={};e.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.board.canvasWidth/(b.board.stretchY),b.midpoint.coords.usrCoords[2]],b.board);var d=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point2),4);var g=JXG.Math.round(b.board.algebra.trueAngle(e,b.midpoint,b.point3),4);if(b.visProp.fillColor!="none"&&b.visProp.fillOpacity!=0){this.psTricksString+="\\pswedge";this.psTricksString+="[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)+"]";this.psTricksString+="("+b.midpoint.coords.usrCoords[1]+","+b.midpoint.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+g+"}\n"}};JXG.PsTricks.addAngle=function(b){var a=b.radius;var e={};e.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.board.canvasWidth/(b.board.stretchY),b.point2.coords.usrCoords[2]],b.board);var d=JXG.Math.round(b.board.algebra.trueAngle(e,b.point2,b.point1),4);var g=JXG.Math.round(b.board.algebra.trueAngle(e,b.point2,b.point3),4);if(b.visProp.fillColor!="none"&&b.visProp.fillOpacity!=0){this.psTricksString+="\\pswedge";this.psTricksString+="[linestyle=none, fillstyle=solid, fillcolor="+this.parseColor(b.visProp.fillColor)+", opacity="+JXG.Math.round(b.visProp.fillOpacity,5)+"]";this.psTricksString+="("+b.point2.coords.usrCoords[1]+","+b.point2.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+g+"}\n"}this.psTricksString+="\\psarc";this.psTricksString+="[linecolor="+this.parseColor(b.visProp.strokeColor)+", linewidth="+b.visProp.strokeWidth+"px";this.psTricksString+="]";this.psTricksString+="("+b.point2.coords.usrCoords[1]+","+b.point2.coords.usrCoords[2]+"){"+a+"}{"+d+"}{"+g+"}\n"};JXG.PsTricks.parseColor=function(b){var a=JXG.rgbParser(b);return"{[rgb]{"+a[0]/255+","+a[1]/255+","+a[2]/255+"}}"};JXG.Server=function(){};JXG.Server.modules=function(){};JXG.Server.runningCalls={};JXG.Server.handleError=function(a){alert("error occured, server says: "+a.message)};JXG.Server.callServer=function(action,callback,data,sync){var fileurl,passdata,AJAX,params,id,dataJSONStr,k;if(typeof sync=="undefined"||sync==null){sync=false}params="";for(k in data){params+="&"+escape(k)+"="+escape(data[k])}dataJSONStr=JXG.toJSON(data);do{id=action+Math.floor(Math.random()*4096)}while(typeof this.runningCalls[id]!="undefined");this.runningCalls[id]={action:action};if(typeof data.module!="undefined"){this.runningCalls[id].module=data.module}fileurl=JXG.serverBase+"JXGServer.py";passdata="action="+escape(action)+"&id="+id+"&dataJSON="+escape(JXG.Util.Base64.encode(dataJSONStr));this.cbp=function(d){var str,data,tmp,inject,paramlist,id,i,j;str=(new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(d))).unzip();if(JXG.isArray(str)&&str.length>0){str=str[0][0]}if(typeof str!="string"){return}data=eval("("+str+")");if(data.type=="error"){this.handleError(data)}else{if(data.type=="response"){id=data.id;for(i=0;i<data.fields.length;i++){tmp=data.fields[i];inject=tmp.namespace+(typeof eval(tmp.namespace)=="object"?".":".prototype.")+tmp.name+" = "+tmp.value;eval(inject)}for(i=0;i<data.handler.length;i++){tmp=data.handler[i];paramlist=[];for(j=0;j<tmp.parameters.length;j++){paramlist[j]='"'+tmp.parameters[j]+'": '+tmp.parameters[j]}inject="if(typeof JXG.Server.modules."+this.runningCalls[id].module+' == "undefined")JXG.Server.modules.'+this.runningCalls[id].module+" = {};";inject+="JXG.Server.modules."+this.runningCalls[id].module+"."+tmp.name+"_cb = "+tmp.callback+";";inject+="JXG.Server.modules."+this.runningCalls[id].module+"."+tmp.name+" = function ("+tmp.parameters.join(",")+', __JXGSERVER_CB__) {if(typeof __JXGSERVER_CB__ == "undefined") __JXGSERVER_CB__ = JXG.Server.modules.'+this.runningCalls[id].module+"."+tmp.name+"_cb;var __JXGSERVER_PAR__ = {"+paramlist.join(",")+', "module": "'+this.runningCalls[id].module+'", "handler": "'+tmp.name+'" };JXG.Server.callServer("exec", __JXGSERVER_CB__, __JXGSERVER_PAR__);};';eval(inject)}delete this.runningCalls[id];callback(data.data)}}};this.cb=JXG.bind(this.cbp,this);if(window.XMLHttpRequest){AJAX=new XMLHttpRequest();AJAX.overrideMimeType("text/plain; charset=iso-8859-1")}else{AJAX=new ActiveXObject("Microsoft.XMLHTTP")}if(AJAX){AJAX.open("POST",fileurl,!sync);AJAX.setRequestHeader("Content-type","application/x-www-form-urlencoded");if(!sync){AJAX.onreadystatechange=(function(cb){return function(){switch(AJAX.readyState){case 4:if(AJAX.status!=200){alert("Fehler:"+AJAX.status)}else{cb(AJAX.responseText)}break;default:return false;break}}})(this.cb)}AJAX.send(passdata);if(sync){this.cb(AJAX.responseText)}}else{return false}};JXG.Server.loadModule_cb=function(b){var a;for(a=0;a<b.length;a++){alert(b[a].name+": "+b[a].value)}};JXG.Server.loadModule=function(a){return JXG.Server.callServer("load",JXG.Server.loadModule_cb,{module:a},true)};JXG.DataSource=function(){this.data=[];this.columnHeaders=[];this.rowHeaders=[];return this};JXG.DataSource.prototype.loadFromArray=function(g,h,e){var d,b,a;if(typeof h=="undefined"){h=false}if(typeof e=="undefined"){e=false}if(JXG.isArray(h)){this.columnHeader=h;h=false}if(JXG.isArray(e)){this.rowHeader=e;e=false}this.data=[];if(h){this.columnHeader=[]}if(e){this.rowHeader=[]}if(typeof g!="undefined"){this.data=new Array(g.length);for(d=0;d<g.length;d++){this.data[d]=new Array(g[d].length);for(b=0;b<g[d].length;b++){a=g[d][b];if(""+parseFloat(a)==a){this.data[d][b]=parseFloat(a)}else{if(a!="-"){this.data[d][b]=a}else{this.data[d][b]=NaN}}}}if(h){this.columnHeader=this.data[0].slice(1);this.data=this.data.slice(1)}if(e){this.rowHeader=new Array();for(d=0;d<this.data.length;d++){this.rowHeader.push(this.data[d][0]);this.data[d]=this.data[d].slice(1)}}}return this};JXG.DataSource.prototype.loadFromTable=function(l,d,h){var m,g,e,b,k,a;if(typeof d=="undefined"){d=false}if(typeof h=="undefined"){h=false}if(JXG.isArray(d)){this.columnHeader=d;d=false}if(JXG.isArray(h)){this.rowHeader=h;h=false}this.data=[];if(d){this.columnHeader=[]}if(h){this.rowHeader=[]}l=document.getElementById(l);if(typeof l!="undefined"){m=l.getElementsByTagName("tr");this.data=new Array(m.length);for(g=0;g<m.length;g++){b=m[g].getElementsByTagName("td");this.data[g]=new Array(b.length);for(e=0;e<b.length;e++){k=b[e].innerHTML;if(""+parseFloat(k)==k){this.data[g][e]=parseFloat(k)}else{if(k!="-"){this.data[g][e]=k}else{this.data[g][e]=NaN}}}}if(d){this.columnHeader=this.data[0].slice(1);this.data=this.data.slice(1)}if(h){this.rowHeader=new Array();for(g=0;g<this.data.length;g++){this.rowHeader.push(this.data[g][0]);this.data[g]=this.data[g].slice(1)}}}return this};JXG.DataSource.prototype.addColumn=function(a,d,b){};JXG.DataSource.prototype.addRow=function(a,d,b){};JXG.DataSource.prototype.getColumn=function(b){var a=new Array(this.data.length),d;if(typeof b=="string"){for(d=0;d<this.columnHeader.length;d++){if(b==this.columnHeader[d]){b=d;break}}}for(d=0;d<this.data.length;d++){if(this.data[d].length>b){a[d]=this.data[d][b]}}return a};JXG.DataSource.prototype.getRow=function(d){var a,b;if(typeof d=="string"){for(b=0;b<this.rowHeader.length;b++){if(d==this.rowHeader[b]){d=b;break}}}a=new Array(this.data[d].length);for(b=0;b<this.data[d].length;b++){a[b]=this.data[d][b]}return a};JXG.SVGRenderer=function(a){this.constructor();this.svgRoot=null;this.suspendHandle=null;this.svgNamespace="http://www.w3.org/2000/svg";this.xlinkNamespace="http://www.w3.org/1999/xlink";this.container=a;this.container.style.MozUserSelect="none";this.container.style.overflow="hidden";if(this.container.style.position==""){this.container.style.position="relative"}this.svgRoot=this.container.ownerDocument.createElementNS(this.svgNamespace,"svg");this.container.appendChild(this.svgRoot);this.defs=this.container.ownerDocument.createElementNS(this.svgNamespace,"defs");this.svgRoot.appendChild(this.defs);this.filter=this.container.ownerDocument.createElementNS(this.svgNamespace,"filter");this.filter.setAttributeNS(null,"id","f1");this.filter.setAttributeNS(null,"width","300%");this.filter.setAttributeNS(null,"height","300%");this.feOffset=this.container.ownerDocument.createElementNS(this.svgNamespace,"feOffset");this.feOffset.setAttributeNS(null,"result","offOut");this.feOffset.setAttributeNS(null,"in","SourceAlpha");this.feOffset.setAttributeNS(null,"dx","5");this.feOffset.setAttributeNS(null,"dy","5");this.filter.appendChild(this.feOffset);this.feGaussianBlur=this.container.ownerDocument.createElementNS(this.svgNamespace,"feGaussianBlur");this.feGaussianBlur.setAttributeNS(null,"result","blurOut");this.feGaussianBlur.setAttributeNS(null,"in","offOut");this.feGaussianBlur.setAttributeNS(null,"stdDeviation","3");this.filter.appendChild(this.feGaussianBlur);this.feBlend=this.container.ownerDocument.createElementNS(this.svgNamespace,"feBlend");this.feBlend.setAttributeNS(null,"in","SourceGraphic");this.feBlend.setAttributeNS(null,"in2","blurOut");this.feBlend.setAttributeNS(null,"mode","normal");this.filter.appendChild(this.feBlend);this.defs.appendChild(this.filter);this.images=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.images);this.grid=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.grid);this.angles=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.angles);this.sectors=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.sectors);this.polygone=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.polygone);this.curves=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.curves);this.circles=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.circles);this.lines=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.lines);this.arcs=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.arcs);this.points=this.container.ownerDocument.createElementNS(this.svgNamespace,"g");this.svgRoot.appendChild(this.points);this.dashArray=["2, 2","5, 5","10, 10","20, 20","20, 10, 10, 10","20, 5, 10, 5"]};JXG.SVGRenderer.prototype=new JXG.AbstractRenderer;JXG.SVGRenderer.prototype.setShadow=function(a){if(a.visPropOld.shadow==a.visProp.shadow){return}if(a.rendNode!=null){if(a.visProp.shadow){a.rendNode.setAttributeNS(null,"filter","url(#f1)")}else{a.rendNode.removeAttributeNS(null,"filter")}}a.visPropOld.shadow=a.visProp.shadow};JXG.SVGRenderer.prototype.setGradient=function(d){var s=d.rendNode,e,h;if(d.type==JXG.OBJECT_TYPE_ARC||d.type==JXG.OBJECT_TYPE_ANGLE){s=d.rendNode2}if(typeof d.visProp.fillOpacity=="function"){h=d.visProp.fillOpacity()}else{h=d.visProp.fillOpacity}h=(h>0)?h:0;if(typeof d.visProp.fillColor=="function"){e=d.visProp.fillColor()}else{e=d.visProp.fillColor}if(d.visProp.gradient=="linear"){var g=this.createPrimitive("linearGradient",d.id+"_gradient");var b="0%";var a="100%";var l="0%";var k="0%";g.setAttributeNS(null,"x1",b);g.setAttributeNS(null,"x2",a);g.setAttributeNS(null,"y1",l);g.setAttributeNS(null,"y2",k);var q=this.createPrimitive("stop",d.id+"_gradient1");q.setAttributeNS(null,"offset","0%");q.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+h);var m=this.createPrimitive("stop",d.id+"_gradient2");m.setAttributeNS(null,"offset","100%");m.setAttributeNS(null,"style","stop-color:"+d.visProp.gradientSecondColor+";stop-opacity:"+d.visProp.gradientSecondOpacity);g.appendChild(q);g.appendChild(m);this.defs.appendChild(g);s.setAttributeNS(null,"style","fill:url(#"+d.id+"_gradient)");d.gradNode1=q;d.gradNode2=m}else{if(d.visProp.gradient=="radial"){var g=this.createPrimitive("radialGradient",d.id+"_gradient");g.setAttributeNS(null,"cx","50%");g.setAttributeNS(null,"cy","50%");g.setAttributeNS(null,"r","50%");g.setAttributeNS(null,"fx",d.visProp.gradientPositionX*100+"%");g.setAttributeNS(null,"fy",d.visProp.gradientPositionY*100+"%");var q=this.createPrimitive("stop",d.id+"_gradient1");q.setAttributeNS(null,"offset","0%");q.setAttributeNS(null,"style","stop-color:"+d.visProp.gradientSecondColor+";stop-opacity:"+d.visProp.gradientSecondOpacity);var m=this.createPrimitive("stop",d.id+"_gradient2");m.setAttributeNS(null,"offset","100%");m.setAttributeNS(null,"style","stop-color:"+e+";stop-opacity:"+h);g.appendChild(q);g.appendChild(m);this.defs.appendChild(g);s.setAttributeNS(null,"style","fill:url(#"+d.id+"_gradient)");d.gradNode1=q;d.gradNode2=m}else{s.removeAttributeNS(null,"style")}}};JXG.SVGRenderer.prototype.updateGradient=function(e){var b=e.gradNode1,a=e.gradNode2,d,g;if(b==null||a==0){return}if(typeof e.visProp.fillOpacity=="function"){g=e.visProp.fillOpacity()}else{g=e.visProp.fillOpacity}g=(g>0)?g:0;if(typeof e.visProp.fillColor=="function"){d=e.visProp.fillColor()}else{d=e.visProp.fillColor}if(e.visProp.gradient=="linear"){b.setAttributeNS(null,"style","stop-color:"+d+";stop-opacity:"+g);a.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientSecondColor+";stop-opacity:"+e.visProp.gradientSecondOpacity)}else{if(e.visProp.gradient=="radial"){b.setAttributeNS(null,"style","stop-color:"+e.visProp.gradientSecondColor+";stop-opacity:"+e.visProp.gradientSecondOpacity);a.setAttributeNS(null,"style","stop-color:"+d+";stop-opacity:"+g)}}};JXG.SVGRenderer.prototype.displayCopyright=function(d,e){var b=this.createPrimitive("text","licenseText"),a;b.setAttributeNS(null,"x","20");b.setAttributeNS(null,"y",2+e);b.setAttributeNS(null,"style","font-family:Arial,Helvetica,sans-serif; font-size:"+e+"px; fill:#356AA0;  opacity:0.3;");a=document.createTextNode(d);b.appendChild(a);this.appendChildPrimitive(b,"images")};JXG.SVGRenderer.prototype.drawInternalText=function(a){var b=this.createPrimitive("text",a.id);b.setAttributeNS(null,"class","JXGtext");a.rendNodeText=document.createTextNode("");b.appendChild(a.rendNodeText);this.appendChildPrimitive(b,"points");return b};JXG.SVGRenderer.prototype.updateInternalText=function(a){a.rendNode.setAttributeNS(null,"x",(a.coords.scrCoords[1])+"px");a.rendNode.setAttributeNS(null,"y",(a.coords.scrCoords[2]-this.vOffsetText)+"px");a.updateText();if(a.htmlStr!=a.plaintextStr){a.rendNodeText.data=a.plaintextStr;a.htmlStr=a.plaintextStr}};JXG.SVGRenderer.prototype.drawTicks=function(a){var b=this.createPrimitive("path",a.id);b.setAttributeNS(null,"shape-rendering","crispEdges");this.appendChildPrimitive(b,"lines");this.appendNodesToElement(a,"path")};JXG.SVGRenderer.prototype.updateTicks=function(e,g,a,k,b){var h="",l,q,d,m=e.ticks.length;for(l=0;l<m;l++){q=e.ticks[l].scrCoords;if(e.ticks[l].major){if(e.labels[l].visProp.visible){this.drawText(e.labels[l])}h+="M "+(q[1]+g)+" "+(q[2]-a)+" L "+(q[1]-g)+" "+(q[2]+a)+" "}else{h+="M "+(q[1]+k)+" "+(q[2]-b)+" L "+(q[1]-k)+" "+(q[2]+b)+" "}}d=document.getElementById(e.id);if(d==null){d=this.createPrimitive("path",e.id);d.setAttributeNS(null,"shape-rendering","crispEdges");this.appendChildPrimitive(d,"lines");this.appendNodesToElement(e,"path")}d.setAttributeNS(null,"stroke",e.visProp.strokeColor);d.setAttributeNS(null,"stroke-opacity",e.visProp.strokeOpacity);d.setAttributeNS(null,"stroke-width",e.visProp.strokeWidth);this.updatePathPrimitive(d,h,e.board)};JXG.SVGRenderer.prototype.drawArc=function(b){var d=this.createPrimitive("path",b.id),k,e,a,l,g,h,q,m;b.rendNode=d;JXG.clearVisPropOld(b);k=b.getRadius();e=b.board.algebra.trueAngle(b.point2,b.midpoint,b.point3);a={};a.midpoint=b.midpoint;a.getRadius=function(){return k};l=b.board.algebra.projectPointToCircle(b.point3,a);g="M "+b.point2.coords.scrCoords[1]+" "+b.point2.coords.scrCoords[2]+" A ";g+=Math.round(k*b.board.stretchX)+" "+Math.round(k*b.board.stretchY)+" 0 ";if(e>=180){g+="1 "}else{g+="0 "}g+="0 ";g+=l.scrCoords[1]+" "+l.scrCoords[2];this.updatePathPrimitive(d,g,b.board);if(b.visProp.strokeColor!=null){d.setAttributeNS(null,"stroke",b.visProp.strokeColor)}if(b.visProp.strokeOpacity!=null){d.setAttributeNS(null,"stroke-opacity",b.visProp.strokeOpacity)}if(b.visProp.strokeWidth!=null){d.setAttributeNS(null,"stroke-width",b.visProp.strokeWidth)}d.setAttributeNS(null,"fill","none");this.setDashStyle(b,b.visProp);this.setShadow(b);if(b.visProp.firstArrow){q=this.createArrowHead(b,"Start");this.defs.appendChild(q);b.rendNodeTriangleStart=q;d.setAttributeNS(null,"marker-end","url(#"+b.id+"TriangleStart)")}if(b.visProp.lastArrow){q=this.createArrowHead(b,"End");this.defs.appendChild(q);b.rendNodeTriangleEnd=q;d.setAttributeNS(null,"marker-start","url(#"+b.id+"TriangleEnd)")}m=this.createPrimitive("path",b.id+"sector");b.rendNode2=m;h="M "+b.midpoint.coords.scrCoords[1]+" "+b.midpoint.coords.scrCoords[2];h+=" L "+b.point2.coords.scrCoords[1]+" "+b.point2.coords.scrCoords[2]+" A ";h+=Math.round(k*b.board.stretchX)+" "+Math.round(k*b.board.stretchY)+" 0 ";if(e>=180){h+="1 "}else{h+="0 "}h+="0 ";h+=l.scrCoords[1]+" "+l.scrCoords[2];h+=" L "+b.midpoint.coords.scrCoords[1]+" "+b.midpoint.coords.scrCoords[2]+" z";this.updatePathPrimitive(m,h,b.board);if(b.visProp.fillColor!=null){m.setAttributeNS(null,"fill",b.visProp.fillColor)}if(b.visProp.fillOpacity!=null){m.setAttributeNS(null,"fill-opacity",b.visProp.fillOpacity)}m.setAttributeNS(null,"stroke","none");this.setGradient(b);this.arcs.appendChild(d);this.sectors.appendChild(m);if(b.visProp.draft){this.setDraft(b)}if(!b.visProp.visible){b.hideElement()}};JXG.SVGRenderer.prototype.updateArc=function(a){var b;this.remove(a.rendNode);this.remove(a.rendNode2);b=a.rendNodeTriangleStart;if(b!=null){this.remove(b)}b=a.rendNodeTriangleEnd;if(b!=null){this.remove(b)}this.drawArc(a);return};JXG.SVGRenderer.prototype.drawAngle=function(g){var l=g.board.algebra.trueAngle(g.point1,g.point2,g.point3),k,e,b,h,a,d;JXG.clearVisPropOld(g);k={};k.midpoint=g.point2;k.getRadius=function(){return g.radius};e=g.board.algebra.projectPointToCircle(g.point1,k);b=g.board.algebra.projectPointToCircle(g.point3,k);h=this.createPrimitive("path",g.id+"_1");d="M "+g.point2.coords.scrCoords[1]+" "+g.point2.coords.scrCoords[2];d+=" L "+e.scrCoords[1]+" "+e.scrCoords[2]+" A ";d+=Math.round(g.radius*g.board.stretchX)+" "+Math.round(g.radius*g.board.stretchY)+" 0 ";if(l>=180){d+="1 "}else{d+="0 "}d+="0 ";d+=b.scrCoords[1]+" "+b.scrCoords[2];d+=" L "+g.point2.coords.scrCoords[1]+" "+g.point2.coords.scrCoords[2]+" z";h.setAttributeNS(null,"d",d);h.setAttributeNS(null,"fill",g.visProp.fillColor);h.setAttributeNS(null,"fill-opacity",g.visProp.fillOpacity);h.setAttributeNS(null,"stroke","none");a=this.createPrimitive("path",g.id+"_2");d="M "+e.scrCoords[1]+" "+e.scrCoords[2]+" A ";d+=Math.round(g.radius*g.board.stretchX)+" "+Math.round(g.radius*g.board.stretchY)+" 0 ";if(l>=180){d+="1 "}else{d+="0 "}d+="0 ";d+=b.scrCoords[1]+" "+b.scrCoords[2];a.setAttributeNS(null,"d",d);a.setAttributeNS(null,"id",g.id+"_2");a.setAttributeNS(null,"fill","none");a.setAttributeNS(null,"stroke",g.visProp.strokeColor);a.setAttributeNS(null,"stroke-opacity",g.visProp.strokeOpacity);this.appendChildPrimitive(h,"angles");g.rendNode=h;this.setShadow(g);this.appendChildPrimitive(a,"angles");g.rendNode2=a;this.setObjectStrokeWidth(g,g.visProp.strokeWidth)};JXG.SVGRenderer.prototype.updateAngle=function(a){this.remove(a.rendNode);this.remove(a.rendNode2);this.drawAngle(a);if(!a.visProp.visible){a.hideElement()}return};JXG.SVGRenderer.prototype.drawImage=function(b){var a=b.url,d=this.createPrimitive("image",b.id);d.setAttributeNS(this.xlinkNamespace,"xlink:href",a);this.appendChildPrimitive(d,b.displayLevel);b.rendNode=d;this.updateImage(b)};JXG.SVGRenderer.prototype.transformImage=function(b,a){var d=b.rendNode,e=d.getAttributeNS(null,"transform");e+=" "+this.joinTransforms(b,a);d.setAttributeNS(null,"transform",e)};JXG.SVGRenderer.prototype.joinTransforms=function(g,d){var h="",b,e,a=d.length;for(b=0;b<a;b++){e=d[b].matrix[1][1]+","+d[b].matrix[2][1]+","+d[b].matrix[1][2]+","+d[b].matrix[2][2]+","+d[b].matrix[1][0]+","+d[b].matrix[2][0];h+="matrix("+e+") "}return h};JXG.SVGRenderer.prototype.transformImageParent=function(d,a){var b,e;if(a!=null){b=a[1][1]+","+a[2][1]+","+a[1][2]+","+a[2][2]+","+a[1][0]+","+a[2][0];e="matrix("+b+")"}else{e=""}d.rendNode.setAttributeNS(null,"transform",e)};JXG.SVGRenderer.prototype.removeGrid=function(a){var b=this.grid;a.hasGrid=false;while(b.childNodes.length>0){b.removeChild(b.firstChild)}};JXG.SVGRenderer.prototype.setObjectStrokeColor=function(el,color,opacity){var c=this.eval(color),o=this.eval(opacity),node;o=(o>0)?o:0;if(el.visPropOld.strokeColor==c&&el.visPropOld.strokeOpacity==o){return}node=el.rendNode;if(el.type==JXG.OBJECT_TYPE_TEXT){node.style.color=c}else{node.setAttributeNS(null,"stroke",c);node.setAttributeNS(null,"stroke-opacity",o)}if(el.type==JXG.OBJECT_TYPE_ARROW){el.rendNodeTriangle.setAttributeNS(null,"stroke",c);el.rendNodeTriangle.setAttributeNS(null,"stroke-opacity",o);el.rendNodeTriangle.setAttributeNS(null,"fill",c);el.rendNodeTriangle.setAttributeNS(null,"fill-opacity",o)}if(el.type==JXG.OBJECT_TYPE_ARC){if(el.visProp.firstArrow){el.rendNodeTriangleStart.setAttributeNS(null,"stroke",c);el.rendNodeTriangleStart.setAttributeNS(null,"stroke-opacity",o);el.rendNodeTriangleStart.setAttributeNS(null,"fill",c);el.rendNodeTriangleStart.setAttributeNS(null,"fill-opacity",o)}if(el.visProp.lastArrow){el.rendNodeTriangleEnd.setAttributeNS(null,"stroke",c);el.rendNodeTriangleEnd.setAttributeNS(null,"stroke-opacity",o);el.rendNodeTriangleEnd.setAttributeNS(null,"fill",c);el.rendNodeTriangleEnd.setAttributeNS(null,"fill-opacity",o)}}else{if(el.type==JXG.OBJECT_TYPE_LINE){if(el.visProp.firstArrow){el.rendNodeTriangleStart.setAttributeNS(null,"stroke",c);el.rendNodeTriangleStart.setAttributeNS(null,"stroke-opacity",o);el.rendNodeTriangleStart.setAttributeNS(null,"fill",c);el.rendNodeTriangleStart.setAttributeNS(null,"fill-opacity",o)}if(el.visProp.lastArrow){el.rendNodeTriangleEnd.setAttributeNS(null,"stroke",c);el.rendNodeTriangleEnd.setAttributeNS(null,"stroke-opacity",o);el.rendNodeTriangleEnd.setAttributeNS(null,"fill",c);el.rendNodeTriangleEnd.setAttributeNS(null,"fill-opacity",o)}}}el.visPropOld.strokeColor=c;el.visPropOld.strokeOpacity=o};JXG.SVGRenderer.prototype.setObjectFillColor=function(el,color,opacity){var c=this.eval(color),o=this.eval(opacity);o=(o>0)?o:0;if(el.visPropOld.fillColor==c&&el.visPropOld.fillOpacity==o){return}if(el.type==JXG.OBJECT_TYPE_ARC||el.type==JXG.OBJECT_TYPE_ANGLE){node=el.rendNode2;node.setAttributeNS(null,"fill",c);node.setAttributeNS(null,"fill-opacity",o)}else{node=el.rendNode;node.setAttributeNS(null,"fill",c);node.setAttributeNS(null,"fill-opacity",o)}if(el.visProp.gradient!=null){this.updateGradient(el)}el.visPropOld.fillColor=c;el.visPropOld.fillOpacity=o};JXG.SVGRenderer.prototype.setObjectStrokeWidth=function(el,width){var w=this.eval(width),node;try{if(el.visPropOld.strokeWidth==w){return}}catch(e){alert(el.id)}if(el.elementClass!=JXG.OBJECT_CLASS_POINT){if(el.type==JXG.OBJECT_TYPE_ANGLE){node=el.rendNode2}else{node=el.rendNode}this.setPropertyPrimitive(node,"stroked","true");if(w!=null){this.setPropertyPrimitive(node,"stroke-width",w)}}else{node=el.rendNode;this.setPropertyPrimitive(node,"stroked","true");if(w!=null){this.setPropertyPrimitive(node,"stroke-width",w)}}el.visPropOld.strokeWidth=w};JXG.SVGRenderer.prototype.hide=function(a){var b;if(a==null){return}if(a.type==JXG.OBJECT_TYPE_ARC){b=a.rendNode;b.setAttributeNS(null,"display","none");b.style.visibility="hidden";b=a.rendNode2;b.setAttributeNS(null,"display","none");b.style.visibility="hidden"}else{if(a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode;b.setAttributeNS(null,"display","none");b.style.visibility="hidden";b=a.rendNode2;b.setAttributeNS(null,"display","none");b.style.visibility="hidden"}else{b=a.rendNode;b.setAttributeNS(null,"display","none");b.style.visibility="hidden"}}};JXG.SVGRenderer.prototype.show=function(a){var b;if(a.type==JXG.OBJECT_TYPE_ARC){b=a.rendNode;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit";b=a.rendNode2;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit"}else{if(a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit";b=a.rendNode2;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit"}else{b=a.rendNode;b.setAttributeNS(null,"display","inline");b.style.visibility="inherit"}}};JXG.SVGRenderer.prototype.remove=function(a){if(a!=null&&a.parentNode!=null){a.parentNode.removeChild(a)}};JXG.SVGRenderer.prototype.suspendRedraw=function(){if(true){this.suspendHandle=this.svgRoot.suspendRedraw(10000)}};JXG.SVGRenderer.prototype.unsuspendRedraw=function(){if(true){this.svgRoot.unsuspendRedraw(this.suspendHandle);this.svgRoot.forceRedraw()}};JXG.SVGRenderer.prototype.setDashStyle=function(b,a){var e=b.visProp.dash,d=b.rendNode;if(b.visProp.dash>0){d.setAttributeNS(null,"stroke-dasharray",this.dashArray[e-1])}else{if(d.hasAttributeNS(null,"stroke-dasharray")){d.removeAttributeNS(null,"stroke-dasharray")}}};JXG.SVGRenderer.prototype.setGridDash=function(b){var a=document.getElementById(b);this.setPropertyPrimitive(a,"stroke-dasharray","5, 5")};JXG.SVGRenderer.prototype.createPrimitive=function(a,d){var b=this.container.ownerDocument.createElementNS(this.svgNamespace,a);b.setAttributeNS(null,"id",d);b.style.position="absolute";if(a=="path"){b.setAttributeNS(null,"stroke-linecap","butt");b.setAttributeNS(null,"stroke-linejoin","round")}return b};JXG.SVGRenderer.prototype.createArrowHead=function(d,g){var e=d.id+"Triangle",b,a;if(g!=null){e+=g}b=this.createPrimitive("marker",e);b.setAttributeNS(null,"viewBox","0 0 10 6");b.setAttributeNS(null,"refY","3");b.setAttributeNS(null,"markerUnits","strokeWidth");b.setAttributeNS(null,"markerHeight","6");b.setAttributeNS(null,"markerWidth","6");b.setAttributeNS(null,"orient","auto");b.setAttributeNS(null,"stroke",d.visProp.strokeColor);b.setAttributeNS(null,"stroke-opacity",d.visProp.strokeOpacity);b.setAttributeNS(null,"fill",d.visProp.strokeColor);b.setAttributeNS(null,"fill-opacity",d.visProp.strokeOpacity);a=this.container.ownerDocument.createElementNS(this.svgNamespace,"path");if(g=="End"){b.setAttributeNS(null,"refX","0");a.setAttributeNS(null,"d","M 0 3 L 10 6 L 10 0 z")}else{b.setAttributeNS(null,"refX","10");a.setAttributeNS(null,"d","M 0 0 L 10 3 L 0 6 z")}b.appendChild(a);return b};JXG.SVGRenderer.prototype.makeArrow=function(d,b,e){var a=this.createArrowHead(b,e);this.defs.appendChild(a);d.setAttributeNS(null,"marker-end","url(#"+b.id+"Triangle)");b.rendNodeTriangle=a};JXG.SVGRenderer.prototype.makeArrows=function(b){var a;if(b.visPropOld.firstArrow==b.visProp.firstArrow&&b.visPropOld.lastArrow==b.visProp.lastArrow){return}if(b.visProp.firstArrow){a=b.rendNodeTriangleStart;if(a==null){a=this.createArrowHead(b,"End");this.defs.appendChild(a);b.rendNodeTriangleStart=a;b.rendNode.setAttributeNS(null,"marker-start","url(#"+b.id+"TriangleEnd)")}}else{a=b.rendNodeTriangleStart;if(a!=null){this.remove(a)}}if(b.visProp.lastArrow){a=b.rendNodeTriangleEnd;if(a==null){a=this.createArrowHead(b,"Start");this.defs.appendChild(a);b.rendNodeTriangleEnd=a;b.rendNode.setAttributeNS(null,"marker-end","url(#"+b.id+"TriangleStart)")}}else{a=b.rendNodeTriangleEnd;if(a!=null){this.remove(a)}}b.visPropOld.firstArrow=b.visProp.firstArrow;b.visPropOld.lastArrow=b.visProp.lastArrow};JXG.SVGRenderer.prototype.updateLinePrimitive=function(g,b,a,e,d){g.setAttributeNS(null,"x1",b);g.setAttributeNS(null,"y1",a);g.setAttributeNS(null,"x2",e);g.setAttributeNS(null,"y2",d)};JXG.SVGRenderer.prototype.updateCirclePrimitive=function(d,a,e,b){d.setAttributeNS(null,"cx",(a));d.setAttributeNS(null,"cy",(e));d.setAttributeNS(null,"r",(b))};JXG.SVGRenderer.prototype.updateEllipsePrimitive=function(b,a,g,e,d){b.setAttributeNS(null,"cx",(a));b.setAttributeNS(null,"cy",(g));b.setAttributeNS(null,"rx",(e));b.setAttributeNS(null,"ry",(d))};JXG.SVGRenderer.prototype.updateRectPrimitive=function(e,a,g,b,d){e.setAttributeNS(null,"x",(a));e.setAttributeNS(null,"y",(g));e.setAttributeNS(null,"width",(b));e.setAttributeNS(null,"height",(d))};JXG.SVGRenderer.prototype.updatePathPrimitive=function(b,d,a){b.setAttributeNS(null,"d",d)};JXG.SVGRenderer.prototype.updatePathStringPrimitive=function(a){var d=" M ",e=" L ",b=d,q=5000,h="",g,l,m=(a.curveType!="plot"),k;if(a.numberPoints<=0){return""}if(m&&a.board.options.curve.RDPsmoothing){a.points=this.RamenDouglasPeuker(a.points,0.5)}k=Math.min(a.points.length,a.numberPoints);for(g=0;g<k;g++){l=a.points[g].scrCoords;if(isNaN(l[1])||isNaN(l[2])){b=d}else{if(l[1]>q){l[1]=q}else{if(l[1]<-q){l[1]=-q}}if(l[2]>q){l[2]=q}else{if(l[2]<-q){l[2]=-q}}h+=[b,l[1]," ",l[2]].join("");b=e}}return h};JXG.SVGRenderer.prototype.updatePathStringPoint=function(e,a,d){var b="";if(d=="x"){b="M "+(e.coords.scrCoords[1]-a)+" "+(e.coords.scrCoords[2]-a)+" L "+(e.coords.scrCoords[1]+a)+" "+(e.coords.scrCoords[2]+a)+" M "+(e.coords.scrCoords[1]+a)+" "+(e.coords.scrCoords[2]-a)+" L "+(e.coords.scrCoords[1]-a)+" "+(e.coords.scrCoords[2]+a)}else{if(d=="+"){b="M "+(e.coords.scrCoords[1]-a)+" "+(e.coords.scrCoords[2])+" L "+(e.coords.scrCoords[1]+a)+" "+(e.coords.scrCoords[2])+" M "+(e.coords.scrCoords[1])+" "+(e.coords.scrCoords[2]-a)+" L "+(e.coords.scrCoords[1])+" "+(e.coords.scrCoords[2]+a)}}return b};JXG.SVGRenderer.prototype.updatePolygonePrimitive=function(g,d){var h="",e,b,a=d.vertices.length;g.setAttributeNS(null,"stroke","none");for(b=0;b<a-1;b++){e=d.vertices[b].coords.scrCoords;h=h+e[1]+","+e[2];if(b<a-2){h+=" "}}g.setAttributeNS(null,"points",h)};JXG.SVGRenderer.prototype.appendChildPrimitive=function(a,b){switch(b){case"images":this.images.appendChild(a);break;case"grid":this.grid.appendChild(a);break;case"angles":this.angles.appendChild(a);break;case"sectors":this.sectors.appendChild(a);break;case"polygone":this.polygone.appendChild(a);break;case"curves":this.curves.appendChild(a);break;case"circles":this.circles.appendChild(a);break;case"lines":this.lines.appendChild(a);break;case"arcs":this.arcs.appendChild(a);break;case"points":this.points.appendChild(a);break}};JXG.SVGRenderer.prototype.setPropertyPrimitive=function(b,a,d){if(a=="stroked"){return}b.setAttributeNS(null,a,d)};JXG.SVGRenderer.prototype.drawVerticalGrid=function(e,b,h,d){var g=this.createPrimitive("path","gridx"),a="";while(e.scrCoords[1]<b.scrCoords[1]+h-1){a+=" M "+e.scrCoords[1]+" "+0+" L "+e.scrCoords[1]+" "+d.canvasHeight+" ";e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1]+h,e.scrCoords[2]])}this.updatePathPrimitive(g,a,d);return g};JXG.SVGRenderer.prototype.drawHorizontalGrid=function(e,b,h,d){var g=this.createPrimitive("path","gridy"),a="";while(e.scrCoords[2]<=b.scrCoords[2]+h-1){a+=" M "+0+" "+e.scrCoords[2]+" L "+d.canvasWidth+" "+e.scrCoords[2]+" ";e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1],e.scrCoords[2]+h])}this.updatePathPrimitive(g,a,d);return g};JXG.SVGRenderer.prototype.appendNodesToElement=function(a,b){a.rendNode=document.getElementById(a.id)};JXG.VMLRenderer=function(a){this.constructor();this.container=a;this.container.style.overflow="hidden";this.container.onselectstart=function(){return false};this.resolution=10;a.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml");this.container.ownerDocument.createStyleSheet().addRule(".jxgvml","behavior:url(#default#VML)");try{!a.ownerDocument.namespaces.jxgvml&&a.ownerDocument.namespaces.add("jxgvml","urn:schemas-microsoft-com:vml");this.createNode=function(d){return a.ownerDocument.createElement("<jxgvml:"+d+' class="jxgvml">')}}catch(b){this.createNode=function(d){return a.ownerDocument.createElement("<"+d+' xmlns="urn:schemas-microsoft.com:vml" class="jxgvml">')}}this.dashArray=["Solid","1 1","ShortDash","Dash","LongDash","ShortDashDot","LongDashDot"]};JXG.VMLRenderer.prototype=new JXG.AbstractRenderer;JXG.VMLRenderer.prototype.setAttr=function(d,a,h,b){try{if(document.documentMode==8){d[a]=h}else{d.setAttribute(a,h,b)}}catch(g){}};JXG.VMLRenderer.prototype.setShadow=function(a){var b=a.rendNodeShadow;if(!b){return}if(a.visPropOld.shadow==a.visProp.shadow){return}if(a.visProp.shadow){this.setAttr(b,"On","True");this.setAttr(b,"Offset","3pt,3pt");this.setAttr(b,"Opacity","60%");this.setAttr(b,"Color","#aaaaaa")}else{this.setAttr(b,"On","False")}a.visPropOld.shadow=a.visProp.shadow};JXG.VMLRenderer.prototype.setGradient=function(b){var a=b.rendNodeFill;if(b.type==JXG.OBJECT_TYPE_ARC||b.type==JXG.OBJECT_TYPE_ANGLE){a=b.rendNode2Fill}if(b.visProp.gradient=="linear"){this.setAttr(a,"type","gradient");this.setAttr(a,"color2",b.visProp.gradientSecondColor);this.setAttr(a,"opacity2",b.visProp.gradientSecondOpacity);this.setAttr(a,"angle",b.visProp.gradientAngle)}else{if(b.visProp.gradient=="radial"){this.setAttr(a,"type","gradientradial");this.setAttr(a,"color2",b.visProp.gradientSecondColor);this.setAttr(a,"opacity2",b.visProp.gradientSecondOpacity);this.setAttr(a,"focusposition",b.visProp.gradientPositionX*100+"%,"+b.visProp.gradientPositionY*100+"%");this.setAttr(a,"focussize","0,0")}else{this.setAttr(a,"type","solid")}}};JXG.VMLRenderer.prototype.updateGradient=function(a){};JXG.VMLRenderer.prototype.addShadowToGroup=function(a,d){var b,e;if(a=="lines"){for(b in d.objects){e=d.objects[b];if(e.elementClass==JXG.OBJECT_CLASS_LINE){this.addShadowToElement(e)}}}else{if(a=="points"){for(b in d.objects){e=d.objects[b];if(e.elementClass==JXG.OBJECT_CLASS_POINT){this.addShadowToElement(e)}}}else{if(a=="circles"){for(b in d.objects){e=d.objects[b];if(e.elementClass==JXG.OBJECT_CLASS_CIRCLE){this.addShadowToElement(e)}}}}}d.fullUpdate()};JXG.VMLRenderer.prototype.displayCopyright=function(d,e){var b,a;b=this.createNode("textbox");b.style.position="absolute";this.setAttr(b,"id","licenseText");b.style.left=20;b.style.top=(2);b.style.fontSize=(e);b.style.color="#356AA0";b.style.fontFamily="Arial,Helvetica,sans-serif";this.setAttr(b,"opacity","30%");b.style.filter="alpha(opacity = 30)";a=document.createTextNode(d);b.appendChild(a);this.appendChildPrimitive(b,"images")};JXG.VMLRenderer.prototype.drawInternalText=function(a){var b;b=this.createNode("textbox");b.style.position="absolute";if(document.documentMode==8){b.setAttribute("class","JXGtext")}else{b.setAttribute("className","JXGtext")}a.rendNodeText=document.createTextNode("");b.appendChild(a.rendNodeText);this.appendChildPrimitive(b,"points");return b};JXG.VMLRenderer.prototype.updateInternalText=function(a){a.rendNode.style.left=(a.coords.scrCoords[1])+"px";a.rendNode.style.top=(a.coords.scrCoords[2]-this.vOffsetText)+"px";a.updateText();if(a.htmlStr!=a.plaintextStr){a.rendNodeText.data=a.plaintextStr;a.htmlStr=a.plaintextStr}};JXG.VMLRenderer.prototype.drawTicks=function(b){var a=this.createPrimitive("path",b.id);this.appendChildPrimitive(a,"lines");this.appendNodesToElement(b,"path")};JXG.VMLRenderer.prototype.updateTicks=function(e,g,a,h,d){var b=[],k,l,m,q;l=e.ticks.length;for(k=0;k<l;k++){m=e.ticks[k];if(m.major){if(e.labels[k].visProp.visible){this.drawText(e.labels[k])}b.push(" m "+Math.round(this.resolution*(m.scrCoords[1]+g))+", "+Math.round(this.resolution*(m.scrCoords[2]-a))+" l "+Math.round(this.resolution*(m.scrCoords[1]-g))+", "+Math.round(this.resolution*(m.scrCoords[2]+a))+" ")}else{b.push(" m "+Math.round(this.resolution*(m.scrCoords[1]+h))+", "+Math.round(this.resolution*(m.scrCoords[2]-d))+" l "+Math.round(this.resolution*(m.scrCoords[1]-h))+", "+Math.round(this.resolution*(m.scrCoords[2]+d))+" ")}}q=document.getElementById(e.id);if(q==null){q=this.createPrimitive("path",e.id);this.appendChildPrimitive(q,"lines");this.appendNodesToElement(e,"path")}this.setAttr(q,"stroked","true");this.setAttr(q,"strokecolor",e.visProp.strokeColor,1);this.setAttr(q,"strokeweight",e.visProp.strokeWidth);this.updatePathPrimitive(q,b,e.board)};JXG.VMLRenderer.prototype.drawArcLine=function(a,k,h,g,s,l,b){var d=this.createNode("arc"),q=this.createNode("fill"),m=this.createNode("stroke"),e=this.createNode("shadow");this.setAttr(d,"id",a);this.setAttr(q,"id",a+"_fill");this.setAttr(m,"id",a+"_stroke");this.setAttr(e,"id",a+"_shadow");d.appendChild(q);d.appendChild(m);d.appendChild(e);b.rendNode=d;b.rendNodeFill=q;b.rendNodeStroke=m;b.rendNodeShadow=e;d.style.position="absolute";this.setAttr(d,"filled","false");d.style.left=(s.coords.scrCoords[1]-Math.round(k*l.stretchX))+"px";d.style.top=(s.coords.scrCoords[2]-Math.round(k*l.stretchY))+"px";d.style.width=(Math.round(k*l.stretchX)*2)+"px";d.style.height=(Math.round(k*l.stretchY)*2)+"px";this.setAttr(d,"startangle",h);this.setAttr(d,"endangle",g);return d};JXG.VMLRenderer.prototype.drawArcFill=function(a,g,A,m,l,h,e){var u,q,b,k=this.createNode("path"),w=this.createNode("shape"),z=this.createNode("fill"),s=this.createNode("stroke"),d=this.createNode("shadow");a=a+"sector";this.setAttr(k,"id",a+"_path");this.setAttr(z,"id",a+"_fill");this.setAttr(s,"id",a+"_stroke");this.setAttr(d,"id",a+"_shadow");this.setAttr(w,"id",a);w.appendChild(z);w.appendChild(s);w.appendChild(d);w.appendChild(k);w.style.position="absolute";e.rendNode2=w;e.rendNode2Fill=z;e.rendNode2Stroke=s;e.rendNode2Shadow=d;e.rendNode2Path=k;this.setAttr(w,"stroked","false");u=Math.round(g*h.stretchX);q=Math.round(g*h.stretchY);w.style.width=u;w.style.height=q;this.setAttr(w,"coordsize",u+","+q);b="m "+A.coords.scrCoords[1]+","+A.coords.scrCoords[2]+" l ";b+=m.coords.scrCoords[1]+","+m.coords.scrCoords[2]+" at ";b+=(A.coords.scrCoords[1]-u)+","+(A.coords.scrCoords[2]-q)+",";b+=(A.coords.scrCoords[1]+u)+","+(A.coords.scrCoords[2]+q);b+=" "+m.coords.scrCoords[1]+","+m.coords.scrCoords[2];b+=", "+l.coords.scrCoords[1]+","+l.coords.scrCoords[2]+" l ";b+=A.coords.scrCoords[1]+","+A.coords.scrCoords[2]+" x e";this.setAttr(k,"v",b);return w};JXG.VMLRenderer.prototype.drawArc=function(b){var k,a={},h,g,e,d,m,l={};JXG.clearVisPropOld(b);k=b.getRadius();a.coords=new JXG.Coords(JXG.COORDS_BY_USER,[b.midpoint.coords.usrCoords[1],b.board.origin.scrCoords[2]/b.board.stretchY],b.board);g=b.board.algebra.trueAngle(b.point2,b.midpoint,a);h=b.board.algebra.trueAngle(b.point3,b.midpoint,a);if(g<h){h-=360}e=this.drawArcLine(b.id,k,h,g,b.midpoint,b.board,b);d=b.rendNodeStroke;if(b.visProp.lastArrow){this.setAttr(d,"endarrow","block");this.setAttr(d,"endarrowlength","long")}if(b.visProp.firstArrow){this.setAttr(d,"startarrow","block");this.setAttr(d,"startarrowlength","long")}this.setObjectStrokeColor(b,b.visProp.strokeColor,b.visProp.strokeOpacity);this.setObjectStrokeWidth(b,b.visProp.strokeWidth);this.setDashStyle(b,b.visProp);this.setShadow(b);l.coords=b.board.algebra.projectPointToCircle(b.point3,b);m=this.drawArcFill(b.id,k,b.midpoint,b.point2,l,b.board,b);this.setObjectFillColor(b,b.visProp.fillColor,b.visProp.fillOpacity);this.setGradient(b);this.appendChildPrimitive(e,"lines");this.appendChildPrimitive(m,"angles");if(b.visProp.draft){this.setDraft(b)}if(!b.visProp.visible){b.hideElement(b)}};JXG.AbstractRenderer.prototype.updateArc=function(a){this.remove(a.rendNode);this.remove(a.rendNode2);this.drawArc(a);return};JXG.VMLRenderer.prototype.drawAngle=function(e){var a={},w,u,b={},l,k,g,h,d,s={},m={},q;JXG.clearVisPropOld(e);a.midpoint=e.point2;a.getRadius=function(){return e.radius};w=e.board.algebra.projectPointToCircle(e.point1,a);u=e.board.algebra.projectPointToCircle(e.point3,a);b.coords=new JXG.Coords(JXG.COORDS_BY_USER,[e.point2.coords.usrCoords[1],e.board.origin.scrCoords[2]/(e.board.stretchY)],e.board);k=e.board.algebra.trueAngle(e.point1,e.point2,b);l=e.board.algebra.trueAngle(e.point3,e.point2,b);if(k<l){l-=360}g=this.drawArcLine(e.id,e.radius,l,k,e.point2,e.board,e);this.setObjectStrokeColor(e,e.visProp.strokeColor,e.visProp.strokeOpacity);this.setObjectStrokeWidth(e,e.visProp.strokeWidth);h=e.visProp.dash;d=e.rendNodeStroke;this.setAttr(d,"dashstyle",this.dashArray[h]);this.setShadow(e);s.coords=w;m.coords=u;q=this.drawArcFill(e.id,e.radius,e.point2,s,m,e.board,e);this.setObjectFillColor(e,e.visProp.fillColor,e.visProp.fillOpacity);this.appendChildPrimitive(g,"lines");this.appendChildPrimitive(q,"angles");if(e.visProp.draft){this.setDraft(e)}if(!e.visProp.visible){e.hideElement(e)}};JXG.VMLRenderer.prototype.updateAngle=function(a){this.remove(a.rendNode);this.remove(a.rendNode2);this.drawAngle(a);return};JXG.VMLRenderer.prototype.drawImage=function(b){var d,a=b.url;d=this.container.ownerDocument.createElement("img");d.style.position="absolute";this.setAttr(d,"id",b.id);this.setAttr(d,"src",a);this.container.appendChild(d);this.appendChildPrimitive(d,b.displayLevel);d.style.filter="progid:DXImageTransform.Microsoft.Matrix(M11='1.0', sizingMethod='auto expand')";b.rendNode=d;this.updateImage(b)};JXG.VMLRenderer.prototype.transformImage=function(d,b){var e=d.rendNode,a;a=this.joinTransforms(d,b);e.style.left=(d.coords.scrCoords[1]+a[1][0])+"px";e.style.top=(d.coords.scrCoords[2]-d.size[1]+a[2][0])+"px";e.filters.item(0).M11=a[1][1];e.filters.item(0).M12=a[1][2];e.filters.item(0).M21=a[2][1];e.filters.item(0).M22=a[2][2]};JXG.VMLRenderer.prototype.joinTransforms=function(g,e){var b=[[1,0,0],[0,1,0],[0,0,1]],d,a=e.length;for(d=0;d<a;d++){b=JXG.Math.matMatMult(e[d].matrix,b)}return b};JXG.VMLRenderer.prototype.transformImageParent=function(b,a){};JXG.VMLRenderer.prototype.removeGrid=function(a){var b=document.getElementById("gridx");this.remove(b);b=document.getElementById("gridy");this.remove(b);a.hasGrid=false};JXG.VMLRenderer.prototype.hide=function(a){var b=a.rendNode;b.style.visibility="hidden";if(a.type==JXG.OBJECT_TYPE_ARC||a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode2;b.style.visibility="hidden"}};JXG.VMLRenderer.prototype.show=function(a){var b=a.rendNode;b.style.visibility="inherit";if(a.type==JXG.OBJECT_TYPE_ARC||a.type==JXG.OBJECT_TYPE_ANGLE){b=a.rendNode2;b.style.visibility="inherit"}};JXG.VMLRenderer.prototype.setDashStyle=function(b,a){var d;if(a.dash>=0){d=b.rendNodeStroke;this.setAttr(d,"dashstyle",this.dashArray[a.dash])}};JXG.VMLRenderer.prototype.setObjectStrokeColor=function(el,color,opacity){var c=this.eval(color),o=this.eval(opacity),node,nodeStroke;o=(o>0)?o:0;if(el.visPropOld.strokeColor==c&&el.visPropOld.strokeOpacity==o){return}if(el.type==JXG.OBJECT_TYPE_TEXT){el.rendNode.style.color=c}else{node=el.rendNode;this.setAttr(node,"stroked","true");this.setAttr(node,"strokecolor",c);if(el.id=="gridx"){nodeStroke=document.getElementById("gridx_stroke")}else{if(el.id=="gridy"){nodeStroke=document.getElementById("gridy_stroke")}else{nodeStroke=el.rendNodeStroke}}if(o!=undefined){this.setAttr(nodeStroke,"opacity",(o*100)+"%")}}el.visPropOld.strokeColor=c;el.visPropOld.strokeOpacity=o};JXG.VMLRenderer.prototype.setObjectFillColor=function(el,color,opacity){var c=this.eval(color),o=this.eval(opacity);o=(o>0)?o:0;if(el.visPropOld.fillColor==c&&el.visPropOld.fillOpacity==o){return}if(el.type==JXG.OBJECT_TYPE_ARC||el.type==JXG.OBJECT_TYPE_ANGLE){if(c=="none"){this.setAttr(el.rendNode2,"filled","false")}else{this.setAttr(el.rendNode2,"filled","true");this.setAttr(el.rendNode2,"fillcolor",c);if(o!=undefined){this.setAttr(el.rendNode2Fill,"opacity",(o*100)+"%")}}}else{if(c=="none"){this.setAttr(el.rendNode,"filled","false")}else{this.setAttr(el.rendNode,"filled","true");this.setAttr(el.rendNode,"fillcolor",c);if(o!=undefined&&el.rendNodeFill){this.setAttr(el.rendNodeFill,"opacity",(o*100)+"%")}}}el.visPropOld.fillColor=c;el.visPropOld.fillOpacity=o};JXG.VMLRenderer.prototype.remove=function(a){if(a!=null){a.removeNode(true)}};JXG.VMLRenderer.prototype.suspendRedraw=function(){this.container.style.display="none"};JXG.VMLRenderer.prototype.unsuspendRedraw=function(){this.container.style.display=""};JXG.VMLRenderer.prototype.setAttributes=function(node,props,vmlprops,visProp){var val,i,p;len=props.length;for(i=0;i<len;i++){p=props[i];if(visProp[p]!=null){val=this.eval(visProp[p]);val=(val>0)?val:0;this.setAttr(node,vmlprops[i],val)}}};JXG.VMLRenderer.prototype.setGridDash=function(b,a){var a=document.getElementById(b+"_stroke");this.setAttr(a,"dashstyle","Dash")};JXG.VMLRenderer.prototype.setObjectStrokeWidth=function(el,width){var w=this.eval(width),node;if(el.visPropOld.strokeWidth==w){return}node=el.rendNode;this.setPropertyPrimitive(node,"stroked","true");if(w!=null){this.setPropertyPrimitive(node,"stroke-width",w)}el.visPropOld.strokeWidth=w};JXG.VMLRenderer.prototype.createPrimitive=function(b,k){var d,a=this.createNode("fill"),h=this.createNode("stroke"),g=this.createNode("shadow"),e;this.setAttr(a,"id",k+"_fill");this.setAttr(h,"id",k+"_stroke");this.setAttr(g,"id",k+"_shadow");if(b=="circle"||b=="ellipse"){d=this.createNode("oval");d.appendChild(a);d.appendChild(h);d.appendChild(g)}else{if(b=="polygon"||b=="path"||b=="shape"||b=="line"){d=this.createNode("shape");d.appendChild(a);d.appendChild(h);d.appendChild(g);e=this.createNode("path");this.setAttr(e,"id",k+"_path");d.appendChild(e)}else{d=this.createNode(b);d.appendChild(a);d.appendChild(h);d.appendChild(g)}}d.style.position="absolute";this.setAttr(d,"id",k);return d};JXG.VMLRenderer.prototype.appendNodesToElement=function(a,b){if(b=="shape"||b=="path"||b=="polygon"){a.rendNodePath=document.getElementById(a.id+"_path")}a.rendNodeFill=document.getElementById(a.id+"_fill");a.rendNodeStroke=document.getElementById(a.id+"_stroke");a.rendNodeShadow=document.getElementById(a.id+"_shadow");a.rendNode=document.getElementById(a.id)};JXG.VMLRenderer.prototype.makeArrow=function(d,b,e){var a=b.rendNodeStroke;this.setAttr(a,"endarrow","block");this.setAttr(a,"endarrowlength","long")};JXG.VMLRenderer.prototype.makeArrows=function(b){var a;if(b.visPropOld.firstArrow==b.visProp.firstArrow&&b.visPropOld.lastArrow==b.visProp.lastArrow){return}if(b.visProp.firstArrow){a=b.rendNodeStroke;this.setAttr(a,"startarrow","block");this.setAttr(a,"startarrowlength","long")}else{a=b.rendNodeStroke;if(a!=null){this.setAttr(a,"startarrow","none")}}if(b.visProp.lastArrow){a=b.rendNodeStroke;this.setAttr(a,"id",b.id+"stroke");this.setAttr(a,"endarrow","block");this.setAttr(a,"endarrowlength","long")}else{a=b.rendNodeStroke;if(a!=null){this.setAttr(a,"endarrow","none")}}b.visPropOld.firstArrow=b.visProp.firstArrow;b.visPropOld.lastArrow=b.visProp.lastArrow};JXG.VMLRenderer.prototype.updateLinePrimitive=function(l,b,a,e,d,h){var g,k=this.resolution;g=["m ",k*b,", ",k*a," l ",k*e,", ",k*d];this.updatePathPrimitive(l,g,h)};JXG.VMLRenderer.prototype.updateCirclePrimitive=function(d,a,e,b){d.style.left=(a-b)+"px";d.style.top=(e-b)+"px";d.style.width=(b*2)+"px";d.style.height=(b*2)+"px"};JXG.VMLRenderer.prototype.updateRectPrimitive=function(e,a,g,b,d){e.style.left=(a)+"px";e.style.top=(g)+"px";e.style.width=(b)+"px";e.style.height=(d)+"px"};JXG.VMLRenderer.prototype.updateEllipsePrimitive=function(b,a,g,e,d){b.style.left=(a-e)+"px";b.style.top=(g-d)+"px";b.style.width=(e*2)+"px";b.style.height=(d*2)+"px"};JXG.VMLRenderer.prototype.updatePathPrimitive=function(d,e,b){var a=b.canvasWidth,g=b.canvasHeight;d.style.width=a;d.style.height=g;this.setAttr(d,"coordsize",[(this.resolution*a),(this.resolution*g)].join(","));this.setAttr(d,"path",e.join(""))};JXG.VMLRenderer.prototype.updatePathStringPrimitive=function(b){var l=[],k,q,a=this.resolution,h=Math.round,e=" m ",g=" l ",d=e,s=(b.curveType!="plot"),m=Math.min(b.numberPoints,8192);if(b.numberPoints<=0){return""}if(s&&b.board.options.curve.RDPsmoothing){b.points=this.RamenDouglasPeuker(b.points,1)}m=Math.min(m,b.points.length);for(k=0;k<m;k++){q=b.points[k].scrCoords;if(isNaN(q[1])||isNaN(q[2])){d=e}else{if(q[1]>20000){q[1]=20000}else{if(q[1]<-20000){q[1]=-20000}}if(q[2]>20000){q[2]=20000}else{if(q[2]<-20000){q[2]=-20000}}l.push([d,h(a*q[1]),", ",h(a*q[2])].join(""));d=g}}l.push(" e");return l};JXG.VMLRenderer.prototype.updatePathStringPoint=function(e,a,d){var b=[],h=e.coords.scrCoords,g=this.resolution;if(d=="x"){b.push(["m ",(g*(h[1]-a)),", ",(g*(h[2]-a))," l ",(g*(h[1]+a)),", ",(g*(h[2]+a))," m ",(g*(h[1]+a)),", ",(g*(h[2]-a))," l ",(g*(h[1]-a)),", ",(g*(h[2]+a))].join(""))}else{if(d=="+"){b.push(["m ",(g*(h[1]-a)),", ",(g*(h[2]))," l ",(g*(h[1]+a)),", ",(g*(h[2]))," m ",(g*(h[1])),", ",(g*(h[2]-a))," l ",(g*(h[1])),", ",(g*(h[2]+a))].join(""))}}return b};JXG.VMLRenderer.prototype.updatePolygonePrimitive=function(g,d){var h=d.vertices[0].coords.scrCoords[1],b=d.vertices[0].coords.scrCoords[1],e=d.vertices[0].coords.scrCoords[2],a=d.vertices[0].coords.scrCoords[2],k,m=d.vertices.length,q,u,s,l=[];this.setAttr(g,"stroked","false");for(k=1;k<m-1;k++){q=d.vertices[k].coords.scrCoords;if(q[1]<h){h=q[1]}else{if(q[1]>b){b=q[1]}}if(q[2]<e){e=q[2]}else{if(q[2]>a){a=q[2]}}}u=Math.round(b-h);s=Math.round(a-e);if(!isNaN(u)&&!isNaN(s)){g.style.width=u;g.style.height=s;this.setAttr(g,"coordsize",u+","+s)}q=d.vertices[0].coords.scrCoords;l.push(["m ",q[1],",",q[2]," l "].join(""));for(k=1;k<m-1;k++){q=d.vertices[k].coords.scrCoords;l.push(q[1]+","+q[2]);if(k<m-2){l.push(", ")}}l.push(" x e");this.setAttr(g,"path",l.join(""))};JXG.VMLRenderer.prototype.appendChildPrimitive=function(a,b){switch(b){case"images":a.style.zIndex="1";break;case"grid":a.style.zIndex="1";break;case"angles":a.style.zIndex="2";break;case"sectors":a.style.zIndex="2";break;case"polygone":a.style.zIndex="2";break;case"curves":a.style.zIndex="4";break;case"circles":a.style.zIndex="4";break;case"lines":a.style.zIndex="4";break;case"arcs":a.style.zIndex="4";break;case"points":a.style.zIndex="5";break}this.container.appendChild(a)};JXG.VMLRenderer.prototype.setPropertyPrimitive=function(node,key,val){var keyVml="",node2,v;switch(key){case"stroke":keyVml="strokecolor";break;case"stroke-width":keyVml="strokeweight";break;case"stroke-dasharray":keyVml="dashstyle";break}if(keyVml!=""){v=this.eval(val);this.setAttr(node,keyVml,v)}};JXG.VMLRenderer.prototype.drawVerticalGrid=function(e,b,h,d){var g=this.createPrimitive("path","gridx"),a=[];while(e.scrCoords[1]<b.scrCoords[1]+h-1){a.push(" m "+(this.resolution*e.scrCoords[1])+", "+0+" l "+(this.resolution*e.scrCoords[1])+", "+(this.resolution*d.canvasHeight)+" ");e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1]+h,e.scrCoords[2]])}this.updatePathPrimitive(g,a,d);return g};JXG.VMLRenderer.prototype.drawHorizontalGrid=function(e,b,h,d){var g=this.createPrimitive("path","gridy"),a=[];while(e.scrCoords[2]<=b.scrCoords[2]+h-1){a.push(" m "+0+", "+(this.resolution*e.scrCoords[2])+" l "+(this.resolution*d.canvasWidth)+", "+(this.resolution*e.scrCoords[2])+" ");e.setCoordinates(JXG.COORDS_BY_SCREEN,[e.scrCoords[1],e.scrCoords[2]+h])}this.updatePathPrimitive(g,a,d);return g};